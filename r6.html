<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 3 R6 | Integración del Paquete QualityTools con Tidyverse</title>
  <meta name="description" content="En este bookdown se pretende fusionar toda la información necesaria sobre la POO y los paquetes QualityTools y Tidyquant." />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 3 R6 | Integración del Paquete QualityTools con Tidyverse" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="En este bookdown se pretende fusionar toda la información necesaria sobre la POO y los paquetes QualityTools y Tidyquant." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 3 R6 | Integración del Paquete QualityTools con Tidyverse" />
  
  <meta name="twitter:description" content="En este bookdown se pretende fusionar toda la información necesaria sobre la POO y los paquetes QualityTools y Tidyquant." />
  

<meta name="author" content="Miguel Flores, Andrea Barahona, Fabian Encarnación, Dario Quispe" />


<meta name="date" content="2024-04-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="poo-programación-orientada-a-objetos.html"/>
<link rel="next" href="tidyquant.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">UDC</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Aquí van R6, QualityTools y Tidyquant</a></li>
<li class="chapter" data-level="2" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html"><i class="fa fa-check"></i><b>2</b> (POO) Programación Orientada a Objetos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html#introducción"><i class="fa fa-check"></i><b>2.1</b> Introducción</a></li>
<li class="chapter" data-level="2.2" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html#sistemas-de-programación-orientada-a-objetos"><i class="fa fa-check"></i><b>2.2</b> Sistemas de programación orientada a objetos</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html#paradigmas"><i class="fa fa-check"></i><b>2.2.1</b> Paradigmas</a></li>
<li class="chapter" data-level="2.2.2" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html#especificaciones-de-los-principales-sistemas-poo-en-r"><i class="fa fa-check"></i><b>2.2.2</b> Especificaciones de los principales sistemas POO en R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html#tipos-de-bases"><i class="fa fa-check"></i><b>2.3</b> Tipos de bases</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html#objetos-base-vs-objetos-oo"><i class="fa fa-check"></i><b>2.3.1</b> Objetos Base vs Objetos OO</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r6.html"><a href="r6.html"><i class="fa fa-check"></i><b>3</b> R6</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r6.html"><a href="r6.html#clases-y-métodos"><i class="fa fa-check"></i><b>3.1</b> Clases y métodos</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="r6.html"><a href="r6.html#encadenamiento-de-métodos"><i class="fa fa-check"></i><b>3.1.1</b> Encadenamiento de métodos</a></li>
<li class="chapter" data-level="3.1.2" data-path="r6.html"><a href="r6.html#métodos-importantes"><i class="fa fa-check"></i><b>3.1.2</b> Métodos importantes</a></li>
<li class="chapter" data-level="3.1.3" data-path="r6.html"><a href="r6.html#agregar-métodos-después-de-la-creación"><i class="fa fa-check"></i><b>3.1.3</b> Agregar métodos después de la creación</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="r6.html"><a href="r6.html#controles-de-acceso"><i class="fa fa-check"></i><b>3.2</b> Controles de Acceso</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="r6.html"><a href="r6.html#privacidad"><i class="fa fa-check"></i><b>3.2.1</b> Privacidad</a></li>
<li class="chapter" data-level="3.2.2" data-path="r6.html"><a href="r6.html#campos-activos"><i class="fa fa-check"></i><b>3.2.2</b> Campos Activos</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="r6.html"><a href="r6.html#semántica-de-referencia"><i class="fa fa-check"></i><b>3.3</b> Semántica de referencia</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="r6.html"><a href="r6.html#razonamientos"><i class="fa fa-check"></i><b>3.3.1</b> Razonamientos</a></li>
<li class="chapter" data-level="3.3.2" data-path="r6.html"><a href="r6.html#finalización"><i class="fa fa-check"></i><b>3.3.2</b> Finalización</a></li>
<li class="chapter" data-level="3.3.3" data-path="r6.html"><a href="r6.html#campos-en-r6"><i class="fa fa-check"></i><b>3.3.3</b> Campos en R6</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r6.html"><a href="r6.html#por-qué-r6"><i class="fa fa-check"></i><b>3.4</b> ¿Por qué R6?</a></li>
<li class="chapter" data-level="3.5" data-path="r6.html"><a href="r6.html#ejercicios-prácticos"><i class="fa fa-check"></i><b>3.5</b> Ejercicios prácticos</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidyquant.html"><a href="tidyquant.html"><i class="fa fa-check"></i><b>4</b> TidyQuant</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidyquant.html"><a href="tidyquant.html#compatibilidad-de-funciones"><i class="fa fa-check"></i><b>4.1</b> Compatibilidad de funciones</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="tidyquant.html"><a href="tidyquant.html#funcionalidad-zoo"><i class="fa fa-check"></i><b>4.1.1</b> Funcionalidad zoo</a></li>
<li class="chapter" data-level="4.1.2" data-path="tidyquant.html"><a href="tidyquant.html#funcionalidad-xts"><i class="fa fa-check"></i><b>4.1.2</b> Funcionalidad xts</a></li>
<li class="chapter" data-level="4.1.3" data-path="tidyquant.html"><a href="tidyquant.html#funcionalidad-quantmod"><i class="fa fa-check"></i><b>4.1.3</b> Funcionalidad quantmod</a></li>
<li class="chapter" data-level="4.1.4" data-path="tidyquant.html"><a href="tidyquant.html#funcionalidad-ttr"><i class="fa fa-check"></i><b>4.1.4</b> Funcionalidad TTR</a></li>
<li class="chapter" data-level="4.1.5" data-path="tidyquant.html"><a href="tidyquant.html#funcionalidad-performanceanalytics"><i class="fa fa-check"></i><b>4.1.5</b> Funcionalidad PerformanceAnalytics</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tidyquant.html"><a href="tidyquant.html#poder-cuantitativo-en-acción"><i class="fa fa-check"></i><b>4.2</b> Poder Cuantitativo en Acción</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-1-utilizar-quantmod-periodreturn-para-convertir-precios-en-rentabilidad"><i class="fa fa-check"></i><b>4.2.1</b> Ejemplo 1: utilizar quantmod periodReturn para convertir precios en rentabilidad</a></li>
<li class="chapter" data-level="4.2.2" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-2-utilice-xts-to.period-para-cambiar-la-periodicidad-de-diaria-a-mensual"><i class="fa fa-check"></i><b>4.2.2</b> Ejemplo 2: utilice xts to.period para cambiar la periodicidad de diaria a mensual</a></li>
<li class="chapter" data-level="4.2.3" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-3-utilice-ttr-runcor-para-visualizar-correlaciones-continuas-de-rendimientos"><i class="fa fa-check"></i><b>4.2.3</b> Ejemplo 3: utilice TTR runCor para visualizar correlaciones continuas de rendimientos</a></li>
<li class="chapter" data-level="4.2.4" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-4-utilice-ttr-macd-para-visualizar-la-divergencia-de-convergencia-de-la-media-móvil"><i class="fa fa-check"></i><b>4.2.4</b> Ejemplo 4: Utilice TTR MACD para visualizar la divergencia de convergencia de la media móvil</a></li>
<li class="chapter" data-level="4.2.5" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-5-utilice-xts-apply.quarterly-para-obtener-el-precio-máximo-y-mínimo-para-cada-trimestre"><i class="fa fa-check"></i><b>4.2.5</b> Ejemplo 5: utilice xts apply.quarterly para obtener el precio máximo y mínimo para cada trimestre</a></li>
<li class="chapter" data-level="4.2.6" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-6-utilice-zoo-rollapply-para-visualizar-una-regresión-continua"><i class="fa fa-check"></i><b>4.2.6</b> Ejemplo 6: utilice zoo rollapply para visualizar una regresión continua</a></li>
<li class="chapter" data-level="4.2.7" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-7-utilice-return.clean-y-return.excess-para-limpiar-y-calcular-el-exceso-de-rendimiento"><i class="fa fa-check"></i><b>4.2.7</b> Ejemplo 7: utilice return.clean y return.excess para limpiar y calcular el exceso de rendimiento</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="qualitytools.html"><a href="qualitytools.html"><i class="fa fa-check"></i><b>5</b> QualityTools</a>
<ul>
<li class="chapter" data-level="5.1" data-path="qualitytools.html"><a href="qualitytools.html#fase-1-definir"><i class="fa fa-check"></i><b>5.1</b> Fase 1: Definir</a></li>
<li class="chapter" data-level="5.2" data-path="qualitytools.html"><a href="qualitytools.html#fase-2-medir"><i class="fa fa-check"></i><b>5.2</b> Fase 2: Medir</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="qualitytools.html"><a href="qualitytools.html#capacidad-de-calibre---msa-tipo-i"><i class="fa fa-check"></i><b>5.2.1</b> Capacidad de calibre - MSA Tipo I</a></li>
<li class="chapter" data-level="5.2.2" data-path="qualitytools.html"><a href="qualitytools.html#repetibilidad-y-reproducibidad-del-calibre---msa-tipo-ii"><i class="fa fa-check"></i><b>5.2.2</b> Repetibilidad y reproducibidad del calibre - MSA Tipo II</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="qualitytools.html"><a href="qualitytools.html#fase-3-analizar"><i class="fa fa-check"></i><b>5.3</b> Fase 3: Analizar</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="qualitytools.html"><a href="qualitytools.html#capacidad-del-proceso"><i class="fa fa-check"></i><b>5.3.1</b> Capacidad del Proceso</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="qualitytools.html"><a href="qualitytools.html#fase-4-mejorar"><i class="fa fa-check"></i><b>5.4</b> Fase 4: Mejorar</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="qualitytools.html"><a href="qualitytools.html#diseños-factoriales-2k"><i class="fa fa-check"></i><b>5.4.1</b> Diseños factoriales <span class="math inline">\(2^{k}\)</span></a></li>
<li class="chapter" data-level="5.4.2" data-path="qualitytools.html"><a href="qualitytools.html#diseños-factoriales-fraccionarios-2k-p"><i class="fa fa-check"></i><b>5.4.2</b> Diseños factoriales fraccionarios <span class="math inline">\(2^{k-p}\)</span></a></li>
<li class="chapter" data-level="5.4.3" data-path="qualitytools.html"><a href="qualitytools.html#diseños-replicados-y-puntos-centrales"><i class="fa fa-check"></i><b>5.4.3</b> Diseños replicados y puntos centrales</a></li>
<li class="chapter" data-level="5.4.4" data-path="qualitytools.html"><a href="qualitytools.html#respuestas-múltiples"><i class="fa fa-check"></i><b>5.4.4</b> Respuestas múltiples</a></li>
<li class="chapter" data-level="5.4.5" data-path="qualitytools.html"><a href="qualitytools.html#pasar-a-un-entorno-de-proceso-con-un-mayor-rendimiento-esperado"><i class="fa fa-check"></i><b>5.4.5</b> Pasar a un entorno de proceso con un mayor rendimiento esperado</a></li>
<li class="chapter" data-level="5.4.6" data-path="qualitytools.html"><a href="qualitytools.html#diseños-de-superficies-de-respuesta"><i class="fa fa-check"></i><b>5.4.6</b> Diseños de superficies de respuesta</a></li>
<li class="chapter" data-level="5.4.7" data-path="qualitytools.html"><a href="qualitytools.html#montaje-secuencial-de-diseños-de-superficie-de-respuesta"><i class="fa fa-check"></i><b>5.4.7</b> Montaje secuencial de diseños de superficie de respuesta</a></li>
<li class="chapter" data-level="5.4.8" data-path="qualitytools.html"><a href="qualitytools.html#aleatorización"><i class="fa fa-check"></i><b>5.4.8</b> Aleatorización</a></li>
<li class="chapter" data-level="5.4.9" data-path="qualitytools.html"><a href="qualitytools.html#bloqueo"><i class="fa fa-check"></i><b>5.4.9</b> Bloqueo</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="qualitytools.html"><a href="qualitytools.html#deseabilidades"><i class="fa fa-check"></i><b>5.5</b> Deseabilidades</a></li>
<li class="chapter" data-level="5.6" data-path="qualitytools.html"><a href="qualitytools.html#utilización-de-deseabilidades-junto-con-experimentos-diseñados"><i class="fa fa-check"></i><b>5.6</b> Utilización de deseabilidades junto con experimentos diseñados</a></li>
<li class="chapter" data-level="5.7" data-path="qualitytools.html"><a href="qualitytools.html#diseños-de-mezclas"><i class="fa fa-check"></i><b>5.7</b> Diseños de mezclas</a></li>
<li class="chapter" data-level="5.8" data-path="qualitytools.html"><a href="qualitytools.html#diseños-taguchi"><i class="fa fa-check"></i><b>5.8</b> Diseños Taguchi</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Integración del Paquete QualityTools con Tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r6" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Capítulo 3</span> R6<a href="r6.html#r6" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div>
<img src='graficasR6/logo.svg' width="120" align="right">
</div>
<p>El sistema POO R6 se lo puede empezar analizando mediante sus dos propiedades especiales :</p>
<p>-Utiliza el paradigma de POO encapsulada, lo que significa que los métodos pertenecen a los objetos, no a los genéricos, y se se los puede llamar mediante <code>object$method()</code>.</p>
<p>-Los objetos R6 son mutables, lo que significa que se modifican en el lugar, y por lo tanto tienen semántica de referencia.</p>
<p>Si se tiene conocimientos de POO en otros lenguajes es probable que R6 resulte muy natural y sea una buena alternativa a S3.</p>
<p>Los temas a tratar en referencia a R6 son los siguiente :</p>
<ul>
<li><p>Clases y métodos : <code>R6::R6Class()</code> la única función que necesitas conocer para crear clases R6. Aprenderás sobre el método constructor, $new(), que te permite crear objetos R6, así como otros métodos importantes como $initialize() y $print().</p></li>
<li><p>Controles de acceso: mecanismos de acceso de R6 , campos privados y activos. Juntos, permiten ocultar datos al usuario, o exponer datos privados para su lectura pero no para su escritura.</p></li>
<li><p>Semántica de referencia : explora las consecuencias de la semántica de referencia de R6. Se aprende el uso de finalizadores para limpiar automáticamente cualquier operación realizada en el inicializador, y un problema común si usas un objeto R6 como campo en otro objeto R6.</p></li>
<li><p>Por qué R6 en lugar del sistema RC base?</p></li>
</ul>
<p><strong>Requisito : </strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="r6.html#cb11-1" tabindex="-1"></a><span class="co">#install.packages(&quot;R6&quot;)</span></span>
<span id="cb11-2"><a href="r6.html#cb11-2" tabindex="-1"></a><span class="fu">library</span>(R6)</span></code></pre></div>
<div id="clases-y-métodos" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Clases y métodos<a href="r6.html#clases-y-métodos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para crear las clases y sus métodos se utiliza: <code>R6::R6Class()</code></p>
<p>Por ejemplo:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="r6.html#cb12-1" tabindex="-1"></a>SumaAcum <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;SumaAcum&quot;</span>,<span class="fu">list</span>(</span>
<span id="cb12-2"><a href="r6.html#cb12-2" tabindex="-1"></a>  <span class="at">suma =</span> <span class="dv">0</span>,</span>
<span id="cb12-3"><a href="r6.html#cb12-3" tabindex="-1"></a>  <span class="at">sumar =</span> <span class="cf">function</span>(<span class="at">x=</span><span class="dv">1</span>){</span>
<span id="cb12-4"><a href="r6.html#cb12-4" tabindex="-1"></a>   self<span class="sc">$</span>suma<span class="ot">&lt;-</span>self<span class="sc">$</span>suma<span class="sc">+</span>x</span>
<span id="cb12-5"><a href="r6.html#cb12-5" tabindex="-1"></a>   <span class="fu">invisible</span>(self)</span>
<span id="cb12-6"><a href="r6.html#cb12-6" tabindex="-1"></a>  }</span>
<span id="cb12-7"><a href="r6.html#cb12-7" tabindex="-1"></a>))</span></code></pre></div>
<p>En el ejemplo se muestra los argumentos que deben ir en la función <code>R6Class()</code>:</p>
<ul>
<li><p>El primer argumento es el nombre de la clase, el cual no es necesario, pero evita errores.</p></li>
<li><p>El segundo argumento son los métodos (funciones) y campos (variables) públicos del objeto. Los métodos pueden acceder a los métodos y campos del mismo objeto mediante <code>self</code></p></li>
</ul>
<p>Para crear un nuevo objeto se utiliza el método <code>$new()</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="r6.html#cb13-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> SumaAcum<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb13-2"><a href="r6.html#cb13-2" tabindex="-1"></a>x</span>
<span id="cb13-3"><a href="r6.html#cb13-3" tabindex="-1"></a><span class="do">## &lt;SumaAcum&gt;</span></span>
<span id="cb13-4"><a href="r6.html#cb13-4" tabindex="-1"></a><span class="do">##   Public:</span></span>
<span id="cb13-5"><a href="r6.html#cb13-5" tabindex="-1"></a><span class="do">##     clone: function (deep = FALSE) </span></span>
<span id="cb13-6"><a href="r6.html#cb13-6" tabindex="-1"></a><span class="do">##     suma: 0</span></span>
<span id="cb13-7"><a href="r6.html#cb13-7" tabindex="-1"></a><span class="do">##     sumar: function (x = 1)</span></span></code></pre></div>
<p>Además, se accede a los campos y se llama a los métodos mediante <code>$</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="r6.html#cb14-1" tabindex="-1"></a>x<span class="sc">$</span><span class="fu">sumar</span>(<span class="dv">2</span>)</span>
<span id="cb14-2"><a href="r6.html#cb14-2" tabindex="-1"></a>x<span class="sc">$</span>suma</span>
<span id="cb14-3"><a href="r6.html#cb14-3" tabindex="-1"></a><span class="do">## [1] 2</span></span>
<span id="cb14-4"><a href="r6.html#cb14-4" tabindex="-1"></a>x<span class="sc">$</span><span class="fu">sumar</span>(<span class="dv">4</span>)</span>
<span id="cb14-5"><a href="r6.html#cb14-5" tabindex="-1"></a>x<span class="sc">$</span>suma</span>
<span id="cb14-6"><a href="r6.html#cb14-6" tabindex="-1"></a><span class="do">## [1] 6</span></span>
<span id="cb14-7"><a href="r6.html#cb14-7" tabindex="-1"></a>x<span class="sc">$</span><span class="fu">sumar</span>()</span>
<span id="cb14-8"><a href="r6.html#cb14-8" tabindex="-1"></a>x<span class="sc">$</span>suma</span>
<span id="cb14-9"><a href="r6.html#cb14-9" tabindex="-1"></a><span class="do">## [1] 7</span></span></code></pre></div>
<p>Vemos también que se utiliza <code>self$</code> para acceder a los miembros y métodos públicos de la clase (se puede usar <code>private$</code> o <code>super$</code> para miembros privados o que heredan que se verá más adelante)</p>
<div id="encadenamiento-de-métodos" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Encadenamiento de métodos<a href="r6.html#encadenamiento-de-métodos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Debido a como se crean los métodos podemos realizar un encadenamiento, por ejemplo:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="r6.html#cb15-1" tabindex="-1"></a>y <span class="ot">&lt;-</span> SumaAcum<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb15-2"><a href="r6.html#cb15-2" tabindex="-1"></a>y<span class="sc">$</span><span class="fu">sumar</span>(<span class="dv">5</span>)<span class="sc">$</span><span class="fu">sumar</span>(<span class="dv">10</span>)</span>
<span id="cb15-3"><a href="r6.html#cb15-3" tabindex="-1"></a>y<span class="sc">$</span>suma</span>
<span id="cb15-4"><a href="r6.html#cb15-4" tabindex="-1"></a><span class="do">## [1] 15</span></span></code></pre></div>
<p>Este encadenamiento está relacionados con los <strong>pipe</strong> y se revisará más adelante los pros y contras de esto.</p>
</div>
<div id="métodos-importantes" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Métodos importantes<a href="r6.html#métodos-importantes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El método <code>$initialize()</code> modifica el comportamiento de <code>$new()</code>, por ejemplo:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="r6.html#cb16-1" tabindex="-1"></a>Persona <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;Persona&quot;</span>,<span class="fu">list</span>(</span>
<span id="cb16-2"><a href="r6.html#cb16-2" tabindex="-1"></a>  <span class="at">nombre =</span> <span class="cn">NULL</span>,</span>
<span id="cb16-3"><a href="r6.html#cb16-3" tabindex="-1"></a>  <span class="at">edad =</span> <span class="cn">NA</span>,</span>
<span id="cb16-4"><a href="r6.html#cb16-4" tabindex="-1"></a>  <span class="at">initialize =</span> <span class="cf">function</span>(nombre, <span class="at">edad=</span> <span class="cn">NA</span>){</span>
<span id="cb16-5"><a href="r6.html#cb16-5" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.character</span>(nombre), <span class="fu">length</span>(nombre)<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb16-6"><a href="r6.html#cb16-6" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="fu">is.numeric</span>(edad), <span class="fu">length</span>(edad)<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb16-7"><a href="r6.html#cb16-7" tabindex="-1"></a>    self<span class="sc">$</span>nombre <span class="ot">&lt;-</span> nombre</span>
<span id="cb16-8"><a href="r6.html#cb16-8" tabindex="-1"></a>    self<span class="sc">$</span>edad <span class="ot">&lt;-</span> edad</span>
<span id="cb16-9"><a href="r6.html#cb16-9" tabindex="-1"></a>  }</span>
<span id="cb16-10"><a href="r6.html#cb16-10" tabindex="-1"></a>))</span></code></pre></div>
<p>De esta forma se asegura que el nombre sea un solo string y que la edad sea un solo número. Creemos por ejemplo:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="r6.html#cb17-1" tabindex="-1"></a>Andrea <span class="ot">&lt;-</span> Persona<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;Andrea&quot;</span>, <span class="st">&#39;veintidos&#39;</span>)</span>
<span id="cb17-2"><a href="r6.html#cb17-2" tabindex="-1"></a><span class="do">## Error in initialize(...): is.numeric(edad) is not TRUE</span></span></code></pre></div>
<p>Por lo tanto no se crea, debido a que <code>'veintidos'</code> no es un número, y si se creará cuando lo creemos de esta forma:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="r6.html#cb18-1" tabindex="-1"></a>Andrea <span class="ot">&lt;-</span> Persona<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;Andrea&quot;</span>, <span class="dv">22</span>)</span></code></pre></div>
<p>En caso de tener requisitos más complejos se puede utilizar <code>$validate()</code></p>
<p>El método <code>$print()</code> permite modificar el comportamiento de la impresión por defecto, por ejemplo:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="r6.html#cb19-1" tabindex="-1"></a>Persona <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;Persona&quot;</span>, <span class="fu">list</span>(</span>
<span id="cb19-2"><a href="r6.html#cb19-2" tabindex="-1"></a>  <span class="at">nombre =</span> <span class="cn">NULL</span>,</span>
<span id="cb19-3"><a href="r6.html#cb19-3" tabindex="-1"></a>  <span class="at">edad =</span> <span class="cn">NA</span>,</span>
<span id="cb19-4"><a href="r6.html#cb19-4" tabindex="-1"></a>  <span class="at">initialize =</span> <span class="cf">function</span>(nombre, <span class="at">edad =</span> <span class="cn">NA</span>) {</span>
<span id="cb19-5"><a href="r6.html#cb19-5" tabindex="-1"></a>    self<span class="sc">$</span>nombre <span class="ot">&lt;-</span> nombre</span>
<span id="cb19-6"><a href="r6.html#cb19-6" tabindex="-1"></a>    self<span class="sc">$</span>edad <span class="ot">&lt;-</span> edad</span>
<span id="cb19-7"><a href="r6.html#cb19-7" tabindex="-1"></a>  },</span>
<span id="cb19-8"><a href="r6.html#cb19-8" tabindex="-1"></a>  <span class="at">print =</span> <span class="cf">function</span>(...) {</span>
<span id="cb19-9"><a href="r6.html#cb19-9" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Persona: </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb19-10"><a href="r6.html#cb19-10" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Nombre: &quot;</span>, self<span class="sc">$</span>nombre, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb19-11"><a href="r6.html#cb19-11" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;Edad:  &quot;</span>, self<span class="sc">$</span>edad, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb19-12"><a href="r6.html#cb19-12" tabindex="-1"></a>    <span class="fu">invisible</span>(self)</span>
<span id="cb19-13"><a href="r6.html#cb19-13" tabindex="-1"></a>  }</span>
<span id="cb19-14"><a href="r6.html#cb19-14" tabindex="-1"></a>))</span>
<span id="cb19-15"><a href="r6.html#cb19-15" tabindex="-1"></a></span>
<span id="cb19-16"><a href="r6.html#cb19-16" tabindex="-1"></a>Andrea2 <span class="ot">&lt;-</span> Persona<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;Andrea&quot;</span>)</span>
<span id="cb19-17"><a href="r6.html#cb19-17" tabindex="-1"></a>Andrea2</span>
<span id="cb19-18"><a href="r6.html#cb19-18" tabindex="-1"></a><span class="do">## Persona: </span></span>
<span id="cb19-19"><a href="r6.html#cb19-19" tabindex="-1"></a><span class="do">## Nombre: Andrea</span></span>
<span id="cb19-20"><a href="r6.html#cb19-20" tabindex="-1"></a><span class="do">## Edad:  NA</span></span></code></pre></div>
<p>Ahora vemos que el objeto creado anteriormente no tiene relación con este nuevo, pues cada método está vinculado a un objeto individual. Vemos que:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="r6.html#cb20-1" tabindex="-1"></a>Andrea</span>
<span id="cb20-2"><a href="r6.html#cb20-2" tabindex="-1"></a><span class="do">## &lt;Persona&gt;</span></span>
<span id="cb20-3"><a href="r6.html#cb20-3" tabindex="-1"></a><span class="do">##   Public:</span></span>
<span id="cb20-4"><a href="r6.html#cb20-4" tabindex="-1"></a><span class="do">##     clone: function (deep = FALSE) </span></span>
<span id="cb20-5"><a href="r6.html#cb20-5" tabindex="-1"></a><span class="do">##     edad: 22</span></span>
<span id="cb20-6"><a href="r6.html#cb20-6" tabindex="-1"></a><span class="do">##     initialize: function (nombre, edad = NA) </span></span>
<span id="cb20-7"><a href="r6.html#cb20-7" tabindex="-1"></a><span class="do">##     nombre: Andrea</span></span>
<span id="cb20-8"><a href="r6.html#cb20-8" tabindex="-1"></a>Andrea2</span>
<span id="cb20-9"><a href="r6.html#cb20-9" tabindex="-1"></a><span class="do">## Persona: </span></span>
<span id="cb20-10"><a href="r6.html#cb20-10" tabindex="-1"></a><span class="do">## Nombre: Andrea</span></span>
<span id="cb20-11"><a href="r6.html#cb20-11" tabindex="-1"></a><span class="do">## Edad:  NA</span></span></code></pre></div>
<p>No imprimen lo mismo.</p>
</div>
<div id="agregar-métodos-después-de-la-creación" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Agregar métodos después de la creación<a href="r6.html#agregar-métodos-después-de-la-creación" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para evitar crear nuevas clases, se puede modificar los campos o métodos de una ya existente. Se utiliza <code>$set()</code> para agregar nuevos elementos. Por ejemplo:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="r6.html#cb21-1" tabindex="-1"></a>SumAcum <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;SumAcum&quot;</span>)</span>
<span id="cb21-2"><a href="r6.html#cb21-2" tabindex="-1"></a>SumAcum<span class="sc">$</span><span class="fu">set</span>(<span class="st">&quot;public&quot;</span>, <span class="st">&quot;suma&quot;</span>, <span class="dv">0</span>)</span>
<span id="cb21-3"><a href="r6.html#cb21-3" tabindex="-1"></a>SumAcum<span class="sc">$</span><span class="fu">set</span>(<span class="st">&quot;public&quot;</span>, <span class="st">&quot;sumar&quot;</span>, <span class="cf">function</span>(<span class="at">x=</span><span class="dv">1</span>){</span>
<span id="cb21-4"><a href="r6.html#cb21-4" tabindex="-1"></a>  self<span class="sc">$</span>suma <span class="ot">&lt;-</span> self<span class="sc">$</span>suma <span class="sc">+</span> x</span>
<span id="cb21-5"><a href="r6.html#cb21-5" tabindex="-1"></a>  <span class="fu">invisible</span>(self)</span>
<span id="cb21-6"><a href="r6.html#cb21-6" tabindex="-1"></a>})</span></code></pre></div>
<p>Para agregarlos debemos proporcionar: visibilidad (public, entre otros), nombre y lo que se va a agregrar.</p>
<p>De esta forma se crea este objeto igual al que se creó en la primera sección. Además, si se agregan nuevo campos o métodos solo estarán disponibles para los nuevos objetos creados a partir de esto.</p>
<p>Para evitar aumentar métodos o campos se puede bloquear la clase mediante <code>lock_class=TRUE</code>, de la siguiente forma:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="r6.html#cb22-1" tabindex="-1"></a>SumaAcum <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;SumaAcum&quot;</span>,<span class="fu">list</span>(</span>
<span id="cb22-2"><a href="r6.html#cb22-2" tabindex="-1"></a>  <span class="at">suma =</span> <span class="dv">0</span>,</span>
<span id="cb22-3"><a href="r6.html#cb22-3" tabindex="-1"></a>  <span class="at">sumar =</span> <span class="cf">function</span>(<span class="at">x=</span><span class="dv">1</span>){</span>
<span id="cb22-4"><a href="r6.html#cb22-4" tabindex="-1"></a>   self<span class="sc">$</span>suma<span class="ot">&lt;-</span>self<span class="sc">$</span>suma<span class="sc">+</span>x</span>
<span id="cb22-5"><a href="r6.html#cb22-5" tabindex="-1"></a>   <span class="fu">invisible</span>(self)</span>
<span id="cb22-6"><a href="r6.html#cb22-6" tabindex="-1"></a>  }),</span>
<span id="cb22-7"><a href="r6.html#cb22-7" tabindex="-1"></a>  <span class="at">lock_class =</span> <span class="cn">TRUE</span></span>
<span id="cb22-8"><a href="r6.html#cb22-8" tabindex="-1"></a>)</span></code></pre></div>
<p>De esta forma si intentamos utilizar <code>$set()</code> se tendrá un error:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="r6.html#cb23-1" tabindex="-1"></a>SumaAcum<span class="sc">$</span><span class="fu">set</span>(<span class="st">&#39;public&#39;</span>,<span class="st">&#39;y&#39;</span>,<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## Error in SumaAcum$set(&quot;public&quot;, &quot;y&quot;, 0): Can&#39;t modify a locked R6 class.</code></pre>
<p>Se puede también bloquear o desbloquear la clase mediante <code>$lock()</code> y <code>$unlock()</code> respectivamente.</p>
<p>###Herencia</p>
<p>Se puede heredar los comportamientos de una clase existente a otra utilizando <code>inherit</code>, para ello veamos el ejemplo:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="r6.html#cb25-1" tabindex="-1"></a>SumAcumMsg <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;SumAcumMsg&quot;</span>,</span>
<span id="cb25-2"><a href="r6.html#cb25-2" tabindex="-1"></a>  <span class="at">inherit =</span> SumAcum,</span>
<span id="cb25-3"><a href="r6.html#cb25-3" tabindex="-1"></a>  <span class="at">public =</span> <span class="fu">list</span>(</span>
<span id="cb25-4"><a href="r6.html#cb25-4" tabindex="-1"></a>    <span class="at">sumar =</span> <span class="cf">function</span>(<span class="at">x=</span><span class="dv">1</span>){</span>
<span id="cb25-5"><a href="r6.html#cb25-5" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Sumando &quot;</span>, x, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span> )</span>
<span id="cb25-6"><a href="r6.html#cb25-6" tabindex="-1"></a>      super<span class="sc">$</span><span class="fu">sumar</span>(<span class="at">x=</span>x)</span>
<span id="cb25-7"><a href="r6.html#cb25-7" tabindex="-1"></a>    }</span>
<span id="cb25-8"><a href="r6.html#cb25-8" tabindex="-1"></a>  )</span>
<span id="cb25-9"><a href="r6.html#cb25-9" tabindex="-1"></a>)</span></code></pre></div>
<p>Al agregar <code>$sumar()</code> se cambia la implementación de la clase que hereda (Super clase) y se modifica con la que se implementa en el código. Vemos que se puede acceder al método de la Super clase mediante <code>super$</code>, y cualquier método que no se modifique utilizará los métodos de la Super Clase.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="r6.html#cb26-1" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> SumAcumMsg<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb26-2"><a href="r6.html#cb26-2" tabindex="-1"></a>x2<span class="sc">$</span><span class="fu">sumar</span>(<span class="dv">5</span>)<span class="sc">$</span><span class="fu">sumar</span>(<span class="dv">3</span>)<span class="sc">$</span>suma</span>
<span id="cb26-3"><a href="r6.html#cb26-3" tabindex="-1"></a><span class="do">## Sumando 5</span></span>
<span id="cb26-4"><a href="r6.html#cb26-4" tabindex="-1"></a><span class="do">## Sumando 3</span></span>
<span id="cb26-5"><a href="r6.html#cb26-5" tabindex="-1"></a><span class="do">## [1] 8</span></span></code></pre></div>
<p>###Introspección</p>
<p>Para determinar la clase y todas las que hereda podemos utilizar <code>class()</code>:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="r6.html#cb27-1" tabindex="-1"></a><span class="fu">class</span>(x2)</span>
<span id="cb27-2"><a href="r6.html#cb27-2" tabindex="-1"></a><span class="do">## [1] &quot;SumAcumMsg&quot; &quot;SumAcum&quot;    &quot;R6&quot;</span></span></code></pre></div>
<p>Podemos ver que métodos y campos contiene utilizando <code>name()</code>:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="r6.html#cb28-1" tabindex="-1"></a><span class="fu">names</span>(Andrea2)</span>
<span id="cb28-2"><a href="r6.html#cb28-2" tabindex="-1"></a><span class="do">## [1] &quot;.__enclos_env__&quot; &quot;edad&quot;            &quot;nombre&quot;          &quot;clone&quot;          </span></span>
<span id="cb28-3"><a href="r6.html#cb28-3" tabindex="-1"></a><span class="do">## [5] &quot;print&quot;           &quot;initialize&quot;</span></span></code></pre></div>
</div>
</div>
<div id="controles-de-acceso" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Controles de Acceso<a href="r6.html#controles-de-acceso" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>R6Class()</code> tiene otros 2 argumentos que funcionan similar a <code>public</code>:</p>
<ul>
<li><p><code>private</code> permite crear campos y métodos que solo están disponibles dentro de la clase y no fuera de ella.</p></li>
<li><p><code>active</code> permite utilizar funciones de acceso para definir campos dinámicos o activos.</p></li>
</ul>
<div id="privacidad" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Privacidad<a href="r6.html#privacidad" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Con R6 es posible definir campos y metodos <strong>privados</strong>, es decir, que solo están disponibles dentro de la clase. Otros aspectos importantes de conocer son:</p>
<ul>
<li><p>El argumento <code>private</code> en <code>R6Class</code> se declara de la misma forma en la que se hace el argumento <code>public</code>, es decir, asigmar una lista de métodos (funciones) y campos (variables).</p></li>
<li><p>Los campos y métodos definidos en <code>private</code> estarán disponible dentro de los métodos usando <code>private$</code> en lugar de <code>self$</code>.</p></li>
</ul>
<p>Para poner esto en práctica, escribamos los campos <code>$edad</code> y <code>$nombre</code> como argumentos privados de la clase <em>Persona</em>.</p>
<p>Una vez definidos de esta forma, solo podremos establecer <code>$edad</code> y <code>$nombre</code> durante la creación del objeto, y no tendremos acceso a estos valores fuera de la clase.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="r6.html#cb29-1" tabindex="-1"></a>Persona <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;Persona&quot;</span>, </span>
<span id="cb29-2"><a href="r6.html#cb29-2" tabindex="-1"></a>  <span class="at">public =</span> <span class="fu">list</span>(</span>
<span id="cb29-3"><a href="r6.html#cb29-3" tabindex="-1"></a>    <span class="at">initialize =</span> <span class="cf">function</span>(nombre, <span class="at">edad =</span> <span class="cn">NA</span>) {</span>
<span id="cb29-4"><a href="r6.html#cb29-4" tabindex="-1"></a>      private<span class="sc">$</span>nombre <span class="ot">&lt;-</span> nombre</span>
<span id="cb29-5"><a href="r6.html#cb29-5" tabindex="-1"></a>      private<span class="sc">$</span>edad <span class="ot">&lt;-</span> edad</span>
<span id="cb29-6"><a href="r6.html#cb29-6" tabindex="-1"></a>    },</span>
<span id="cb29-7"><a href="r6.html#cb29-7" tabindex="-1"></a>    <span class="at">print =</span> <span class="cf">function</span>(...) {</span>
<span id="cb29-8"><a href="r6.html#cb29-8" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Persona: </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb29-9"><a href="r6.html#cb29-9" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;  Nombre: &quot;</span>, private<span class="sc">$</span>nombre, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb29-10"><a href="r6.html#cb29-10" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;  Edad:  &quot;</span>, private<span class="sc">$</span>edad, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb29-11"><a href="r6.html#cb29-11" tabindex="-1"></a>    }</span>
<span id="cb29-12"><a href="r6.html#cb29-12" tabindex="-1"></a>  ),</span>
<span id="cb29-13"><a href="r6.html#cb29-13" tabindex="-1"></a>  <span class="at">private =</span> <span class="fu">list</span>(</span>
<span id="cb29-14"><a href="r6.html#cb29-14" tabindex="-1"></a>    <span class="at">edad =</span> <span class="cn">NA</span>,</span>
<span id="cb29-15"><a href="r6.html#cb29-15" tabindex="-1"></a>    <span class="at">nombre =</span> <span class="cn">NULL</span></span>
<span id="cb29-16"><a href="r6.html#cb29-16" tabindex="-1"></a>  )</span>
<span id="cb29-17"><a href="r6.html#cb29-17" tabindex="-1"></a>)</span>
<span id="cb29-18"><a href="r6.html#cb29-18" tabindex="-1"></a></span>
<span id="cb29-19"><a href="r6.html#cb29-19" tabindex="-1"></a>Andrea3 <span class="ot">&lt;-</span> Persona<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;Andrea&quot;</span>)</span>
<span id="cb29-20"><a href="r6.html#cb29-20" tabindex="-1"></a>Andrea3</span>
<span id="cb29-21"><a href="r6.html#cb29-21" tabindex="-1"></a><span class="do">## Persona: </span></span>
<span id="cb29-22"><a href="r6.html#cb29-22" tabindex="-1"></a><span class="do">##   Nombre: Andrea</span></span>
<span id="cb29-23"><a href="r6.html#cb29-23" tabindex="-1"></a><span class="do">##   Edad:  NA</span></span>
<span id="cb29-24"><a href="r6.html#cb29-24" tabindex="-1"></a>Andrea3<span class="sc">$</span>nombre</span>
<span id="cb29-25"><a href="r6.html#cb29-25" tabindex="-1"></a><span class="do">## NULL</span></span></code></pre></div>
<p>Esta distinción entre campos públicos y privados es importante cuando se crea redes complejas de clases, ya que será fundamental tener claro a los campos que otros podrán acceder y cuales no.</p>
<p>Todo lo que sea privado se puede refactorizar más fácilmente porque sabes que los demás no dependen de estos campos. Los métodos privados tienden a ser menos importantes en R en comparación con otros lenguajes de programación porque las jerarquías de objetos en R tienden a ser más simples.</p>
</div>
<div id="campos-activos" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Campos Activos<a href="r6.html#campos-activos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Los campos activos permiten definir componentes que funcionan como campos para los usuarios, pero están definidos como funciones, es decir, como métodos.</p>
<p>Los campos activos están implementados usando <strong>enlaces activos</strong>, que son funciones que toman un único argumento (<code>value</code>), si el argumento es <code>missing()</code>, significa que el valor se está recuperando, o de lo contrario se está modificando.</p>
<p>Por ejemplo, creemos un campo activo llamado <code>random</code> que nos devuelva un valor diferente cada que accedemos a el:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="r6.html#cb30-1" tabindex="-1"></a>Ran <span class="ot">&lt;-</span> R6<span class="sc">::</span><span class="fu">R6Class</span>(<span class="st">&quot;Ran&quot;</span>, <span class="at">active =</span> <span class="fu">list</span>(</span>
<span id="cb30-2"><a href="r6.html#cb30-2" tabindex="-1"></a>  <span class="at">random =</span> <span class="cf">function</span>(value) {</span>
<span id="cb30-3"><a href="r6.html#cb30-3" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">missing</span>(value)) {</span>
<span id="cb30-4"><a href="r6.html#cb30-4" tabindex="-1"></a>      <span class="fu">runif</span>(<span class="dv">1</span>)  </span>
<span id="cb30-5"><a href="r6.html#cb30-5" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb30-6"><a href="r6.html#cb30-6" tabindex="-1"></a>      <span class="fu">stop</span>(<span class="st">&quot;Can&#39;t set `$random`&quot;</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb30-7"><a href="r6.html#cb30-7" tabindex="-1"></a>    }</span>
<span id="cb30-8"><a href="r6.html#cb30-8" tabindex="-1"></a>  }</span>
<span id="cb30-9"><a href="r6.html#cb30-9" tabindex="-1"></a>))</span>
<span id="cb30-10"><a href="r6.html#cb30-10" tabindex="-1"></a>x <span class="ot">&lt;-</span> Ran<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb30-11"><a href="r6.html#cb30-11" tabindex="-1"></a>x<span class="sc">$</span>random</span>
<span id="cb30-12"><a href="r6.html#cb30-12" tabindex="-1"></a><span class="do">## [1] 0.9288203</span></span>
<span id="cb30-13"><a href="r6.html#cb30-13" tabindex="-1"></a>x<span class="sc">$</span>random</span>
<span id="cb30-14"><a href="r6.html#cb30-14" tabindex="-1"></a><span class="do">## [1] 0.2835162</span></span>
<span id="cb30-15"><a href="r6.html#cb30-15" tabindex="-1"></a>x<span class="sc">$</span>random</span>
<span id="cb30-16"><a href="r6.html#cb30-16" tabindex="-1"></a><span class="do">## [1] 0.4035552</span></span></code></pre></div>
<p>Los campos activos son usandos particularmente junto con el argumento de campos privamos, ya que esto hace posible implementar componentes similares a los campos pero con controles adicionales. Por ejemplo, podemos usar esto para crear un campo solo de lectura para <code>edad</code>, y para asegurarnos que <code>nombre</code> sea un vector de un solo caracter.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="r6.html#cb31-1" tabindex="-1"></a>Persona <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;Person&quot;</span>, </span>
<span id="cb31-2"><a href="r6.html#cb31-2" tabindex="-1"></a>  </span>
<span id="cb31-3"><a href="r6.html#cb31-3" tabindex="-1"></a>  <span class="at">private =</span> <span class="fu">list</span>(</span>
<span id="cb31-4"><a href="r6.html#cb31-4" tabindex="-1"></a>    <span class="at">.edad =</span> <span class="cn">NA</span>,</span>
<span id="cb31-5"><a href="r6.html#cb31-5" tabindex="-1"></a>    <span class="at">.nombre =</span> <span class="cn">NULL</span></span>
<span id="cb31-6"><a href="r6.html#cb31-6" tabindex="-1"></a>  ),</span>
<span id="cb31-7"><a href="r6.html#cb31-7" tabindex="-1"></a>  </span>
<span id="cb31-8"><a href="r6.html#cb31-8" tabindex="-1"></a>  <span class="at">active =</span> <span class="fu">list</span>(</span>
<span id="cb31-9"><a href="r6.html#cb31-9" tabindex="-1"></a>    <span class="at">edad =</span> <span class="cf">function</span>(value) {</span>
<span id="cb31-10"><a href="r6.html#cb31-10" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">missing</span>(value)) {</span>
<span id="cb31-11"><a href="r6.html#cb31-11" tabindex="-1"></a>        private<span class="sc">$</span>.edad</span>
<span id="cb31-12"><a href="r6.html#cb31-12" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb31-13"><a href="r6.html#cb31-13" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;`$edad` solo se puede leeer&quot;</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-14"><a href="r6.html#cb31-14" tabindex="-1"></a>      }</span>
<span id="cb31-15"><a href="r6.html#cb31-15" tabindex="-1"></a>    },</span>
<span id="cb31-16"><a href="r6.html#cb31-16" tabindex="-1"></a>    <span class="at">name =</span> <span class="cf">function</span>(value) {</span>
<span id="cb31-17"><a href="r6.html#cb31-17" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">missing</span>(value)) {</span>
<span id="cb31-18"><a href="r6.html#cb31-18" tabindex="-1"></a>        private<span class="sc">$</span>.nombre</span>
<span id="cb31-19"><a href="r6.html#cb31-19" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb31-20"><a href="r6.html#cb31-20" tabindex="-1"></a>        <span class="fu">stopifnot</span>(<span class="fu">is.character</span>(value), <span class="fu">length</span>(value) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb31-21"><a href="r6.html#cb31-21" tabindex="-1"></a>        private<span class="sc">$</span>.nombre <span class="ot">&lt;-</span> value</span>
<span id="cb31-22"><a href="r6.html#cb31-22" tabindex="-1"></a>        self</span>
<span id="cb31-23"><a href="r6.html#cb31-23" tabindex="-1"></a>      }</span>
<span id="cb31-24"><a href="r6.html#cb31-24" tabindex="-1"></a>    }</span>
<span id="cb31-25"><a href="r6.html#cb31-25" tabindex="-1"></a>  ),</span>
<span id="cb31-26"><a href="r6.html#cb31-26" tabindex="-1"></a>  </span>
<span id="cb31-27"><a href="r6.html#cb31-27" tabindex="-1"></a>  <span class="at">public =</span> <span class="fu">list</span>(</span>
<span id="cb31-28"><a href="r6.html#cb31-28" tabindex="-1"></a>    <span class="at">initialize =</span> <span class="cf">function</span>(nombre, <span class="at">edad =</span> <span class="cn">NA</span>) {</span>
<span id="cb31-29"><a href="r6.html#cb31-29" tabindex="-1"></a>      private<span class="sc">$</span>.nombre <span class="ot">&lt;-</span> nombre</span>
<span id="cb31-30"><a href="r6.html#cb31-30" tabindex="-1"></a>      private<span class="sc">$</span>.edad <span class="ot">&lt;-</span> edad</span>
<span id="cb31-31"><a href="r6.html#cb31-31" tabindex="-1"></a>    }</span>
<span id="cb31-32"><a href="r6.html#cb31-32" tabindex="-1"></a>  )</span>
<span id="cb31-33"><a href="r6.html#cb31-33" tabindex="-1"></a>  </span>
<span id="cb31-34"><a href="r6.html#cb31-34" tabindex="-1"></a>)</span>
<span id="cb31-35"><a href="r6.html#cb31-35" tabindex="-1"></a></span>
<span id="cb31-36"><a href="r6.html#cb31-36" tabindex="-1"></a>Andrea4 <span class="ot">&lt;-</span> Persona<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;Andrea&quot;</span>, <span class="at">edad =</span> <span class="dv">22</span>)</span>
<span id="cb31-37"><a href="r6.html#cb31-37" tabindex="-1"></a>Andrea4<span class="sc">$</span>nombre</span>
<span id="cb31-38"><a href="r6.html#cb31-38" tabindex="-1"></a><span class="do">## NULL</span></span>
<span id="cb31-39"><a href="r6.html#cb31-39" tabindex="-1"></a>Andrea4<span class="sc">$</span>nombre <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb31-40"><a href="r6.html#cb31-40" tabindex="-1"></a><span class="do">## Error in Andrea4$nombre &lt;- 10: no se pueden adicionar vínculos a un ambiente bloqueado</span></span>
<span id="cb31-41"><a href="r6.html#cb31-41" tabindex="-1"></a>Andrea4<span class="sc">$</span>edad <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb31-42"><a href="r6.html#cb31-42" tabindex="-1"></a><span class="do">## Error: `$edad` solo se puede leeer</span></span></code></pre></div>
</div>
</div>
<div id="semántica-de-referencia" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Semántica de referencia<a href="r6.html#semántica-de-referencia" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Una de las grandes diferencias entre R6 y la mayoría de los demás objetos es que tienen una semántica de referencia. La principal consecuencia de la semántica de referencia es que los objetos no se copian cuando se modifican:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="r6.html#cb32-1" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> SumaAcum<span class="sc">$</span><span class="fu">new</span>() </span>
<span id="cb32-2"><a href="r6.html#cb32-2" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> y1</span>
<span id="cb32-3"><a href="r6.html#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="r6.html#cb32-4" tabindex="-1"></a>y1<span class="sc">$</span><span class="fu">sumar</span>(<span class="dv">10</span>)</span>
<span id="cb32-5"><a href="r6.html#cb32-5" tabindex="-1"></a><span class="fu">c</span>(<span class="at">y1 =</span> y1<span class="sc">$</span>suma, <span class="at">y2 =</span> y2<span class="sc">$</span>suma)</span>
<span id="cb32-6"><a href="r6.html#cb32-6" tabindex="-1"></a><span class="do">## y1 y2 </span></span>
<span id="cb32-7"><a href="r6.html#cb32-7" tabindex="-1"></a><span class="do">## 10 10</span></span></code></pre></div>
<p>En cambio, si queremos copiar, necesitamos expecificarlo con el método <code>$clone()</code>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="r6.html#cb33-1" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> SumaAcum<span class="sc">$</span><span class="fu">new</span>() </span>
<span id="cb33-2"><a href="r6.html#cb33-2" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> y1<span class="sc">$</span><span class="fu">clone</span>()</span>
<span id="cb33-3"><a href="r6.html#cb33-3" tabindex="-1"></a></span>
<span id="cb33-4"><a href="r6.html#cb33-4" tabindex="-1"></a>y1<span class="sc">$</span><span class="fu">sumar</span>(<span class="dv">10</span>)</span>
<span id="cb33-5"><a href="r6.html#cb33-5" tabindex="-1"></a><span class="fu">c</span>(<span class="at">y1 =</span> y1<span class="sc">$</span>suma, <span class="at">y2 =</span> y2<span class="sc">$</span>suma)</span>
<span id="cb33-6"><a href="r6.html#cb33-6" tabindex="-1"></a><span class="do">## y1 y2 </span></span>
<span id="cb33-7"><a href="r6.html#cb33-7" tabindex="-1"></a><span class="do">## 10  0</span></span></code></pre></div>
<p>(<code>$clone()</code> no clona recursivamente objetos R6 anidados. Si quieres eso, necesitarás usar <code>$clone(deep = TRUE)</code>.)</p>
<p>Hay otras tres consecuencias menos intuitivas:</p>
<ul>
<li><p>Es más difícil razonar sobre el código que utiliza objetos R6 porque es necesario comprender más contexto.</p></li>
<li><p>Tiene sentido pensar en cuándo se elimina un objeto R6 y puede escribir <code>$finalize()</code> para complementar <code>$initialize()</code>.</p></li>
<li><p>Si uno de los campos es un objeto R6, debe crearlo dentro de <code>$initialize()</code>, no de R6Class().</p></li>
</ul>
<p>Estas están descritas con mayor detalle a continuación.</p>
<div id="razonamientos" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Razonamientos<a href="r6.html#razonamientos" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Generalmente, las semanticas de referencias hacen el código más difícil de entender. Tomemos el siguiente ejemplo sencillo:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="r6.html#cb34-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span>)</span>
<span id="cb34-2"><a href="r6.html#cb34-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">b =</span> <span class="dv">2</span>)</span>
<span id="cb34-3"><a href="r6.html#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="r6.html#cb34-4" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">f</span>(x, y)</span></code></pre></div>
<p>Para la gran mayoría de funciones, sabes que la línea final solo modifica <code>z</code>.</p>
<p>Ahora, tomemos un ejemplo similar que utiliza una clase de referencia de <code>Lista</code> imaginaria:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="r6.html#cb35-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> Lista<span class="sc">$</span><span class="fu">new</span>(<span class="at">a =</span> <span class="dv">1</span>)</span>
<span id="cb35-2"><a href="r6.html#cb35-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> Lista<span class="sc">$</span><span class="fu">new</span>(<span class="at">b =</span> <span class="dv">2</span>)</span>
<span id="cb35-3"><a href="r6.html#cb35-3" tabindex="-1"></a></span>
<span id="cb35-4"><a href="r6.html#cb35-4" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">f</span>(x, y)</span></code></pre></div>
<p>Es mucho más difícil de entender la línea final: si <code>f()</code> llama a métodos de <code>x</code> o <code>y</code>, podría modificarlos al igual que <code>z</code>. Este es el mayor inconveniente potencial de R6 y se debe tener cuidado de evitarlo escribiendo funciones que devuelvan un valor o modifiquen sus entradas de R6, pero no ambas.</p>
</div>
<div id="finalización" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Finalización<a href="r6.html#finalización" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La semántica de referencia, permite pensar en el momento en que un objeto R6 es finalizado o eliminado. Esto es diferente a la mayoría de los objetos en R, donde la semántica de copia al modificar significa que puede haber muchas versiones transitorias de un objeto, lo que no permite pensar en cuándo se elimina un objeto de forma lógica.</p>
<p>Por ejemplo, en el caso de objetos de tipo factor en R, cuando se modifican los niveles de un factor, se crea un nuevo objeto factor y el objeto original se deja para que lo recolecte el recolector de basura.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="r6.html#cb36-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>))</span>
<span id="cb36-2"><a href="r6.html#cb36-2" tabindex="-1"></a><span class="fu">levels</span>(x) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>)</span></code></pre></div>
<p>Debido a que los objetos R6 no se copian al modificarlos, solo se eliminan una vez, tiene sentido pensar en el método <code>$finalize()</code> como un complemento al método <code>$initialize()</code>. Los finalizadores generalmente tienen un papel similar a <code>on.exit()</code>, limpiando cualquier recurso creado por el inicializador.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="r6.html#cb37-1" tabindex="-1"></a>ArchivoTemporal <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;ArchivoTemporal&quot;</span>, <span class="fu">list</span>(</span>
<span id="cb37-2"><a href="r6.html#cb37-2" tabindex="-1"></a>  <span class="at">ruta =</span> <span class="cn">NULL</span>,</span>
<span id="cb37-3"><a href="r6.html#cb37-3" tabindex="-1"></a>  <span class="at">initialize =</span> <span class="cf">function</span>() {</span>
<span id="cb37-4"><a href="r6.html#cb37-4" tabindex="-1"></a>    self<span class="sc">$</span>ruta <span class="ot">&lt;-</span> <span class="fu">tempfile</span>()</span>
<span id="cb37-5"><a href="r6.html#cb37-5" tabindex="-1"></a>  },</span>
<span id="cb37-6"><a href="r6.html#cb37-6" tabindex="-1"></a>  <span class="at">finalize =</span> <span class="cf">function</span>() {</span>
<span id="cb37-7"><a href="r6.html#cb37-7" tabindex="-1"></a>    <span class="fu">message</span>(<span class="st">&quot;Cleaning up &quot;</span>, self<span class="sc">$</span>ruta)</span>
<span id="cb37-8"><a href="r6.html#cb37-8" tabindex="-1"></a>    <span class="fu">unlink</span>(self<span class="sc">$</span>ruta)</span>
<span id="cb37-9"><a href="r6.html#cb37-9" tabindex="-1"></a>  }</span>
<span id="cb37-10"><a href="r6.html#cb37-10" tabindex="-1"></a>))</span></code></pre></div>
<p>El ejemplo proporcionado muestra una clase llamada <code>ArchivoTemporal</code>, que encapsula un archivo temporal y se encarga de eliminarlo automáticamente cuando se finaliza la instancia de la clase.</p>
<p>El método <code>finalize</code> será ejecutado cuando el objeto sea eliminado (o más precisamente, por la primera recolección de basura después de que el objeto haya sido desligado de todos los nombres) o cuando R se cierre.</p>
<p>Esto significa que el finalizador puede ser llamado efectivamente en cualquier parte de tu código en R, lo que hace casi imposible razonar sobre el código del finalizador que toca estructuras de datos compartidas. Se recomienda evitar estos posibles problemas utilizando el finalizador solo para limpiar recursos privados asignados por el inicializador.</p>
<p>Finalmente, veamos cómo se utiliza esta clase <code>ArchivoTemporal</code> creando una instancia, luego eliminando explícitamente la instancia con <code>rm()</code>, lo que provoca que el finalizador se ejecute para limpiar el archivo temporal.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="r6.html#cb38-1" tabindex="-1"></a>at <span class="ot">&lt;-</span> ArchivoTemporal<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb38-2"><a href="r6.html#cb38-2" tabindex="-1"></a><span class="fu">rm</span>(at)</span></code></pre></div>
<p>En resumen, los objetos R6 permiten definir métodos <code>initialize</code> y <code>finalize</code>, que se ejecutan al crear y eliminar instancias de la clase respectivamente, permitiendo una gestión más controlada de los recursos y la limpieza de la memoria.</p>
</div>
<div id="campos-en-r6" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Campos en R6<a href="r6.html#campos-en-r6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una última consecuencia que puede surgir al utilizar semántica de referencia en R6, es particularmente cuando se usa una instancia de una clase R6 como valor predeterminado de un campo. La semántica de referencia significa que cuando asignas un objeto a otro, no se crea una copia independiente, sino que ambos hacen referencia al mismo objeto en la memoria.</p>
<p>Por ejemplo, creemos una clase llamada <code>DatabaseTemporal</code> que tiene un campo <code>archivo</code>, que es una instancia de la clase <code>ArchivoTemporal</code>.</p>
<p>Por ejemplo, dado el siguiente código, queremos crear una base de datos temporal cada vez que llamamos a DatabaseTemporal$new(), pero el código actual siempre usa la misma ruta.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="r6.html#cb39-1" tabindex="-1"></a>DatabaseTemporal <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;DatabaseTemporal&quot;</span>, <span class="fu">list</span>(</span>
<span id="cb39-2"><a href="r6.html#cb39-2" tabindex="-1"></a>  <span class="at">con =</span> <span class="cn">NULL</span>,</span>
<span id="cb39-3"><a href="r6.html#cb39-3" tabindex="-1"></a>  <span class="at">file =</span> ArchivoTemporal<span class="sc">$</span><span class="fu">new</span>(),</span>
<span id="cb39-4"><a href="r6.html#cb39-4" tabindex="-1"></a>  <span class="at">initialize =</span> <span class="cf">function</span>() {</span>
<span id="cb39-5"><a href="r6.html#cb39-5" tabindex="-1"></a>    self<span class="sc">$</span>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(), <span class="at">ruta =</span> file<span class="sc">$</span>ruta)</span>
<span id="cb39-6"><a href="r6.html#cb39-6" tabindex="-1"></a>  },</span>
<span id="cb39-7"><a href="r6.html#cb39-7" tabindex="-1"></a>  <span class="at">finalize =</span> <span class="cf">function</span>() {</span>
<span id="cb39-8"><a href="r6.html#cb39-8" tabindex="-1"></a>    DBI<span class="sc">::</span><span class="fu">dbDisconnect</span>(self<span class="sc">$</span>con)</span>
<span id="cb39-9"><a href="r6.html#cb39-9" tabindex="-1"></a>  }</span>
<span id="cb39-10"><a href="r6.html#cb39-10" tabindex="-1"></a>))</span>
<span id="cb39-11"><a href="r6.html#cb39-11" tabindex="-1"></a></span>
<span id="cb39-12"><a href="r6.html#cb39-12" tabindex="-1"></a>db_a <span class="ot">&lt;-</span> DatabaseTemporal<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb39-13"><a href="r6.html#cb39-13" tabindex="-1"></a>db_b <span class="ot">&lt;-</span> DatabaseTemporal<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb39-14"><a href="r6.html#cb39-14" tabindex="-1"></a></span>
<span id="cb39-15"><a href="r6.html#cb39-15" tabindex="-1"></a>db_a<span class="sc">$</span>file<span class="sc">$</span>ruta <span class="sc">==</span> db_b<span class="sc">$</span>file<span class="sc">$</span>ruta</span>
<span id="cb39-16"><a href="r6.html#cb39-16" tabindex="-1"></a><span class="do">## [1] TRUE</span></span></code></pre></div>
<p>(Si está familiarizado con Python, esto es muy similar al problema del “argumento predeterminado mutable”).</p>
<p>El problema es que, cuando se usa una instancia de clase como valor predeterminado para un campo, esa instancia se comparte entre todas las instancias de la clase. Por lo tanto, cada instancia de <code>DatabaseTemporal</code> está haciendo referencia al mismo objeto <code>ArchivoTemporal</code>, en lugar de tener su propia instancia única.</p>
<p>Para solucionar este problema, se debe crear una nueva instancia de <code>ArchivoTemporal</code> dentro del método <code>initialize()</code>, de modo que cada instancia de <code>DatabaseTemporal</code> tenga su propia instancia única de <code>ArchivoTemporal</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="r6.html#cb40-1" tabindex="-1"></a>DatabaseTemporal <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;DatabaseTemporal&quot;</span>, <span class="fu">list</span>(</span>
<span id="cb40-2"><a href="r6.html#cb40-2" tabindex="-1"></a>  <span class="at">con =</span> <span class="cn">NULL</span>,</span>
<span id="cb40-3"><a href="r6.html#cb40-3" tabindex="-1"></a>  <span class="at">archivo =</span> <span class="cn">NULL</span>,</span>
<span id="cb40-4"><a href="r6.html#cb40-4" tabindex="-1"></a>  <span class="at">initialize =</span> <span class="cf">function</span>() {</span>
<span id="cb40-5"><a href="r6.html#cb40-5" tabindex="-1"></a>    self<span class="sc">$</span>archivo <span class="ot">&lt;-</span> ArchivoTemporal<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb40-6"><a href="r6.html#cb40-6" tabindex="-1"></a>    self<span class="sc">$</span>con <span class="ot">&lt;-</span> DBI<span class="sc">::</span><span class="fu">dbConnect</span>(RSQLite<span class="sc">::</span><span class="fu">SQLite</span>(),</span>
<span id="cb40-7"><a href="r6.html#cb40-7" tabindex="-1"></a>                               <span class="at">ruta =</span> file<span class="sc">$</span>ruta)</span>
<span id="cb40-8"><a href="r6.html#cb40-8" tabindex="-1"></a>  },</span>
<span id="cb40-9"><a href="r6.html#cb40-9" tabindex="-1"></a>  <span class="at">finalize =</span> <span class="cf">function</span>() {</span>
<span id="cb40-10"><a href="r6.html#cb40-10" tabindex="-1"></a>    DBI<span class="sc">::</span><span class="fu">dbDisconnect</span>(self<span class="sc">$</span>con)</span>
<span id="cb40-11"><a href="r6.html#cb40-11" tabindex="-1"></a>  }</span>
<span id="cb40-12"><a href="r6.html#cb40-12" tabindex="-1"></a>))</span>
<span id="cb40-13"><a href="r6.html#cb40-13" tabindex="-1"></a></span>
<span id="cb40-14"><a href="r6.html#cb40-14" tabindex="-1"></a>db_a <span class="ot">&lt;-</span> DatabaseTemporal<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb40-15"><a href="r6.html#cb40-15" tabindex="-1"></a>db_b <span class="ot">&lt;-</span> DatabaseTemporal<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb40-16"><a href="r6.html#cb40-16" tabindex="-1"></a></span>
<span id="cb40-17"><a href="r6.html#cb40-17" tabindex="-1"></a>db_a<span class="sc">$</span>archivo<span class="sc">$</span>ruta <span class="sc">==</span> db_b<span class="sc">$</span>archivo<span class="sc">$</span>ruta</span>
<span id="cb40-18"><a href="r6.html#cb40-18" tabindex="-1"></a><span class="do">## [1] FALSE</span></span></code></pre></div>
<p>Ahora, cada instancia de <code>DatabaseTemporal</code> tiene su propia instancia única de <code>ArchivoTemporal</code>, y por lo tanto, sus caminos de archivo son diferentes, como se espera. Esto garantiza que cada instancia de <code>DatabaseTemporal</code> tenga sus propios recursos independientes.</p>
</div>
</div>
<div id="por-qué-r6" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> ¿Por qué R6?<a href="r6.html#por-qué-r6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Este texto explica por qué el autor prefiere utilizar R6 en lugar de Reference Classes (RC), una sistema de programación orientada a objetos (OO) incorporado en R, debido a las siguientes razones:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Simplicidad</strong>: R6 es mucho más simple que RC. Mientras que ambos están construidos sobre entornos (<em>environments</em>), R6 utiliza el sistema S3, que es más sencillo y fácil de entender que el sistema S4 utilizado por RC.</p></li>
<li><p><strong>Documentación exhaustiva</strong>: R6 cuenta con una documentación completa en línea disponible en <a href="https://r6.r-lib.org" class="uri">https://r6.r-lib.org</a>. Esta documentación proporciona recursos detallados y ejemplos para comprender y utilizar R6 de manera efectiva.</p></li>
<li><p><strong>Subclases entre paquetes</strong>: R6 ofrece un mecanismo más simple para la subclases entre paquetes, que funciona automáticamente sin necesidad de que el usuario lo configure. Por el contrario, RC requiere más configuración y atención al detalle para lograr la misma funcionalidad.</p></li>
<li><p><strong>Separación de variables y campos</strong>: En RC, las variables y los campos se mezclan en la misma pila de entornos, lo que puede conducir a confusión y a errores potenciales. En R6, los campos se colocan en un entorno separado, lo que hace que el código sea más explícito y menos propenso a errores.</p></li>
<li><p><strong>Velocidad</strong>: R6 es mucho más rápido que RC en términos de tiempo de despacho de métodos. Aunque generalmente la velocidad de despacho de métodos no es crítica en aplicaciones del mundo real, RC es notablemente más lento, y el cambio de RC a R6 ha llevado a mejoras sustanciales de rendimiento en el paquete Shiny.</p></li>
<li><p><strong>Independencia de la versión de R</strong>: RC está ligado a una versión específica de R. Esto significa que cualquier corrección de errores en RC solo se puede aprovechar si se requiere una versión más reciente de R. Esto puede dificultar la compatibilidad entre paquetes que necesitan funcionar en diferentes versiones de R.</p></li>
</ol>
</div>
<div id="ejercicios-prácticos" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Ejercicios prácticos<a href="r6.html#ejercicios-prácticos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Create a bank account R6 class that stores a balance and allows you to deposit and withdraw money. Create a subclass that throws an error if you attempt to go into overdraft. Create another subclass that allows you to go into overdraft, but charges you a fee.</li>
</ol>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="r6.html#cb41-1" tabindex="-1"></a>CuentaBanco <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;CuentaBanco&quot;</span>,</span>
<span id="cb41-2"><a href="r6.html#cb41-2" tabindex="-1"></a>  <span class="at">private =</span> <span class="fu">list</span>(</span>
<span id="cb41-3"><a href="r6.html#cb41-3" tabindex="-1"></a>    <span class="at">saldo =</span> <span class="dv">0</span></span>
<span id="cb41-4"><a href="r6.html#cb41-4" tabindex="-1"></a>  ),</span>
<span id="cb41-5"><a href="r6.html#cb41-5" tabindex="-1"></a>  <span class="at">active =</span> <span class="fu">list</span>(</span>
<span id="cb41-6"><a href="r6.html#cb41-6" tabindex="-1"></a>    <span class="at">.saldo =</span> <span class="cf">function</span>(value){</span>
<span id="cb41-7"><a href="r6.html#cb41-7" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">missing</span>(value)) {</span>
<span id="cb41-8"><a href="r6.html#cb41-8" tabindex="-1"></a>        private<span class="sc">$</span>saldo</span>
<span id="cb41-9"><a href="r6.html#cb41-9" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb41-10"><a href="r6.html#cb41-10" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;`$saldo` solo se puede leer NO modificar&quot;</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-11"><a href="r6.html#cb41-11" tabindex="-1"></a>      }</span>
<span id="cb41-12"><a href="r6.html#cb41-12" tabindex="-1"></a>    }</span>
<span id="cb41-13"><a href="r6.html#cb41-13" tabindex="-1"></a>  ),</span>
<span id="cb41-14"><a href="r6.html#cb41-14" tabindex="-1"></a>  <span class="at">public =</span> <span class="fu">list</span>(</span>
<span id="cb41-15"><a href="r6.html#cb41-15" tabindex="-1"></a>    <span class="at">initialize =</span> <span class="cf">function</span>(<span class="at">x=</span><span class="dv">0</span>){</span>
<span id="cb41-16"><a href="r6.html#cb41-16" tabindex="-1"></a>      private<span class="sc">$</span>saldo <span class="ot">&lt;-</span> x</span>
<span id="cb41-17"><a href="r6.html#cb41-17" tabindex="-1"></a>    },</span>
<span id="cb41-18"><a href="r6.html#cb41-18" tabindex="-1"></a>    <span class="at">depositar =</span> <span class="cf">function</span>(x){</span>
<span id="cb41-19"><a href="r6.html#cb41-19" tabindex="-1"></a>      private<span class="sc">$</span>saldo <span class="ot">&lt;-</span> private<span class="sc">$</span>saldo <span class="sc">+</span> x</span>
<span id="cb41-20"><a href="r6.html#cb41-20" tabindex="-1"></a>      <span class="fu">invisible</span>(self)</span>
<span id="cb41-21"><a href="r6.html#cb41-21" tabindex="-1"></a>    },</span>
<span id="cb41-22"><a href="r6.html#cb41-22" tabindex="-1"></a>    <span class="at">retirar =</span> <span class="cf">function</span>(x){</span>
<span id="cb41-23"><a href="r6.html#cb41-23" tabindex="-1"></a>      private<span class="sc">$</span>saldo <span class="ot">=</span> private<span class="sc">$</span>saldo <span class="sc">-</span> x</span>
<span id="cb41-24"><a href="r6.html#cb41-24" tabindex="-1"></a>      <span class="fu">invisible</span>(self)</span>
<span id="cb41-25"><a href="r6.html#cb41-25" tabindex="-1"></a>    },</span>
<span id="cb41-26"><a href="r6.html#cb41-26" tabindex="-1"></a>    <span class="at">print =</span> <span class="cf">function</span>(...){</span>
<span id="cb41-27"><a href="r6.html#cb41-27" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;Cuenta: </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb41-28"><a href="r6.html#cb41-28" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;  Saldo: &quot;</span>, private<span class="sc">$</span>saldo, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb41-29"><a href="r6.html#cb41-29" tabindex="-1"></a>    }</span>
<span id="cb41-30"><a href="r6.html#cb41-30" tabindex="-1"></a>  )</span>
<span id="cb41-31"><a href="r6.html#cb41-31" tabindex="-1"></a>)</span>
<span id="cb41-32"><a href="r6.html#cb41-32" tabindex="-1"></a></span>
<span id="cb41-33"><a href="r6.html#cb41-33" tabindex="-1"></a>SubCuentaBanco1 <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&#39;SubCuentaBanco1&#39;</span>,</span>
<span id="cb41-34"><a href="r6.html#cb41-34" tabindex="-1"></a>  <span class="at">inherit =</span> CuentaBanco,</span>
<span id="cb41-35"><a href="r6.html#cb41-35" tabindex="-1"></a>  <span class="at">public =</span>  <span class="fu">list</span>(</span>
<span id="cb41-36"><a href="r6.html#cb41-36" tabindex="-1"></a>    <span class="at">retirar =</span> <span class="cf">function</span>(x){</span>
<span id="cb41-37"><a href="r6.html#cb41-37" tabindex="-1"></a>      <span class="fu">stopifnot</span>(<span class="st">&quot;Existe sobregiro&quot;</span><span class="ot">=</span> super<span class="sc">$</span>.saldo<span class="sc">-</span>x<span class="sc">&gt;=</span><span class="dv">0</span>)</span>
<span id="cb41-38"><a href="r6.html#cb41-38" tabindex="-1"></a>      private<span class="sc">$</span>saldo<span class="ot">&lt;-</span>super<span class="sc">$</span><span class="fu">retirar</span>(x)<span class="sc">$</span>.saldo</span>
<span id="cb41-39"><a href="r6.html#cb41-39" tabindex="-1"></a>      }</span>
<span id="cb41-40"><a href="r6.html#cb41-40" tabindex="-1"></a>  )                          </span>
<span id="cb41-41"><a href="r6.html#cb41-41" tabindex="-1"></a>)</span>
<span id="cb41-42"><a href="r6.html#cb41-42" tabindex="-1"></a></span>
<span id="cb41-43"><a href="r6.html#cb41-43" tabindex="-1"></a>SubCuentaBanco2 <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&#39;SubCuentaBanco2&#39;</span>,</span>
<span id="cb41-44"><a href="r6.html#cb41-44" tabindex="-1"></a>  <span class="at">inherit =</span> CuentaBanco,</span>
<span id="cb41-45"><a href="r6.html#cb41-45" tabindex="-1"></a>  <span class="at">public =</span>  <span class="fu">list</span>(</span>
<span id="cb41-46"><a href="r6.html#cb41-46" tabindex="-1"></a>    <span class="at">retirar =</span> <span class="cf">function</span>(x){</span>
<span id="cb41-47"><a href="r6.html#cb41-47" tabindex="-1"></a>      <span class="cf">if</span>(super<span class="sc">$</span>.saldo<span class="sc">-</span>x<span class="sc">&lt;</span><span class="dv">0</span>){</span>
<span id="cb41-48"><a href="r6.html#cb41-48" tabindex="-1"></a>        private<span class="sc">$</span>saldo <span class="ot">&lt;-</span> super<span class="sc">$</span><span class="fu">retirar</span>(x)<span class="sc">$</span>.saldo <span class="sc">-</span> <span class="dv">1</span> <span class="co">#Cargo extra 1  </span></span>
<span id="cb41-49"><a href="r6.html#cb41-49" tabindex="-1"></a>      }</span>
<span id="cb41-50"><a href="r6.html#cb41-50" tabindex="-1"></a>      <span class="cf">else</span>{private<span class="sc">$</span>saldo <span class="ot">&lt;-</span> super<span class="sc">$</span><span class="fu">retirar</span>(x)<span class="sc">$</span>.saldo}</span>
<span id="cb41-51"><a href="r6.html#cb41-51" tabindex="-1"></a>      }</span>
<span id="cb41-52"><a href="r6.html#cb41-52" tabindex="-1"></a>  )                          </span>
<span id="cb41-53"><a href="r6.html#cb41-53" tabindex="-1"></a>)</span>
<span id="cb41-54"><a href="r6.html#cb41-54" tabindex="-1"></a></span>
<span id="cb41-55"><a href="r6.html#cb41-55" tabindex="-1"></a>Fab <span class="ot">&lt;-</span> CuentaBanco<span class="sc">$</span><span class="fu">new</span>(<span class="dv">100</span>)</span>
<span id="cb41-56"><a href="r6.html#cb41-56" tabindex="-1"></a>Fab</span>
<span id="cb41-57"><a href="r6.html#cb41-57" tabindex="-1"></a><span class="do">## Cuenta: </span></span>
<span id="cb41-58"><a href="r6.html#cb41-58" tabindex="-1"></a><span class="do">##   Saldo: 100</span></span>
<span id="cb41-59"><a href="r6.html#cb41-59" tabindex="-1"></a></span>
<span id="cb41-60"><a href="r6.html#cb41-60" tabindex="-1"></a>Fab<span class="sc">$</span><span class="fu">retirar</span>(<span class="dv">50</span>)</span>
<span id="cb41-61"><a href="r6.html#cb41-61" tabindex="-1"></a>Fab</span>
<span id="cb41-62"><a href="r6.html#cb41-62" tabindex="-1"></a><span class="do">## Cuenta: </span></span>
<span id="cb41-63"><a href="r6.html#cb41-63" tabindex="-1"></a><span class="do">##   Saldo: 50</span></span>
<span id="cb41-64"><a href="r6.html#cb41-64" tabindex="-1"></a></span>
<span id="cb41-65"><a href="r6.html#cb41-65" tabindex="-1"></a>Fab<span class="sc">$</span><span class="fu">depositar</span>(<span class="dv">10</span>)</span>
<span id="cb41-66"><a href="r6.html#cb41-66" tabindex="-1"></a>Fab</span>
<span id="cb41-67"><a href="r6.html#cb41-67" tabindex="-1"></a><span class="do">## Cuenta: </span></span>
<span id="cb41-68"><a href="r6.html#cb41-68" tabindex="-1"></a><span class="do">##   Saldo: 60</span></span>
<span id="cb41-69"><a href="r6.html#cb41-69" tabindex="-1"></a></span>
<span id="cb41-70"><a href="r6.html#cb41-70" tabindex="-1"></a>Fab2<span class="ot">&lt;-</span>SubCuentaBanco1<span class="sc">$</span><span class="fu">new</span>(<span class="dv">100</span>)</span>
<span id="cb41-71"><a href="r6.html#cb41-71" tabindex="-1"></a>Fab2</span>
<span id="cb41-72"><a href="r6.html#cb41-72" tabindex="-1"></a><span class="do">## Cuenta: </span></span>
<span id="cb41-73"><a href="r6.html#cb41-73" tabindex="-1"></a><span class="do">##   Saldo: 100</span></span>
<span id="cb41-74"><a href="r6.html#cb41-74" tabindex="-1"></a></span>
<span id="cb41-75"><a href="r6.html#cb41-75" tabindex="-1"></a>Fab2<span class="sc">$</span><span class="fu">retirar</span>(<span class="dv">150</span>)</span>
<span id="cb41-76"><a href="r6.html#cb41-76" tabindex="-1"></a><span class="do">## Error in Fab2$retirar(150): Existe sobregiro</span></span>
<span id="cb41-77"><a href="r6.html#cb41-77" tabindex="-1"></a>Fab2</span>
<span id="cb41-78"><a href="r6.html#cb41-78" tabindex="-1"></a><span class="do">## Cuenta: </span></span>
<span id="cb41-79"><a href="r6.html#cb41-79" tabindex="-1"></a><span class="do">##   Saldo: 100</span></span>
<span id="cb41-80"><a href="r6.html#cb41-80" tabindex="-1"></a></span>
<span id="cb41-81"><a href="r6.html#cb41-81" tabindex="-1"></a>Fab3 <span class="ot">&lt;-</span> SubCuentaBanco2<span class="sc">$</span><span class="fu">new</span>(<span class="dv">100</span>)</span>
<span id="cb41-82"><a href="r6.html#cb41-82" tabindex="-1"></a>Fab3</span>
<span id="cb41-83"><a href="r6.html#cb41-83" tabindex="-1"></a><span class="do">## Cuenta: </span></span>
<span id="cb41-84"><a href="r6.html#cb41-84" tabindex="-1"></a><span class="do">##   Saldo: 100</span></span>
<span id="cb41-85"><a href="r6.html#cb41-85" tabindex="-1"></a></span>
<span id="cb41-86"><a href="r6.html#cb41-86" tabindex="-1"></a>Fab3<span class="sc">$</span><span class="fu">retirar</span>(<span class="dv">150</span>)</span>
<span id="cb41-87"><a href="r6.html#cb41-87" tabindex="-1"></a>Fab3</span>
<span id="cb41-88"><a href="r6.html#cb41-88" tabindex="-1"></a><span class="do">## Cuenta: </span></span>
<span id="cb41-89"><a href="r6.html#cb41-89" tabindex="-1"></a><span class="do">##   Saldo: -51</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Create an R6 class that represents a shuffled deck of cards. You should be able to draw cards from the deck with <code>$draw(n)</code>, and return all cards to the deck and reshuffle with <code>$reshuffle()</code>. Use the following code to make a vector of cards.</li>
</ol>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="r6.html#cb42-1" tabindex="-1"></a><span class="fu">library</span>(R6)</span>
<span id="cb42-2"><a href="r6.html#cb42-2" tabindex="-1"></a>cartas <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&#39;cartas&#39;</span>,</span>
<span id="cb42-3"><a href="r6.html#cb42-3" tabindex="-1"></a>  <span class="at">private =</span> <span class="fu">list</span>(</span>
<span id="cb42-4"><a href="r6.html#cb42-4" tabindex="-1"></a>    <span class="at">suit =</span> <span class="fu">c</span>(<span class="st">&quot;♠&quot;</span>, <span class="st">&quot;♥&quot;</span>, <span class="st">&quot;♦&quot;</span>, <span class="st">&quot;♣&quot;</span>),</span>
<span id="cb42-5"><a href="r6.html#cb42-5" tabindex="-1"></a>    <span class="at">val =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>), <span class="st">&quot;J&quot;</span>, <span class="st">&quot;Q&quot;</span>, <span class="st">&quot;K&quot;</span>)</span>
<span id="cb42-6"><a href="r6.html#cb42-6" tabindex="-1"></a>  ),                </span>
<span id="cb42-7"><a href="r6.html#cb42-7" tabindex="-1"></a>  <span class="at">public =</span> <span class="fu">list</span>(</span>
<span id="cb42-8"><a href="r6.html#cb42-8" tabindex="-1"></a>    <span class="at">cards =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>), <span class="st">&quot;J&quot;</span>, <span class="st">&quot;Q&quot;</span>, <span class="st">&quot;K&quot;</span>), <span class="dv">4</span>),</span>
<span id="cb42-9"><a href="r6.html#cb42-9" tabindex="-1"></a>                     <span class="fu">c</span>(<span class="st">&quot;♠&quot;</span>, <span class="st">&quot;♥&quot;</span>, <span class="st">&quot;♦&quot;</span>, <span class="st">&quot;♣&quot;</span>))),</span>
<span id="cb42-10"><a href="r6.html#cb42-10" tabindex="-1"></a>    <span class="at">drawn =</span> <span class="cf">function</span>(n){</span>
<span id="cb42-11"><a href="r6.html#cb42-11" tabindex="-1"></a>      self<span class="sc">$</span>cards <span class="ot">&lt;-</span> self<span class="sc">$</span>cards[<span class="sc">-</span>n]</span>
<span id="cb42-12"><a href="r6.html#cb42-12" tabindex="-1"></a>      <span class="fu">invisible</span>(self)</span>
<span id="cb42-13"><a href="r6.html#cb42-13" tabindex="-1"></a>    },</span>
<span id="cb42-14"><a href="r6.html#cb42-14" tabindex="-1"></a>    <span class="at">reshuffle=</span><span class="cf">function</span>(){</span>
<span id="cb42-15"><a href="r6.html#cb42-15" tabindex="-1"></a>      copy <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="fu">rep</span>(private<span class="sc">$</span>val, <span class="dv">4</span>), private<span class="sc">$</span>suit)</span>
<span id="cb42-16"><a href="r6.html#cb42-16" tabindex="-1"></a>      x<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">52</span>)</span>
<span id="cb42-17"><a href="r6.html#cb42-17" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">52</span>) {</span>
<span id="cb42-18"><a href="r6.html#cb42-18" tabindex="-1"></a>        self<span class="sc">$</span>cards[i]<span class="ot">&lt;-</span>copy[x[i]]</span>
<span id="cb42-19"><a href="r6.html#cb42-19" tabindex="-1"></a>      }</span>
<span id="cb42-20"><a href="r6.html#cb42-20" tabindex="-1"></a>      <span class="fu">invisible</span>(self)</span>
<span id="cb42-21"><a href="r6.html#cb42-21" tabindex="-1"></a>    }</span>
<span id="cb42-22"><a href="r6.html#cb42-22" tabindex="-1"></a>  ),</span>
<span id="cb42-23"><a href="r6.html#cb42-23" tabindex="-1"></a>  <span class="at">active=</span><span class="fu">list</span>(</span>
<span id="cb42-24"><a href="r6.html#cb42-24" tabindex="-1"></a>    <span class="at">.cartas=</span><span class="cf">function</span>(value){</span>
<span id="cb42-25"><a href="r6.html#cb42-25" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">missing</span>(value)){</span>
<span id="cb42-26"><a href="r6.html#cb42-26" tabindex="-1"></a>        self<span class="sc">$</span>cards</span>
<span id="cb42-27"><a href="r6.html#cb42-27" tabindex="-1"></a>      }</span>
<span id="cb42-28"><a href="r6.html#cb42-28" tabindex="-1"></a>      <span class="cf">else</span>{<span class="fu">stop</span>(<span class="st">&quot;`Cartas` solo se puede leer NO modificar&quot;</span>, </span>
<span id="cb42-29"><a href="r6.html#cb42-29" tabindex="-1"></a>                <span class="at">call. =</span> <span class="cn">FALSE</span>)}</span>
<span id="cb42-30"><a href="r6.html#cb42-30" tabindex="-1"></a>    }</span>
<span id="cb42-31"><a href="r6.html#cb42-31" tabindex="-1"></a>  )</span>
<span id="cb42-32"><a href="r6.html#cb42-32" tabindex="-1"></a>)</span>
<span id="cb42-33"><a href="r6.html#cb42-33" tabindex="-1"></a></span>
<span id="cb42-34"><a href="r6.html#cb42-34" tabindex="-1"></a>mazo<span class="ot">&lt;-</span>cartas<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb42-35"><a href="r6.html#cb42-35" tabindex="-1"></a>mazo<span class="sc">$</span>.cartas</span>
<span id="cb42-36"><a href="r6.html#cb42-36" tabindex="-1"></a><span class="do">##  [1] &quot;A♠&quot;  &quot;2♥&quot;  &quot;3♦&quot;  &quot;4♣&quot;  &quot;5♠&quot;  &quot;6♥&quot;  &quot;7♦&quot;  &quot;8♣&quot;  &quot;9♠&quot;  &quot;10♥&quot; &quot;J♦&quot;  &quot;Q♣&quot; </span></span>
<span id="cb42-37"><a href="r6.html#cb42-37" tabindex="-1"></a><span class="do">## [13] &quot;K♠&quot;  &quot;A♥&quot;  &quot;2♦&quot;  &quot;3♣&quot;  &quot;4♠&quot;  &quot;5♥&quot;  &quot;6♦&quot;  &quot;7♣&quot;  &quot;8♠&quot;  &quot;9♥&quot;  &quot;10♦&quot; &quot;J♣&quot; </span></span>
<span id="cb42-38"><a href="r6.html#cb42-38" tabindex="-1"></a><span class="do">## [25] &quot;Q♠&quot;  &quot;K♥&quot;  &quot;A♦&quot;  &quot;2♣&quot;  &quot;3♠&quot;  &quot;4♥&quot;  &quot;5♦&quot;  &quot;6♣&quot;  &quot;7♠&quot;  &quot;8♥&quot;  &quot;9♦&quot;  &quot;10♣&quot;</span></span>
<span id="cb42-39"><a href="r6.html#cb42-39" tabindex="-1"></a><span class="do">## [37] &quot;J♠&quot;  &quot;Q♥&quot;  &quot;K♦&quot;  &quot;A♣&quot;  &quot;2♠&quot;  &quot;3♥&quot;  &quot;4♦&quot;  &quot;5♣&quot;  &quot;6♠&quot;  &quot;7♥&quot;  &quot;8♦&quot;  &quot;9♣&quot; </span></span>
<span id="cb42-40"><a href="r6.html#cb42-40" tabindex="-1"></a><span class="do">## [49] &quot;10♠&quot; &quot;J♥&quot;  &quot;Q♦&quot;  &quot;K♣&quot;</span></span>
<span id="cb42-41"><a href="r6.html#cb42-41" tabindex="-1"></a>mazo<span class="sc">$</span><span class="fu">drawn</span>(<span class="dv">1</span>)</span>
<span id="cb42-42"><a href="r6.html#cb42-42" tabindex="-1"></a>mazo<span class="sc">$</span>.cartas</span>
<span id="cb42-43"><a href="r6.html#cb42-43" tabindex="-1"></a><span class="do">##  [1] &quot;2♥&quot;  &quot;3♦&quot;  &quot;4♣&quot;  &quot;5♠&quot;  &quot;6♥&quot;  &quot;7♦&quot;  &quot;8♣&quot;  &quot;9♠&quot;  &quot;10♥&quot; &quot;J♦&quot;  &quot;Q♣&quot;  &quot;K♠&quot; </span></span>
<span id="cb42-44"><a href="r6.html#cb42-44" tabindex="-1"></a><span class="do">## [13] &quot;A♥&quot;  &quot;2♦&quot;  &quot;3♣&quot;  &quot;4♠&quot;  &quot;5♥&quot;  &quot;6♦&quot;  &quot;7♣&quot;  &quot;8♠&quot;  &quot;9♥&quot;  &quot;10♦&quot; &quot;J♣&quot;  &quot;Q♠&quot; </span></span>
<span id="cb42-45"><a href="r6.html#cb42-45" tabindex="-1"></a><span class="do">## [25] &quot;K♥&quot;  &quot;A♦&quot;  &quot;2♣&quot;  &quot;3♠&quot;  &quot;4♥&quot;  &quot;5♦&quot;  &quot;6♣&quot;  &quot;7♠&quot;  &quot;8♥&quot;  &quot;9♦&quot;  &quot;10♣&quot; &quot;J♠&quot; </span></span>
<span id="cb42-46"><a href="r6.html#cb42-46" tabindex="-1"></a><span class="do">## [37] &quot;Q♥&quot;  &quot;K♦&quot;  &quot;A♣&quot;  &quot;2♠&quot;  &quot;3♥&quot;  &quot;4♦&quot;  &quot;5♣&quot;  &quot;6♠&quot;  &quot;7♥&quot;  &quot;8♦&quot;  &quot;9♣&quot;  &quot;10♠&quot;</span></span>
<span id="cb42-47"><a href="r6.html#cb42-47" tabindex="-1"></a><span class="do">## [49] &quot;J♥&quot;  &quot;Q♦&quot;  &quot;K♣&quot;</span></span>
<span id="cb42-48"><a href="r6.html#cb42-48" tabindex="-1"></a>mazo<span class="sc">$</span><span class="fu">reshuffle</span>()</span>
<span id="cb42-49"><a href="r6.html#cb42-49" tabindex="-1"></a>mazo<span class="sc">$</span>.cartas</span>
<span id="cb42-50"><a href="r6.html#cb42-50" tabindex="-1"></a><span class="do">##  [1] &quot;9♣&quot;  &quot;K♠&quot;  &quot;J♥&quot;  &quot;5♣&quot;  &quot;A♦&quot;  &quot;3♦&quot;  &quot;10♠&quot; &quot;9♠&quot;  &quot;10♣&quot; &quot;8♣&quot;  &quot;4♥&quot;  &quot;Q♦&quot; </span></span>
<span id="cb42-51"><a href="r6.html#cb42-51" tabindex="-1"></a><span class="do">## [13] &quot;A♠&quot;  &quot;4♣&quot;  &quot;Q♥&quot;  &quot;J♣&quot;  &quot;6♥&quot;  &quot;7♠&quot;  &quot;Q♣&quot;  &quot;6♠&quot;  &quot;2♠&quot;  &quot;3♣&quot;  &quot;4♠&quot;  &quot;J♠&quot; </span></span>
<span id="cb42-52"><a href="r6.html#cb42-52" tabindex="-1"></a><span class="do">## [25] &quot;5♠&quot;  &quot;J♦&quot;  &quot;9♥&quot;  &quot;8♥&quot;  &quot;8♦&quot;  &quot;5♦&quot;  &quot;4♦&quot;  &quot;A♥&quot;  &quot;7♣&quot;  &quot;Q♠&quot;  &quot;2♣&quot;  &quot;2♥&quot; </span></span>
<span id="cb42-53"><a href="r6.html#cb42-53" tabindex="-1"></a><span class="do">## [37] &quot;9♦&quot;  &quot;3♠&quot;  &quot;10♥&quot; &quot;6♣&quot;  &quot;7♦&quot;  &quot;K♦&quot;  &quot;10♦&quot; &quot;A♣&quot;  &quot;6♦&quot;  &quot;2♦&quot;  &quot;K♣&quot;  &quot;8♠&quot; </span></span>
<span id="cb42-54"><a href="r6.html#cb42-54" tabindex="-1"></a><span class="do">## [49] &quot;3♥&quot;  &quot;7♥&quot;  &quot;5♥&quot;  &quot;K♥&quot;</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Create an R6 class that allows you to get and set the current time zone. You can access the current time zone with <code>Sys.timezone()</code> and set it with <code>Sys.setenv(TZ = "newtimezone")</code>. When setting the time zone, make sure the new time zone is in the list provided by <code>OlsonNames()</code>.</li>
</ol>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="r6.html#cb43-1" tabindex="-1"></a>ZonaHoraria <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&#39;ZonaHoraria&#39;</span>,</span>
<span id="cb43-2"><a href="r6.html#cb43-2" tabindex="-1"></a>  <span class="at">public =</span> <span class="fu">list</span>(</span>
<span id="cb43-3"><a href="r6.html#cb43-3" tabindex="-1"></a>    <span class="at">zona =</span> <span class="fu">Sys.timezone</span>(),</span>
<span id="cb43-4"><a href="r6.html#cb43-4" tabindex="-1"></a>  <span class="at">cambiar_zona=</span><span class="cf">function</span>(name){</span>
<span id="cb43-5"><a href="r6.html#cb43-5" tabindex="-1"></a>    <span class="fu">stopifnot</span>(<span class="st">&quot;No existe esa zona horaria&quot;</span> <span class="ot">=</span> name <span class="sc">%in%</span> <span class="fu">OlsonNames</span>()) </span>
<span id="cb43-6"><a href="r6.html#cb43-6" tabindex="-1"></a>    self<span class="sc">$</span>zona<span class="ot">=</span><span class="fu">Sys.setenv</span>(<span class="at">TZ =</span> name)</span>
<span id="cb43-7"><a href="r6.html#cb43-7" tabindex="-1"></a>  })</span>
<span id="cb43-8"><a href="r6.html#cb43-8" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="r6.html#cb44-1" tabindex="-1"></a>zona <span class="ot">&lt;-</span> ZonaHoraria<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb44-2"><a href="r6.html#cb44-2" tabindex="-1"></a>zona<span class="sc">$</span><span class="fu">cambiar_zona</span>(<span class="st">&#39;America/Guayaquil&#39;</span>)</span>
<span id="cb44-3"><a href="r6.html#cb44-3" tabindex="-1"></a>zona</span>
<span id="cb44-4"><a href="r6.html#cb44-4" tabindex="-1"></a><span class="do">## &lt;ZonaHoraria&gt;</span></span>
<span id="cb44-5"><a href="r6.html#cb44-5" tabindex="-1"></a><span class="do">##   Public:</span></span>
<span id="cb44-6"><a href="r6.html#cb44-6" tabindex="-1"></a><span class="do">##     cambiar_zona: function (name) </span></span>
<span id="cb44-7"><a href="r6.html#cb44-7" tabindex="-1"></a><span class="do">##     clone: function (deep = FALSE) </span></span>
<span id="cb44-8"><a href="r6.html#cb44-8" tabindex="-1"></a><span class="do">##     zona: TRUE</span></span>
<span id="cb44-9"><a href="r6.html#cb44-9" tabindex="-1"></a><span class="fu">Sys.timezone</span>()</span>
<span id="cb44-10"><a href="r6.html#cb44-10" tabindex="-1"></a><span class="do">## [1] &quot;America/Guayaquil&quot;</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Create an R6 class that manages the current working directory. It should have <code>$get()</code> and <code>$set()</code> methods.</li>
</ol>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="r6.html#cb45-1" tabindex="-1"></a>Directorio <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&#39;Directorio&#39;</span>,</span>
<span id="cb45-2"><a href="r6.html#cb45-2" tabindex="-1"></a>  <span class="at">public =</span> <span class="fu">list</span>(</span>
<span id="cb45-3"><a href="r6.html#cb45-3" tabindex="-1"></a>    <span class="at">get=</span><span class="cf">function</span>(){</span>
<span id="cb45-4"><a href="r6.html#cb45-4" tabindex="-1"></a>      <span class="fu">getwd</span>()</span>
<span id="cb45-5"><a href="r6.html#cb45-5" tabindex="-1"></a>    },</span>
<span id="cb45-6"><a href="r6.html#cb45-6" tabindex="-1"></a>    <span class="at">set=</span><span class="cf">function</span>(path){</span>
<span id="cb45-7"><a href="r6.html#cb45-7" tabindex="-1"></a>      <span class="fu">setwd</span>(path)</span>
<span id="cb45-8"><a href="r6.html#cb45-8" tabindex="-1"></a>      <span class="fu">invisible</span>(self)</span>
<span id="cb45-9"><a href="r6.html#cb45-9" tabindex="-1"></a>    }</span>
<span id="cb45-10"><a href="r6.html#cb45-10" tabindex="-1"></a>  )</span>
<span id="cb45-11"><a href="r6.html#cb45-11" tabindex="-1"></a>)</span>
<span id="cb45-12"><a href="r6.html#cb45-12" tabindex="-1"></a>direct <span class="ot">&lt;-</span> Directorio<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb45-13"><a href="r6.html#cb45-13" tabindex="-1"></a>direct<span class="sc">$</span><span class="fu">get</span>()</span>
<span id="cb45-14"><a href="r6.html#cb45-14" tabindex="-1"></a><span class="do">## [1] &quot;D:/Files/Downloads/bookdown-demo-main/bookdown-demo-main&quot;</span></span>
<span id="cb45-15"><a href="r6.html#cb45-15" tabindex="-1"></a>direct<span class="sc">$</span><span class="fu">set</span>(<span class="st">&quot;C:/Users/Dell/OneDrive - Escuela Politécnica Nacional/Pasantías UDC&quot;</span>)</span>
<span id="cb45-16"><a href="r6.html#cb45-16" tabindex="-1"></a><span class="do">## Error in setwd(path): no es posible cambiar el directorio de trabajo</span></span>
<span id="cb45-17"><a href="r6.html#cb45-17" tabindex="-1"></a>direct<span class="sc">$</span><span class="fu">get</span>()</span>
<span id="cb45-18"><a href="r6.html#cb45-18" tabindex="-1"></a><span class="do">## [1] &quot;D:/Files/Downloads/bookdown-demo-main/bookdown-demo-main&quot;</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Create a class with a write-only <code>$password</code> field. It should have <code>$check_password(password)</code> method that returns <code>TRUE</code> or <code>FALSE</code>, but there should be no way to view the complete password.</li>
</ol>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="r6.html#cb46-1" tabindex="-1"></a><span class="co"># install.packages(&quot;R6&quot;)</span></span>
<span id="cb46-2"><a href="r6.html#cb46-2" tabindex="-1"></a><span class="fu">library</span>(R6)</span>
<span id="cb46-3"><a href="r6.html#cb46-3" tabindex="-1"></a></span>
<span id="cb46-4"><a href="r6.html#cb46-4" tabindex="-1"></a></span>
<span id="cb46-5"><a href="r6.html#cb46-5" tabindex="-1"></a>Bank_writeonly <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;Bank_writeonly&quot;</span>, </span>
<span id="cb46-6"><a href="r6.html#cb46-6" tabindex="-1"></a>      <span class="at">private =</span> <span class="fu">list</span>(</span>
<span id="cb46-7"><a href="r6.html#cb46-7" tabindex="-1"></a>            <span class="at">user =</span> <span class="cn">NULL</span>,</span>
<span id="cb46-8"><a href="r6.html#cb46-8" tabindex="-1"></a>            <span class="at">password =</span> <span class="cn">NULL</span></span>
<span id="cb46-9"><a href="r6.html#cb46-9" tabindex="-1"></a>      ),</span>
<span id="cb46-10"><a href="r6.html#cb46-10" tabindex="-1"></a>      <span class="at">active =</span> <span class="fu">list</span>(</span>
<span id="cb46-11"><a href="r6.html#cb46-11" tabindex="-1"></a>        <span class="at">.password =</span> <span class="cf">function</span>(x){</span>
<span id="cb46-12"><a href="r6.html#cb46-12" tabindex="-1"></a>          <span class="cf">if</span>(<span class="fu">missing</span>(x)){</span>
<span id="cb46-13"><a href="r6.html#cb46-13" tabindex="-1"></a>            <span class="fu">stop</span>(<span class="st">&quot;`$.password` solo permite cambiar tu contraseña, NO verla&quot;</span>,</span>
<span id="cb46-14"><a href="r6.html#cb46-14" tabindex="-1"></a>                 <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb46-15"><a href="r6.html#cb46-15" tabindex="-1"></a>          } <span class="cf">else</span>{</span>
<span id="cb46-16"><a href="r6.html#cb46-16" tabindex="-1"></a>            private<span class="sc">$</span>password <span class="ot">&lt;-</span> x</span>
<span id="cb46-17"><a href="r6.html#cb46-17" tabindex="-1"></a>            <span class="fu">cat</span>(<span class="st">&quot;Contraseña cambiada con éxito&quot;</span>)</span>
<span id="cb46-18"><a href="r6.html#cb46-18" tabindex="-1"></a>          }</span>
<span id="cb46-19"><a href="r6.html#cb46-19" tabindex="-1"></a>        }</span>
<span id="cb46-20"><a href="r6.html#cb46-20" tabindex="-1"></a>      ),</span>
<span id="cb46-21"><a href="r6.html#cb46-21" tabindex="-1"></a>      <span class="at">public =</span> <span class="fu">list</span>(</span>
<span id="cb46-22"><a href="r6.html#cb46-22" tabindex="-1"></a>            <span class="at">initialize =</span> <span class="cf">function</span>(.user, .password){</span>
<span id="cb46-23"><a href="r6.html#cb46-23" tabindex="-1"></a>              private<span class="sc">$</span>password <span class="ot">&lt;-</span> .password</span>
<span id="cb46-24"><a href="r6.html#cb46-24" tabindex="-1"></a>              private<span class="sc">$</span>user <span class="ot">&lt;-</span> .user</span>
<span id="cb46-25"><a href="r6.html#cb46-25" tabindex="-1"></a>              },</span>
<span id="cb46-26"><a href="r6.html#cb46-26" tabindex="-1"></a>            <span class="at">check_password =</span> <span class="cf">function</span>(p){</span>
<span id="cb46-27"><a href="r6.html#cb46-27" tabindex="-1"></a>              <span class="cf">if</span>(private<span class="sc">$</span>password <span class="sc">==</span> p){ </span>
<span id="cb46-28"><a href="r6.html#cb46-28" tabindex="-1"></a>                <span class="fu">cat</span>(<span class="st">&quot;Tu contraseña SI coincide con la ingresada&quot;</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)}</span>
<span id="cb46-29"><a href="r6.html#cb46-29" tabindex="-1"></a>              <span class="cf">else</span>{</span>
<span id="cb46-30"><a href="r6.html#cb46-30" tabindex="-1"></a>                <span class="fu">stop</span>(<span class="st">&quot;Tu contraseña NO coincide con la ingresada&quot;</span>)}</span>
<span id="cb46-31"><a href="r6.html#cb46-31" tabindex="-1"></a>              },</span>
<span id="cb46-32"><a href="r6.html#cb46-32" tabindex="-1"></a>            <span class="at">print =</span> <span class="cf">function</span>(...){</span>
<span id="cb46-33"><a href="r6.html#cb46-33" tabindex="-1"></a>              <span class="fu">cat</span>(<span class="st">&quot;Bienvenido al Banco </span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb46-34"><a href="r6.html#cb46-34" tabindex="-1"></a>              <span class="fu">cat</span>(<span class="st">&quot;Tu cuenta se ha creado con el nombre de usuario:&quot;</span>, private<span class="sc">$</span>user)</span>
<span id="cb46-35"><a href="r6.html#cb46-35" tabindex="-1"></a>            }</span>
<span id="cb46-36"><a href="r6.html#cb46-36" tabindex="-1"></a>      )</span>
<span id="cb46-37"><a href="r6.html#cb46-37" tabindex="-1"></a>      </span>
<span id="cb46-38"><a href="r6.html#cb46-38" tabindex="-1"></a>)</span>
<span id="cb46-39"><a href="r6.html#cb46-39" tabindex="-1"></a></span>
<span id="cb46-40"><a href="r6.html#cb46-40" tabindex="-1"></a><span class="co"># Prueba</span></span>
<span id="cb46-41"><a href="r6.html#cb46-41" tabindex="-1"></a></span>
<span id="cb46-42"><a href="r6.html#cb46-42" tabindex="-1"></a>Cuenta_Andrea <span class="ot">&lt;-</span> Bank_writeonly<span class="sc">$</span><span class="fu">new</span>(<span class="st">&quot;AndreaBC&quot;</span>, <span class="st">&quot;prueba123&quot;</span>)</span>
<span id="cb46-43"><a href="r6.html#cb46-43" tabindex="-1"></a><span class="co"># Print</span></span>
<span id="cb46-44"><a href="r6.html#cb46-44" tabindex="-1"></a>Cuenta_Andrea</span>
<span id="cb46-45"><a href="r6.html#cb46-45" tabindex="-1"></a><span class="do">## Bienvenido al Banco </span></span>
<span id="cb46-46"><a href="r6.html#cb46-46" tabindex="-1"></a><span class="do">## Tu cuenta se ha creado con el nombre de usuario: AndreaBC</span></span>
<span id="cb46-47"><a href="r6.html#cb46-47" tabindex="-1"></a><span class="co"># Funcion Check_password</span></span>
<span id="cb46-48"><a href="r6.html#cb46-48" tabindex="-1"></a>Cuenta_Andrea<span class="sc">$</span><span class="fu">check_password</span>(<span class="st">&quot;Nomeacuerdomicontraseña&quot;</span>)</span>
<span id="cb46-49"><a href="r6.html#cb46-49" tabindex="-1"></a><span class="do">## Error in Cuenta_Andrea$check_password(&quot;Nomeacuerdomicontraseña&quot;): Tu contraseña NO coincide con la ingresada</span></span>
<span id="cb46-50"><a href="r6.html#cb46-50" tabindex="-1"></a>Cuenta_Andrea<span class="sc">$</span><span class="fu">check_password</span>(<span class="st">&quot;prueba123&quot;</span>)</span>
<span id="cb46-51"><a href="r6.html#cb46-51" tabindex="-1"></a><span class="do">## Tu contraseña SI coincide con la ingresada FALSE</span></span>
<span id="cb46-52"><a href="r6.html#cb46-52" tabindex="-1"></a><span class="co"># .password</span></span>
<span id="cb46-53"><a href="r6.html#cb46-53" tabindex="-1"></a>Cuenta_Andrea<span class="sc">$</span>.password</span>
<span id="cb46-54"><a href="r6.html#cb46-54" tabindex="-1"></a><span class="do">## Error: `$.password` solo permite cambiar tu contraseña, NO verla</span></span>
<span id="cb46-55"><a href="r6.html#cb46-55" tabindex="-1"></a>Cuenta_Andrea<span class="sc">$</span>.password <span class="ot">&lt;-</span> <span class="st">&quot;NuevaContraseña&quot;</span></span>
<span id="cb46-56"><a href="r6.html#cb46-56" tabindex="-1"></a><span class="do">## Contraseña cambiada con éxito</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Extend the Rando class with another active binding that allows you to access the previous random <code>value.</code> Ensure that active binding is the only way to access the value.</li>
</ol>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="r6.html#cb47-1" tabindex="-1"></a>Rando <span class="ot">&lt;-</span> R6<span class="sc">::</span><span class="fu">R6Class</span>(<span class="st">&quot;Rando&quot;</span>, </span>
<span id="cb47-2"><a href="r6.html#cb47-2" tabindex="-1"></a>    <span class="at">private =</span> <span class="fu">list</span>(<span class="at">prev =</span> <span class="cn">NULL</span>),</span>
<span id="cb47-3"><a href="r6.html#cb47-3" tabindex="-1"></a>    <span class="at">active =</span> <span class="fu">list</span>(</span>
<span id="cb47-4"><a href="r6.html#cb47-4" tabindex="-1"></a>      <span class="at">random =</span> <span class="cf">function</span>(value) {</span>
<span id="cb47-5"><a href="r6.html#cb47-5" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">missing</span>(value)) {</span>
<span id="cb47-6"><a href="r6.html#cb47-6" tabindex="-1"></a>          private<span class="sc">$</span>prev <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb47-7"><a href="r6.html#cb47-7" tabindex="-1"></a>          private<span class="sc">$</span>prev</span>
<span id="cb47-8"><a href="r6.html#cb47-8" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb47-9"><a href="r6.html#cb47-9" tabindex="-1"></a>          <span class="fu">stop</span>(<span class="st">&quot;Can&#39;t set `$random`&quot;</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-10"><a href="r6.html#cb47-10" tabindex="-1"></a>        }</span>
<span id="cb47-11"><a href="r6.html#cb47-11" tabindex="-1"></a>      },</span>
<span id="cb47-12"><a href="r6.html#cb47-12" tabindex="-1"></a>      <span class="at">previous =</span> <span class="cf">function</span>(value) {</span>
<span id="cb47-13"><a href="r6.html#cb47-13" tabindex="-1"></a>        <span class="cf">if</span> (<span class="fu">missing</span>(value)) {</span>
<span id="cb47-14"><a href="r6.html#cb47-14" tabindex="-1"></a>          private<span class="sc">$</span>prev</span>
<span id="cb47-15"><a href="r6.html#cb47-15" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb47-16"><a href="r6.html#cb47-16" tabindex="-1"></a>          <span class="fu">stop</span>(<span class="st">&quot;Can&#39;t set `$random`&quot;</span>, <span class="at">call. =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-17"><a href="r6.html#cb47-17" tabindex="-1"></a>        }</span>
<span id="cb47-18"><a href="r6.html#cb47-18" tabindex="-1"></a>      }</span>
<span id="cb47-19"><a href="r6.html#cb47-19" tabindex="-1"></a>    )</span>
<span id="cb47-20"><a href="r6.html#cb47-20" tabindex="-1"></a>)</span>
<span id="cb47-21"><a href="r6.html#cb47-21" tabindex="-1"></a>x <span class="ot">&lt;-</span> Rando<span class="sc">$</span><span class="fu">new</span>()</span>
<span id="cb47-22"><a href="r6.html#cb47-22" tabindex="-1"></a>x<span class="sc">$</span>random</span>
<span id="cb47-23"><a href="r6.html#cb47-23" tabindex="-1"></a><span class="do">## [1] 0.371512</span></span>
<span id="cb47-24"><a href="r6.html#cb47-24" tabindex="-1"></a>x<span class="sc">$</span>random</span>
<span id="cb47-25"><a href="r6.html#cb47-25" tabindex="-1"></a><span class="do">## [1] 0.4284287</span></span>
<span id="cb47-26"><a href="r6.html#cb47-26" tabindex="-1"></a>x<span class="sc">$</span>previous</span>
<span id="cb47-27"><a href="r6.html#cb47-27" tabindex="-1"></a><span class="do">## [1] 0.4284287</span></span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="poo-programación-orientada-a-objetos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tidyquant.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-POO_R6.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
