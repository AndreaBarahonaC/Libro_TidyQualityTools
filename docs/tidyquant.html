<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 4 TidyQuant | Integración del Paquete QualityTools con Tidyverse</title>
<meta name="author" content="Miguel Flores">
<meta name="author" content="Andrea Barahona">
<meta name="author" content="Fabián Encarnación">
<meta name="author" content="Dario Quishpe">
<meta name="generator" content="bookdown 0.38 with bs4_book()">
<meta property="og:title" content="Capítulo 4 TidyQuant | Integración del Paquete QualityTools con Tidyverse">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 4 TidyQuant | Integración del Paquete QualityTools con Tidyverse">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<meta name="description" content=".scroll-100 {  max-height: 100px;  overflow-y: auto;  background-color: inherit; } Existe una amplia gama de funciones de análisis cuantitativo útiles que funcionan con objetos de series...">
<meta property="og:description" content=".scroll-100 {  max-height: 100px;  overflow-y: auto;  background-color: inherit; } Existe una amplia gama de funciones de análisis cuantitativo útiles que funcionan con objetos de series...">
<meta name="twitter:description" content=".scroll-100 {  max-height: 100px;  overflow-y: auto;  background-color: inherit; } Existe una amplia gama de funciones de análisis cuantitativo útiles que funcionan con objetos de series...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Integración del Paquete QualityTools con Tidyverse</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preámbulo</a></li>
<li><a class="" href="poo-programaci%C3%B3n-orientada-a-objetos.html"><span class="header-section-number">2</span> (POO) Programación Orientada a Objetos</a></li>
<li><a class="" href="r6.html"><span class="header-section-number">3</span> R6</a></li>
<li><a class="active" href="tidyquant.html"><span class="header-section-number">4</span> TidyQuant</a></li>
<li><a class="" href="qualitytools.html"><span class="header-section-number">5</span> QualityTools</a></li>
<li><a class="" href="referencias.html">Referencias</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="tidyquant" class="section level1" number="4">
<h1>
<span class="header-section-number">Capítulo 4</span> TidyQuant<a class="anchor" aria-label="anchor" href="#tidyquant"><i class="fas fa-link"></i></a>
</h1>
<style type="text/css">
.scroll-100 {
  max-height: 100px;
  overflow-y: auto;
  background-color: inherit;
}
</style>
<p>Existe una amplia gama de funciones de análisis cuantitativo útiles que funcionan con objetos de series temporales. El problema es que muchas de estas maravillosas funciones no funcionan con tipos de datos <code>data.frame</code>, ni con el flujo de trabajo de <code>tidyverse</code>.</p>
<p>Por ello el paquete <strong>Tidyquant</strong> integra las funciones más útiles de los paquetes: <code>xts</code>, <code>zoo</code>, <code>quantmod</code>, <code>TTR</code> y `<code>PerformanceAnalytics</code>, por ello, este texto se centra en demostrar como se integran las funciones más importantes con los paquetes financieros cuantitativos.siguientes:</p>
<ul>
<li><p>Transmutar <code><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute()</a></code>: Esta funcion devuelve un nuevo ‘tidy data frame’, que normalmente tiene una periodicidad diferente a la de la entrada.</p></li>
<li><p>Mutate <code><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_mutate()</a></code>: Esta funcion agrega columanas al tidy data frame.</p></li>
</ul>
<p>Para ello, lo primero que haremos será cargar los paquetes correspondientes:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cargar tidyquant, lubridate, xts, quantmod, TTR </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/business-science/tidyquant">tidyquant</a></span><span class="op">)</span></span></code></pre></div>
<div id="compatibilidad-de-funciones" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Compatibilidad de funciones<a class="anchor" aria-label="anchor" href="#compatibilidad-de-funciones"><i class="fas fa-link"></i></a>
</h2>
<p><code><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute_fun_options()</a></code> Devuelve una lista de <strong>funciones de mutación compatibles</strong> con cada paquete, para ello haremos una breve discusión de las opciones respecto a cada paquete.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute_fun_options</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre class="scroll-100"><code>## List of 5
##  $ zoo                 : chr [1:14] "rollapply" "rollapplyr" "rollmax" "rollmax.default" ...
##  $ xts                 : chr [1:27] "apply.daily" "apply.monthly" "apply.quarterly" "apply.weekly" ...
##  $ quantmod            : chr [1:25] "allReturns" "annualReturn" "ClCl" "dailyReturn" ...
##  $ TTR                 : chr [1:64] "adjRatios" "ADX" "ALMA" "aroon" ...
##  $ PerformanceAnalytics: chr [1:7] "Return.annualized" "Return.annualized.excess" "Return.clean" "Return.cumulative" ...</code></pre>
<p>Para ello, accederemos a las funciones de los respectivos paquetes que tienen compatibilidad para trabarse con <code>tq_transmute</code> y <code>tq_mutate</code> a partir del comando “$”.</p>
<div id="funcionalidad-zoo" class="section level3" number="4.1.1">
<h3>
<span class="header-section-number">4.1.1</span> Funcionalidad zoo<a class="anchor" aria-label="anchor" href="#funcionalidad-zoo"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute_fun_options</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">zoo</span></span></code></pre></div>
<pre class="scroll-100"><code>##  [1] "rollapply"          "rollapplyr"         "rollmax"           
##  [4] "rollmax.default"    "rollmaxr"           "rollmean"          
##  [7] "rollmean.default"   "rollmeanr"          "rollmedian"        
## [10] "rollmedian.default" "rollmedianr"        "rollsum"           
## [13] "rollsum.default"    "rollsumr"</code></pre>
<p>Las funciones del paquete <code>zoo</code> que son compatibles se enumerar arriba. EN términos generales, estas son:</p>
<ul>
<li>
<p>Funciones <em>Roll Apply</em>:</p>
<ul>
<li>Una función genérica para aplicar una función a los márgenes móviles.</li>
<li>Forma: <code>rollapply(data, width, FUN, ..., by = 1, by.column = TRUE, fill = if (na.pad) NA, na.pad = FALSE, partial = FALSE, align = c("center", "left", "right"), coredata = TRUE)</code>
</li>
<li>Las opciones incluyen: <code>rollmax</code>, <code>rollmean</code>, <code>rollmedian</code>, <code>rollsum</code>, etc.</li>
</ul>
</li>
</ul>
</div>
<div id="funcionalidad-xts" class="section level3" number="4.1.2">
<h3>
<span class="header-section-number">4.1.2</span> Funcionalidad xts<a class="anchor" aria-label="anchor" href="#funcionalidad-xts"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute_fun_options</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">xts</span></span></code></pre></div>
<pre class="scroll-100"><code>##  [1] "apply.daily"     "apply.monthly"   "apply.quarterly" "apply.weekly"   
##  [5] "apply.yearly"    "diff.xts"        "lag.xts"         "period.apply"   
##  [9] "period.max"      "period.min"      "period.prod"     "period.sum"     
## [13] "periodicity"     "to.daily"        "to.hourly"       "to.minutes"     
## [17] "to.minutes10"    "to.minutes15"    "to.minutes3"     "to.minutes30"   
## [21] "to.minutes5"     "to.monthly"      "to.period"       "to.quarterly"   
## [25] "to.weekly"       "to.yearly"       "to_period"</code></pre>
<p>Las funciones del paquete <code>xts</code> que son compatibles están enumeradas arribas. en términos generales, son:</p>
<ul>
<li>Funciones <em>Period Apply</em>:
<ul>
<li>Aplicar una función a un segmento de tiempo, por ejemplo: <code>max</code>, <code>min</code>, <code>mean</code>, etc.</li>
<li>Forma: <code>apply.daily(x, FUN, ...)</code>.</li>
<li>Las opciones incluyen: <code>apply.daily</code>, <code>weekly</code>, <code>monthly</code>, <code>quarterly</code>, <code>yearly</code>.</li>
</ul>
</li>
<li>Funciones <em>To-Period Functions</em>:
<ul>
<li>Convierte una serie de tiempo en un serie de tiempo de menor periodicidad, por ejemplo, convierte periodicidad diaria en mensual.</li>
<li>Forma: <code>to.period(x, period = 'months', k = 1, indexAt, name = NULL, OHLC = TRUE, ...)</code>.</li>
<li>Las opciones incluyen: <code>to.minutes</code>, <code>hourly</code>, <code>daily</code>, <code>weekly</code>, <code>monthly</code>, <code>quarterly</code>, <code>yearly</code>.</li>
<li>Es importante aclarar que: la estructura de devolución es diferente para <code>to.period</code>, <code>to.monthly</code>, <code>to.weekly</code>, <code>to.quarterly</code>, etc. <code>to.period</code> retorna la fecha, mientras que <code>to.monthly</code> devuelve un caracter de tipo “MON YYYY”. Es recomendable trabajaer con <code>to.period</code>, si se desea trabar con series temporales a través de <code>lubridate</code>.</li>
</ul>
</li>
</ul>
</div>
<div id="funcionalidad-quantmod" class="section level3" number="4.1.3">
<h3>
<span class="header-section-number">4.1.3</span> Funcionalidad quantmod<a class="anchor" aria-label="anchor" href="#funcionalidad-quantmod"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute_fun_options</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">quantmod</span></span></code></pre></div>
<pre class="scroll-100"><code>##  [1] "allReturns"      "annualReturn"    "ClCl"            "dailyReturn"    
##  [5] "Delt"            "HiCl"            "Lag"             "LoCl"           
##  [9] "LoHi"            "monthlyReturn"   "Next"            "OpCl"           
## [13] "OpHi"            "OpLo"            "OpOp"            "periodReturn"   
## [17] "quarterlyReturn" "seriesAccel"     "seriesDecel"     "seriesDecr"     
## [21] "seriesHi"        "seriesIncr"      "seriesLo"        "weeklyReturn"   
## [25] "yearlyReturn"</code></pre>
<p>Las funciones del paquete <code>quantmod</code> que son compatibles se enumeran arriba. En terminos generales, son :</p>
<ul>
<li>Funciones de cambio porcentual (Delt) y retrasos:
<ul>
<li>Delt: <code>Delt(x1, x2 = NULL, k = 0, type = c("arithmetic", "log"))</code>
<ul>
<li>Variaciones de Delt: ClCl, HiCl, LoCl, LoHi, OpCl, OpHi, OpLo, OpOp</li>
<li>Forma: <code>OpCl(OHLC)</code>
</li>
</ul>
</li>
<li>Retrasos: <code>Lag(x, k = 1)</code> / Siguiente: <code>Next(x, k = 1)</code> (También puede usar <code>dplyr::lag and dplyr::lead</code>)</li>
</ul>
</li>
<li>Funciones de devolución del período:
<ul>
<li>Se obtienen los rendimientos aritméticos o logarítmicos para diversas periodicidades, qué incluyen diaria, semanal, mensual, trimestral y anual.</li>
<li>Forma: <code>periodReturn(x, period = 'monthly', subset = NULL, type = 'arithmetic', leading = TRUE, ...)</code>
</li>
</ul>
</li>
<li>Funciones de Series:
<ul>
<li>Devuelve valores que describen la serie, las opciones incluyen describir los aumentos o disminuciones, la aceleración o desaceleración y alto o bajo.</li>
<li>Formas: <code>seriesHi(x)</code>, <code>seriesIncr(x, thresh = 0, diff. = 1L)</code>, <code>seriesAccel(x)</code>.</li>
</ul>
</li>
</ul>
</div>
<div id="funcionalidad-ttr" class="section level3" number="4.1.4">
<h3>
<span class="header-section-number">4.1.4</span> Funcionalidad TTR<a class="anchor" aria-label="anchor" href="#funcionalidad-ttr"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute_fun_options</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">TTR</span></span></code></pre></div>
<pre class="scroll-100"><code>##  [1] "adjRatios"          "ADX"                "ALMA"              
##  [4] "aroon"              "ATR"                "BBands"            
##  [7] "CCI"                "chaikinAD"          "chaikinVolatility" 
## [10] "CLV"                "CMF"                "CMO"               
## [13] "CTI"                "DEMA"               "DonchianChannel"   
## [16] "DPO"                "DVI"                "EMA"               
## [19] "EMV"                "EVWMA"              "GMMA"              
## [22] "growth"             "HMA"                "keltnerChannels"   
## [25] "KST"                "lags"               "MACD"              
## [28] "MFI"                "momentum"           "OBV"               
## [31] "PBands"             "ROC"                "rollSFM"           
## [34] "RSI"                "runCor"             "runCov"            
## [37] "runMAD"             "runMax"             "runMean"           
## [40] "runMedian"          "runMin"             "runPercentRank"    
## [43] "runSD"              "runSum"             "runVar"            
## [46] "SAR"                "SMA"                "SMI"               
## [49] "SNR"                "stoch"              "TDI"               
## [52] "TRIX"               "ultimateOscillator" "VHF"               
## [55] "VMA"                "volatility"         "VWAP"              
## [58] "VWMA"               "wilderSum"          "williamsAD"        
## [61] "WMA"                "WPR"                "ZigZag"            
## [64] "ZLEMA"</code></pre>
<p>Aquí hay una breve descripción de las funciones más populares de <code>TTR</code>:</p>
<ul>
<li>Índice de movimiento direccional de Welles Wilder:
<ul>
<li><code>ADX(HLC, n = 14, maType, ...)</code></li>
</ul>
</li>
<li>Bandas de Bollinger:
<ul>
<li><code>BBands(HLC, n = 20, maType, sd = 2, ...)</code></li>
</ul>
</li>
<li>Tasa de cambio/impulso:
<ul>
<li>Tasa de cambio - <code>ROC(x, n = 1, type = c("continuous", "discrete"), na.pad = TRUE)</code>.</li>
<li>Impulso/Momento - <code>momentum(x, n = 1, na.pad = TRUE)</code>
</li>
</ul>
</li>
<li>Medias Móviles (maType):
<ul>
<li>Media móvil simple - <code>SMA(x, n = 10, ...)</code>
</li>
<li>Media móvil exponencial - <code>EMA(x, n = 10, wilder = FALSE, ratio = NULL, ...)</code>
</li>
<li>Media móvil exponencial doble - <code>DEMA(x, n = 10, v = 1, wilder = FALSE, ratio = NULL)</code>
</li>
<li>Media móvil Ponderada - <code>WMA(x, n = 10, wts = 1:n, ...)</code>
</li>
<li>Media móvil elástica ponderada por volumen - <code>EVWMA(price, volume, n = 10, ...)</code>
</li>
<li>Media móvil exponencial de retardo cero - <code>ZLEMA(x, n = 10, ratio = NULL, ...)</code>
</li>
<li>Precio promedio móvil ponderado por volumen - <code>VWAP(price, volume, n = 10, ...)</code>
</li>
<li>Media móvil de longitud variable - <code>VMA(x, w, ratio = 1, ...)</code>
</li>
<li>Media móvil de Hull - <code>HMA(x, n = 20, ...)</code>
</li>
<li>Média Movil de Arnaud Legoux - <code>ALMA(x, n = 9, offset = 0.85, sigma = 6, ...)</code>
</li>
</ul>
</li>
<li>Oscilador MACD:
<ul>
<li><code>MACD(x, nFast = 12, nSlow = 26, nSig = 9, maType, percent = TRUE, ...)</code></li>
</ul>
</li>
<li>Índice de Fuerza Relativa:
<ul>
<li><code>RSI(price, n = 14, maType, ...)</code></li>
</ul>
</li>
<li>runFun:
<ul>
<li>
<code>runSum(x, n = 10, cumulative = FALSE)</code>: devuelve sumas durante una ventana móvil de n períodos.</li>
<li>
<code>runMin(x, n = 10, cumulative = FALSE)</code>: devuelve mínimos durante una ventana móvil de n períodos.</li>
<li>
<code>runMax(x, n = 10, cumulative = FALSE)</code>: devuelve máximos durante una ventana móvil de n períodos.</li>
<li>
<code>runMean(x, n = 10, cumulative = FALSE)</code>: devuelve medias durante una ventana móvil de n períodos.</li>
<li>
<code>runMedian(x, n = 10, non.unique = "mean", cumulative = FALSE)</code>: devuelve medianas durante una ventana móvil de n períodos.</li>
<li>
<code>runCov(x, y, n = 10, use = "all.obs", sample = TRUE, cumulative = FALSE)</code>: devuelve covarianzas sobre una ventana móvil de n períodos.</li>
<li>
<code>runCor(x, y, n = 10, use = "all.obs", sample = TRUE, cumulative = FALSE)</code>: devuelve correlaciones durante una ventana móvil de n períodos.</li>
<li>
<code>runVar(x, y = NULL, n = 10, sample = TRUE, cumulative = FALSE)</code>: devuelve variaciones durante una ventana móvil de n períodos.</li>
<li>
<code>runSD(x, n = 10, sample = TRUE, cumulative = FALSE)</code>: devuelve desviaciones estándar durante una ventana móvil de n períodos.</li>
<li>
<code>runMAD(x, n = 10, center = NULL, stat = "median", constant = 1.4826, non.unique = "mean", cumulative = FALSE)</code>: devuelve las desviaciones absolutas mediana/media durante una ventana móvil de n períodos.</li>
<li>
<code>wilderSum(x, n = 10)</code>: devuelve una suma ponderada al estilo de Welles Wilder sobre una ventana móvil de n períodos.</li>
</ul>
</li>
<li>Ocilador estocástico:
<ul>
<li><code>stoch(HLC, nFastK = 14, nFastD = 3, nSlowD = 3, maType, bounded = TRUE, smooth = 1, ...)</code></li>
</ul>
</li>
<li>Índice de momento estocástico:
<ul>
<li><code>SMI(HLC, n = 13, nFast = 2, nSlow = 25, nSig = 9, maType, bounded = TRUE, ...)</code></li>
</ul>
</li>
</ul>
</div>
<div id="funcionalidad-performanceanalytics" class="section level3" number="4.1.5">
<h3>
<span class="header-section-number">4.1.5</span> Funcionalidad PerformanceAnalytics<a class="anchor" aria-label="anchor" href="#funcionalidad-performanceanalytics"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute_fun_options</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">PerformanceAnalytics</span></span></code></pre></div>
<pre class="scroll-100"><code>## [1] "Return.annualized"        "Return.annualized.excess"
## [3] "Return.clean"             "Return.cumulative"       
## [5] "Return.excess"            "Return.Geltner"          
## [7] "zerofill"</code></pre>
<p>Todas las funciones de mutación <code>PerformanceAnalytics</code> se ocupan de devoluciones:</p>
<ul>
<li><p><code>Return.annualized</code> y <code>Return.annualized.excess</code>: toma los rendimientos del período y los consolida en rendimiento anualizados.</p></li>
<li><p><code>Return.clean</code>: elimina los valores atípicos de las devoluciones.</p></li>
<li><p><code>Return.excess</code>: elimina la tasa libre de riesgo de los rendimientos para generar rendimientos superiores a la tasa libre de riesgo.</p></li>
<li><p><code>zerofill</code>: Se utiliza para reemplazar valores <code>NA</code> con ceros.</p></li>
</ul>
</div>
</div>
<div id="poder-cuantitativo-en-acción" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Poder Cuantitativo en Acción<a class="anchor" aria-label="anchor" href="#poder-cuantitativo-en-acci%C3%B3n"><i class="fas fa-link"></i></a>
</h2>
<p>Revisaremos algunos ejemplos, para ello utilizaremos la base de datos <code>FANG</code>, de datos que consta de los precios de las acciones de FB, AMZN, NFLX y GOOG desde principios de 2013 hasta finales del 2016.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"FANG"</span><span class="op">)</span></span>
<span><span class="va">FANG</span></span></code></pre></div>
<pre class="scroll-100"><code>## # A tibble: 4,032 × 8
##    symbol date        open  high   low close    volume adjusted
##    &lt;chr&gt;  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
##  1 FB     2013-01-02  27.4  28.2  27.4  28    69846400     28  
##  2 FB     2013-01-03  27.9  28.5  27.6  27.8  63140600     27.8
##  3 FB     2013-01-04  28.0  28.9  27.8  28.8  72715400     28.8
##  4 FB     2013-01-07  28.7  29.8  28.6  29.4  83781800     29.4
##  5 FB     2013-01-08  29.5  29.6  28.9  29.1  45871300     29.1
##  6 FB     2013-01-09  29.7  30.6  29.5  30.6 104787700     30.6
##  7 FB     2013-01-10  30.6  31.5  30.3  31.3  95316400     31.3
##  8 FB     2013-01-11  31.3  32.0  31.1  31.7  89598000     31.7
##  9 FB     2013-01-14  32.1  32.2  30.6  31.0  98892800     31.0
## 10 FB     2013-01-15  30.6  31.7  29.9  30.1 173242600     30.1
## # ℹ 4,022 more rows</code></pre>
<div id="ejemplo-1-utilizar-quantmod-periodreturn-para-convertir-precios-en-rentabilidad" class="section level3" number="4.2.1">
<h3>
<span class="header-section-number">4.2.1</span> Ejemplo 1: utilizar quantmod periodReturn para convertir precios en rentabilidad<a class="anchor" aria-label="anchor" href="#ejemplo-1-utilizar-quantmod-periodreturn-para-convertir-precios-en-rentabilidad"><i class="fas fa-link"></i></a>
</h3>
<p>La funcioón <code><a href="https://rdrr.io/pkg/quantmod/man/periodReturn.html">quantmod::periodReturn()</a></code> genera retornos por periodicidad, para ello, revisemos algunos casos:</p>
<div id="ejemplo-1a-obtener-y-registrar-las-rentabilidades-anuales" class="section level4" number="4.2.1.1">
<h4>
<span class="header-section-number">4.2.1.1</span> Ejemplo 1A: Obtener y registrar las rentabilidades anuales<a class="anchor" aria-label="anchor" href="#ejemplo-1a-obtener-y-registrar-las-rentabilidades-anuales"><i class="fas fa-link"></i></a>
</h4>
<p>Utilizamos la columna de precios de cierre ajustados (ajustada para divisiones de acciones, lo que puede hacer que parezca que una acción tiene un mal desempeño si se incluye una división).</p>
<p>Establecemos <code>select = adjusted</code>, investigamos la función <code>periodReturn</code> y descubrimos que acepta <code>type = "arithmetic"</code> y <code>period = "yearly"</code>, que devuelve los rendimientos anuales.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG_annual_returns</span> <span class="op">&lt;-</span> <span class="va">FANG</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span>select     <span class="op">=</span> <span class="va">adjusted</span>, </span>
<span>                 mutate_fun <span class="op">=</span> <span class="va">periodReturn</span>, </span>
<span>                 period     <span class="op">=</span> <span class="st">"yearly"</span>, </span>
<span>                 type       <span class="op">=</span> <span class="st">"arithmetic"</span><span class="op">)</span></span>
<span><span class="va">FANG_annual_returns</span></span></code></pre></div>
<pre class="scroll-100"><code>## # A tibble: 16 × 3
## # Groups:   symbol [4]
##    symbol date       yearly.returns
##    &lt;chr&gt;  &lt;date&gt;              &lt;dbl&gt;
##  1 FB     2013-12-31         0.952 
##  2 FB     2014-12-31         0.428 
##  3 FB     2015-12-31         0.341 
##  4 FB     2016-12-30         0.0993
##  5 AMZN   2013-12-31         0.550 
##  6 AMZN   2014-12-31        -0.222 
##  7 AMZN   2015-12-31         1.18  
##  8 AMZN   2016-12-30         0.109 
##  9 NFLX   2013-12-31         3.00  
## 10 NFLX   2014-12-31        -0.0721
## 11 NFLX   2015-12-31         1.34  
## 12 NFLX   2016-12-30         0.0824
## 13 GOOG   2013-12-31         0.550 
## 14 GOOG   2014-12-31        -0.0597
## 15 GOOG   2015-12-31         0.442 
## 16 GOOG   2016-12-30         0.0171</code></pre>
<p>Ahora, grafiquemos los redimientos anuales, a partir del uso rápido del paquete <code>ggplot2</code>:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG_annual_returns</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">yearly.returns</span>, fill <span class="op">=</span> <span class="va">symbol</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/palette_tq.html">palette_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/percent_format.html">percent</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"FANG: Annual Returns"</span>,</span>
<span>         subtitle <span class="op">=</span> <span class="st">"Get annual returns quickly with tq_transmute!"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Annual Returns"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">symbol</span>, ncol <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html">theme_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/scale_manual.html">scale_fill_tq</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-58-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="ejemplo-1b-obtener-devoluciones-de-registros-diarios" class="section level4" number="4.2.1.2">
<h4>
<span class="header-section-number">4.2.1.2</span> Ejemplo 1B: Obtener devoluciones de registros diarios<a class="anchor" aria-label="anchor" href="#ejemplo-1b-obtener-devoluciones-de-registros-diarios"><i class="fas fa-link"></i></a>
</h4>
<p>Los retornos de registros diarios siguen un enfoque similar. Normalmente se usa una función de transmutación <code>tq_transmute</code> porque la función <code>periodReturn</code> acepta diferentes opciones de periodicidad, y cualquier cosa que no sea diaria hará estallar una mutación.</p>
<p>Sin embargo, en nuestro ejemplo, la periodicidad de los rendimientos es la misma que la periodicidad de los precios de las accciones (ambas diarias), por lo que podemos usar cualquiera de las dos funciones mencionadas anterioremente.</p>
<p>Queremos utilizar la columna de precioes de cierre ajustados, para ello configuramos de manera similar al ejemplo anterior y obtenemos lo siguiente:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG_daily_log_returns</span> <span class="op">&lt;-</span> <span class="va">FANG</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span>select     <span class="op">=</span> <span class="va">adjusted</span>, </span>
<span>                 mutate_fun <span class="op">=</span> <span class="va">periodReturn</span>, </span>
<span>                 period     <span class="op">=</span> <span class="st">"daily"</span>, </span>
<span>                 type       <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>                 col_rename <span class="op">=</span> <span class="st">"monthly.returns"</span><span class="op">)</span></span></code></pre></div>
<p>Y la gráfica, obtenida a partir del paquete <code>ggplot2</code>, se verá de la siguiente manera:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG_daily_log_returns</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">monthly.returns</span>, fill <span class="op">=</span> <span class="va">symbol</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"FANG: Charting the Daily Log Returns"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Monthly Returns"</span>, y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html">theme_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/scale_manual.html">scale_fill_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">symbol</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-60-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="ejemplo-2-utilice-xts-to.period-para-cambiar-la-periodicidad-de-diaria-a-mensual" class="section level3" number="4.2.2">
<h3>
<span class="header-section-number">4.2.2</span> Ejemplo 2: utilice xts to.period para cambiar la periodicidad de diaria a mensual<a class="anchor" aria-label="anchor" href="#ejemplo-2-utilice-xts-to.period-para-cambiar-la-periodicidad-de-diaria-a-mensual"><i class="fas fa-link"></i></a>
</h3>
<p>La función <code><a href="https://rdrr.io/pkg/xts/man/to.period.html">xts::to.period</a></code> se utiliza para convertir la periodicidad de un nivel inferior a un nivel superior (ej: meses a años). Dado que se busca una estructura que tenga una escala de tiempo diferente a la de entrada, se debe hacer una transformación. Utilizamos <code><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute()</a></code>, pasamos las columnas “open”, “high”, “low”, “close” y “volume”, y usamos el periodo “months”.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span>select <span class="op">=</span> <span class="va">open</span><span class="op">:</span><span class="va">volume</span>,</span>
<span>                                mutate_fun <span class="op">=</span> <span class="va">to.period</span>,</span>
<span>                                period <span class="op">=</span> <span class="st">"months"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 192 × 7
## # Groups:   symbol [4]
##    symbol date        open  high   low close    volume
##    &lt;chr&gt;  &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
##  1 FB     2013-01-31  29.2  31.5  28.7  31.0 190744900
##  2 FB     2013-02-28  26.8  27.3  26.3  27.2  83027800
##  3 FB     2013-03-28  26.1  26.2  25.5  25.6  28585700
##  4 FB     2013-04-30  27.1  27.8  27.0  27.8  36245700
##  5 FB     2013-05-31  24.6  25.0  24.3  24.4  35925000
##  6 FB     2013-06-28  24.7  25.0  24.4  24.9  96778900
##  7 FB     2013-07-31  38.0  38.3  36.3  36.8 154828700
##  8 FB     2013-08-30  42.0  42.3  41.1  41.3  67735100
##  9 FB     2013-09-30  50.1  51.6  49.8  50.2 100095000
## 10 FB     2013-10-31  47.2  52    46.5  50.2 248809000
## # ℹ 182 more rows</code></pre>
<p>Podemos comparar la visualización gráfica agrupando y sin agrupas:</p>
<p><strong>Sin agregración de periodicidad</strong></p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG_diario</span> <span class="op">&lt;-</span> <span class="va">FANG</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> </span>
<span><span class="va">FANG_diario</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">adjusted</span>, color <span class="op">=</span> <span class="va">symbol</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Precio diario de acciones"</span>,</span>
<span>                    x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Precios ajustados"</span>, color <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">symbol</span>, ncol <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span><span class="op">+</span></span>
<span>               <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/dollar_format.html">dollar</a></span><span class="op">)</span><span class="op">+</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html">theme_tq</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>               <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/scale_manual.html">scale_color_tq</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-62-1.png" width="672"></div>
<p><strong>Con agregación de periodicidad mensual</strong></p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG_mensual</span> <span class="op">&lt;-</span> <span class="va">FANG</span> <span class="op">|&gt;</span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span>select <span class="op">=</span> <span class="va">adjusted</span>,</span>
<span>                                mutate_fun <span class="op">=</span> <span class="va">to.period</span>,</span>
<span>                                period <span class="op">=</span> <span class="st">"months"</span><span class="op">)</span></span>
<span><span class="va">FANG_mensual</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">adjusted</span>, color <span class="op">=</span> <span class="va">symbol</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Monthly Stock Prices"</span>, x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Adjusted Prices"</span>, color <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">symbol</span>, ncol <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/dollar_format.html">dollar</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html">theme_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/scale_manual.html">scale_color_tq</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure">
<img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-63-1.png" width="672">
Con esto se reduce la cantidad de puntos y el gráfico de la serie temporal se suaviza.</div>
</div>
<div id="ejemplo-3-utilice-ttr-runcor-para-visualizar-correlaciones-continuas-de-rendimientos" class="section level3" number="4.2.3">
<h3>
<span class="header-section-number">4.2.3</span> Ejemplo 3: utilice TTR runCor para visualizar correlaciones continuas de rendimientos<a class="anchor" aria-label="anchor" href="#ejemplo-3-utilice-ttr-runcor-para-visualizar-correlaciones-continuas-de-rendimientos"><i class="fas fa-link"></i></a>
</h3>
<p>Las correlaciones de rendimiento son una forma para analizar la medida en que un activo imita un índice de referencia. Utilizaremos los datos de <code>FANG</code> como los datos y la línea de base será el sector tecnológico “XLK”, para ello se recupera los precios utilizando <code>tq_get</code>, y los rendimientos se calculan a partir de los precios ajustados del Ejemplo 1</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Rendimientos</span></span>
<span><span class="va">FANG_rend_mensual</span> <span class="op">&lt;-</span> <span class="va">FANG</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                     <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span>select <span class="op">=</span> <span class="va">adjusted</span>,</span>
<span>                                  mutate_fun <span class="op">=</span> <span class="va">periodReturn</span>,</span>
<span>                                  period <span class="op">=</span> <span class="st">"monthly"</span><span class="op">)</span></span>
<span><span class="co">#Valor base de Rendimientos de referencia</span></span>
<span><span class="va">base_rend_mensual</span> <span class="op">&lt;-</span> <span class="st">"XLK"</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_get.html">tq_get</a></span><span class="op">(</span>get <span class="op">=</span> <span class="st">"stock.prices"</span>,</span>
<span>                                            from <span class="op">=</span> <span class="st">"2013-01-01"</span>,</span>
<span>                                            to <span class="op">=</span> <span class="st">"2016-12-31"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                              <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span>select <span class="op">=</span> <span class="va">adjusted</span>,</span>
<span>                                           mutate_fun <span class="op">=</span> <span class="va">periodReturn</span>,</span>
<span>                                           period <span class="op">=</span> <span class="st">"monthly"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Unir </span></span>
<span><span class="va">rends</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">FANG_rend_mensual</span>, <span class="va">base_rend_mensual</span>, by<span class="op">=</span><span class="st">"date"</span><span class="op">)</span></span>
<span><span class="va">rends</span></span></code></pre></div>
<pre><code>## # A tibble: 192 × 4
## # Groups:   symbol [4]
##    symbol date       monthly.returns.x monthly.returns.y
##    &lt;chr&gt;  &lt;date&gt;                 &lt;dbl&gt;             &lt;dbl&gt;
##  1 FB     2013-01-31          0.106             -0.0138 
##  2 FB     2013-02-28         -0.120              0.00782
##  3 FB     2013-03-28         -0.0613             0.0258 
##  4 FB     2013-04-30          0.0856             0.0175 
##  5 FB     2013-05-31         -0.123              0.0279 
##  6 FB     2013-06-28          0.0218            -0.0289 
##  7 FB     2013-07-31          0.479              0.0373 
##  8 FB     2013-08-30          0.122             -0.0104 
##  9 FB     2013-09-30          0.217              0.0253 
## 10 FB     2013-10-31         -0.000398           0.0502 
## # ℹ 182 more rows</code></pre>
<p>La función <code>runCor</code> se puede utilizar para evaluar correlaciones rodantes, además se puede incluir el ancho de la correlación que en este caso utilizaremos seis al estar en una escala mensual. Se utilizará <code>tq_transmute_xy</code> para realizar esto:</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG_corr</span> <span class="op">&lt;-</span> <span class="va">rends</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute_xy</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">monthly.returns.x</span>,</span>
<span>                                   y <span class="op">=</span> <span class="va">monthly.returns.y</span>,</span>
<span>                                   mutate_fun <span class="op">=</span> <span class="va">runCor</span>,</span>
<span>                                   n <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                                   col_rename <span class="op">=</span> <span class="st">"corr_6"</span><span class="op">)</span></span>
<span><span class="co">#Grafico</span></span>
<span><span class="va">FANG_corr</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">corr_6</span>, color <span class="op">=</span> <span class="va">symbol</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/palette_tq.html">palette_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"FANG: Correlación 6 meses a XLK"</span>, x<span class="op">=</span><span class="st">""</span>, y<span class="op">=</span><span class="st">"Correlation"</span>,color<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">symbol</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html">theme_tq</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/scale_manual.html">scale_color_tq</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-65-1.png" width="672"></div>
</div>
<div id="ejemplo-4-utilizar-ttrmacd-para-visualizar-la-divergencia-y-convergencia-de-la-media-móvil" class="section level3" number="4.2.4">
<h3>
<span class="header-section-number">4.2.4</span> Ejemplo 4: utilizar TTR::MACD para visualizar la divergencia y convergencia de la media móvil<a class="anchor" aria-label="anchor" href="#ejemplo-4-utilizar-ttrmacd-para-visualizar-la-divergencia-y-convergencia-de-la-media-m%C3%B3vil"><i class="fas fa-link"></i></a>
</h3>
<p>La función <code>MACD</code> nos da la convergencia y divergencia de la media móvil, vemos que la salida tiene la misma periodicidad que la entrada y las funciones funcionan con las de OHLC, por lo que se puede utilizar <code><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_mutate()</a></code></p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG_macd</span> <span class="op">&lt;-</span> <span class="va">FANG</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                     <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_mutate</a></span><span class="op">(</span>select <span class="op">=</span> <span class="va">close</span>,</span>
<span>                               mutate_fun <span class="op">=</span> <span class="va">MACD</span>,</span>
<span>                               nFast <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                               nSlow <span class="op">=</span> <span class="fl">26</span>,</span>
<span>                               nSig <span class="op">=</span> <span class="fl">9</span>,</span>
<span>                               maType <span class="op">=</span> <span class="va">SMA</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>diff <span class="op">=</span> <span class="va">macd</span> <span class="op">-</span> <span class="va">signal</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">open</span><span class="op">:</span><span class="va">volume</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">FANG_macd</span></span></code></pre></div>
<pre><code>## # A tibble: 4,032 × 6
## # Groups:   symbol [4]
##    symbol date       adjusted  macd signal  diff
##    &lt;chr&gt;  &lt;date&gt;        &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1 FB     2013-01-02     28      NA     NA    NA
##  2 FB     2013-01-03     27.8    NA     NA    NA
##  3 FB     2013-01-04     28.8    NA     NA    NA
##  4 FB     2013-01-07     29.4    NA     NA    NA
##  5 FB     2013-01-08     29.1    NA     NA    NA
##  6 FB     2013-01-09     30.6    NA     NA    NA
##  7 FB     2013-01-10     31.3    NA     NA    NA
##  8 FB     2013-01-11     31.7    NA     NA    NA
##  9 FB     2013-01-14     31.0    NA     NA    NA
## 10 FB     2013-01-15     30.1    NA     NA    NA
## # ℹ 4,022 more rows</code></pre>
<p>Y se puede graficar los datos de la siguiente forma:</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG_macd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/as_date.html">as_date</a></span><span class="op">(</span><span class="st">"2016-10-01"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/palette_tq.html">palette_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">macd</span>, col <span class="op">=</span> <span class="va">symbol</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">signal</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">diff</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/palette_tq.html">palette_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">symbol</span>, ncol <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"FANG: Convergencia y Divergencia de la Media Móvil"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"MACD"</span>, x <span class="op">=</span> <span class="st">""</span>, color <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html">theme_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/scale_manual.html">scale_color_tq</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-67-1.png" width="672"></div>
</div>
<div id="ejemplo-5-utilizar-xtsapply.quarterly-para-obtener-el-precio-máximo-y-mínimo-para-cada-trimestre" class="section level3" number="4.2.5">
<h3>
<span class="header-section-number">4.2.5</span> Ejemplo 5: utilizar xts::apply.quarterly para obtener el precio máximo y mínimo para cada trimestre<a class="anchor" aria-label="anchor" href="#ejemplo-5-utilizar-xtsapply.quarterly-para-obtener-el-precio-m%C3%A1ximo-y-m%C3%ADnimo-para-cada-trimestre"><i class="fas fa-link"></i></a>
</h3>
<p>La función <code><a href="https://rdrr.io/pkg/xts/man/apply.monthly.html">xts::apply.quarterly()</a></code> se puede utilizar para aplicar funciones por segmentos de tiempos trimestrales. Debido a que se va a usar una escala diferente a la de entrada (diaria) se necesita la función de transmutación <code>tq_transmute</code>, en la cual se configura en el argumento <code>FUN= max</code> para obtener los precios máximos de cierre durante el trimestre y en el argumento <code>mutate_fun</code> se escribe la función a aplicar por segmentos.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG_maxtrim</span> <span class="op">&lt;-</span> <span class="va">FANG</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                        <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span>select <span class="op">=</span> <span class="va">adjusted</span>,</span>
<span>                                     mutate_fun <span class="op">=</span> <span class="va">apply.quarterly</span>,</span>
<span>                                     FUN <span class="op">=</span> <span class="va">max</span>,</span>
<span>                                     col_rename <span class="op">=</span> <span class="st">"max.close"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>year.qtr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>, <span class="st">"-Q"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/quarter.html">quarter</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="va">FANG_maxtrim</span></span></code></pre></div>
<pre><code>## # A tibble: 64 × 3
## # Groups:   symbol [4]
##    symbol max.close year.qtr
##    &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;   
##  1 FB          32.5 2013-Q1 
##  2 FB          29.0 2013-Q2 
##  3 FB          51.2 2013-Q3 
##  4 FB          58.0 2013-Q4 
##  5 FB          72.0 2014-Q1 
##  6 FB          67.6 2014-Q2 
##  7 FB          79.0 2014-Q3 
##  8 FB          81.4 2014-Q4 
##  9 FB          85.3 2015-Q1 
## 10 FB          88.9 2015-Q2 
## # ℹ 54 more rows</code></pre>
<p>y para obtener los precios mínimos se cambia el argumento <code>FUN = min</code>, además se pueden unir para obtenerlos en una misma salida:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG_mintrim</span> <span class="op">&lt;-</span> <span class="va">FANG</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                        <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span>select <span class="op">=</span> <span class="va">adjusted</span>,</span>
<span>                                     mutate_fun <span class="op">=</span> <span class="va">apply.quarterly</span>,</span>
<span>                                     FUN <span class="op">=</span> <span class="va">min</span>,</span>
<span>                                     col_rename <span class="op">=</span> <span class="st">"min.close"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>year.qtr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>, <span class="st">"-Q"</span>, <span class="fu"><a href="https://lubridate.tidyverse.org/reference/quarter.html">quarter</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="va">FANG_trim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">FANG_maxtrim</span>,<span class="va">FANG_mintrim</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"symbol"</span><span class="op">=</span><span class="st">"symbol"</span>,<span class="st">"year.qtr"</span><span class="op">=</span><span class="st">"year.qtr"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">FANG_trim</span></span></code></pre></div>
<pre><code>## # A tibble: 64 × 4
## # Groups:   symbol [4]
##    symbol max.close year.qtr min.close
##    &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1 FB          32.5 2013-Q1       25.1
##  2 FB          29.0 2013-Q2       22.9
##  3 FB          51.2 2013-Q3       24.4
##  4 FB          58.0 2013-Q4       44.8
##  5 FB          72.0 2014-Q1       53.5
##  6 FB          67.6 2014-Q2       56.1
##  7 FB          79.0 2014-Q3       62.8
##  8 FB          81.4 2014-Q4       72.6
##  9 FB          85.3 2015-Q1       74.1
## 10 FB          88.9 2015-Q2       77.5
## # ℹ 54 more rows</code></pre>
<p>Para la visualización de los datos podemos realizar lo siguiente:</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG_trim</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">year.qtr</span>,color<span class="op">=</span><span class="va">symbol</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xend<span class="op">=</span><span class="va">year.qtr</span>,y<span class="op">=</span><span class="va">min.close</span>,yend<span class="op">=</span><span class="va">max.close</span><span class="op">)</span>,linewidth<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">max.close</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">min.close</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">symbol</span>, ncol <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"FANG: Precio máximo y mínimo por trimestre"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Precio de acción"</span>, color <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html">theme_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/scale_manual.html">scale_color_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/dollar_format.html">dollar</a></span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>             axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-70-1.png" width="672"></div>
</div>
<div id="ejemplo-6-utilizar-zoorollapply-para-visualizar-una-regresión-continua" class="section level3" number="4.2.6">
<h3>
<span class="header-section-number">4.2.6</span> Ejemplo 6: utilizar zoo::rollapply para visualizar una regresión continua<a class="anchor" aria-label="anchor" href="#ejemplo-6-utilizar-zoorollapply-para-visualizar-una-regresi%C3%B3n-continua"><i class="fas fa-link"></i></a>
</h3>
<p>En este ejemplo se analizará la relación entre dos activos similares: Mastercard y Visa, para mostrar la relación mediante regresión. Primero se verá la tendencia de los rendimientos, para ello utilizamos <code><a href="https://rdrr.io/pkg/tidyquant/man/tq_get.html">tq_get()</a></code> para obtener los precios de las acciones, y <code><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute()</a></code> para transformar los precios en rendimientos.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">precios_accion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MA"</span>, <span class="st">"V"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_get.html">tq_get</a></span><span class="op">(</span>get  <span class="op">=</span> <span class="st">"stock.prices"</span>,</span>
<span>           from <span class="op">=</span> <span class="st">"2015-01-01"</span>,</span>
<span>           to   <span class="op">=</span> <span class="st">"2016-12-31"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">rend_accion</span> <span class="op">&lt;-</span> <span class="va">precios_accion</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span>select     <span class="op">=</span> <span class="va">adjusted</span>,</span>
<span>                 mutate_fun <span class="op">=</span> <span class="va">periodReturn</span>,</span>
<span>                 period     <span class="op">=</span> <span class="st">"daily"</span>,</span>
<span>                 type       <span class="op">=</span> <span class="st">"log"</span>,</span>
<span>                 col_rename <span class="op">=</span> <span class="st">"returns"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span><span class="op">(</span>key <span class="op">=</span> <span class="va">symbol</span>, value <span class="op">=</span> <span class="va">returns</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#GRAFICOS</span></span>
<span><span class="va">rend_accion</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">V</span>,y<span class="op">=</span><span class="va">MA</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/palette_tq.html">palette_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Relación de rendimiento de las acciones "</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html">theme_tq</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-71-1.png" width="672"></div>
<p>Se puede ver estadísticas de la relación a partir de la función <code>lm</code>:</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">MA</span><span class="op">~</span><span class="va">V</span>,data <span class="op">=</span> <span class="va">rend_accion</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = MA ~ V, data = rend_accion)
## 
## Residuals:
##        Min         1Q     Median         3Q        Max 
## -0.0269573 -0.0039656  0.0002147  0.0039654  0.0289460 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.0001130  0.0003097   0.365    0.715    
## V           0.8133684  0.0226393  35.927   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 0.00695 on 502 degrees of freedom
## Multiple R-squared:   0.72,  Adjusted R-squared:  0.7194 
## F-statistic:  1291 on 1 and 502 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>La estimación del coeficiente es 0.8134 por lo que se tiene una relación positiva, es decir que a medida que V crece, MA aumenta.</p>
<p>Se puede utilizar la funcion <code>rollapply</code> para realizar una regresión móvil, es decir, mostrar como el modelo varía a lo largo del tiempo. Para ello se creará una función:</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">regr_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">MA</span><span class="op">~</span><span class="va">V</span>,data<span class="op">=</span><span class="fu">timetk</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/timetk/man/tk_tbl.html">tk_tbl</a></span><span class="op">(</span><span class="va">data</span>,silent<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>y se utilizará <code><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_mutate()</a></code> para aplicar la función de regresión creada utilizando <code>rollapply</code> de la siguiente forma:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rend_accion</span> <span class="op">&lt;-</span> <span class="va">rend_accion</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_mutate</a></span><span class="op">(</span>mutate_fun <span class="op">=</span> <span class="va">rollapply</span>,</span>
<span>                                              width<span class="op">=</span><span class="fl">90</span>,</span>
<span>                                              FUN<span class="op">=</span><span class="va">regr_fun</span>,</span>
<span>                                              by.column<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>                                              col_rename <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"coef.0"</span>,<span class="st">"coef.1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rend_accion</span></span></code></pre></div>
<pre><code>## # A tibble: 504 × 5
##    date             MA        V coef.0 coef.1
##    &lt;date&gt;        &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 2015-01-02  0        0           NA     NA
##  2 2015-01-05 -0.0285  -0.0223      NA     NA
##  3 2015-01-06 -0.00216 -0.00646     NA     NA
##  4 2015-01-07  0.0154   0.0133      NA     NA
##  5 2015-01-08  0.0154   0.0133      NA     NA
##  6 2015-01-09 -0.0128  -0.0149      NA     NA
##  7 2015-01-12 -0.0129  -0.00196     NA     NA
##  8 2015-01-13  0.00228  0.00292     NA     NA
##  9 2015-01-14 -0.00108 -0.0202      NA     NA
## 10 2015-01-15 -0.0146  -0.00955     NA     NA
## # ℹ 494 more rows</code></pre>
<p>Para visualizar el primer coeficiente, se puede agregar una linea horizontal utilizando el modelo de conjunto de datos completo, ya que así se puede ver en que momentos se desvía de la tendencia a largo plazo.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rend_accion</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>,y<span class="op">=</span><span class="va">coef.1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>                  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1</span>,color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/palette_tq.html">palette_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">+</span></span>
<span>                  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.8134</span>, size <span class="op">=</span> <span class="fl">1</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/palette_tq.html">palette_light</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">+</span></span>
<span>                  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"MA ~ V: Visualizing Rolling Regression Coefficient"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">+</span></span>
<span>                  <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html">theme_tq</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-75-1.png" width="672"></div>
<p>Para visualizar la rentabilidad de las acciones durante el período de tiempo:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">precios_accion</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span><span class="va">adjusted</span>,</span>
<span>                               <span class="va">periodReturn</span>,</span>
<span>                               period<span class="op">=</span><span class="st">"daily"</span>,</span>
<span>                               type<span class="op">=</span><span class="st">"log"</span>,</span>
<span>                               col_name<span class="op">=</span><span class="st">"returns"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>                   <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>wealth.index <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumprod</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">daily.returns</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>                   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">wealth.index</span>, color <span class="op">=</span> <span class="va">symbol</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>                   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>                   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"MA and V: Stock Prices"</span><span class="op">)</span> <span class="op">+</span></span>
<span>                   <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/theme_tq.html">theme_tq</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                   <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/scale_manual.html">scale_color_tq</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-76-1.png" width="672"></div>
</div>
<div id="ejemplo-7-utilizar-return.clean-y-return.excess-para-limpiar-y-calcular-el-exceso-de-rendimiento" class="section level3" number="4.2.7">
<h3>
<span class="header-section-number">4.2.7</span> Ejemplo 7: utilizar return.clean y return.excess para limpiar y calcular el exceso de rendimiento<a class="anchor" aria-label="anchor" href="#ejemplo-7-utilizar-return.clean-y-return.excess-para-limpiar-y-calcular-el-exceso-de-rendimiento"><i class="fas fa-link"></i></a>
</h3>
<p>En este ejemplo primero se calcula los rendimientos diarios utilizando <code>periodReturn</code>, luego se utiliza <code>Return.clean</code> para limpiar los valores atípico de los datos devueltos, en el que el parámetro <code>alpha</code> es el porcentaje de datos atípicos se va a limpiar. Por último, los rendimientos excedentes se calculan con la función <code>Return.excess</code> con el parámetro <code>Rf</code> que representa la tasa libre de riesgo.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">FANG</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span><span class="va">adjusted</span>, <span class="va">periodReturn</span>, period <span class="op">=</span> <span class="st">"daily"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>                              <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span><span class="va">daily.returns</span>, <span class="va">Return.clean</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>                              <span class="fu"><a href="https://rdrr.io/pkg/tidyquant/man/tq_mutate.html">tq_transmute</a></span><span class="op">(</span><span class="va">daily.returns</span>, <span class="va">Return.excess</span>, Rf <span class="op">=</span> <span class="fl">0.03</span> <span class="op">/</span> <span class="fl">252</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 4,032 × 3
## # Groups:   symbol [4]
##    symbol date       `daily.returns &gt; Rf`
##    &lt;chr&gt;  &lt;date&gt;                    &lt;dbl&gt;
##  1 FB     2013-01-02            -0.000119
##  2 FB     2013-01-03            -0.00833 
##  3 FB     2013-01-04             0.0355  
##  4 FB     2013-01-07             0.0228  
##  5 FB     2013-01-08            -0.0124  
##  6 FB     2013-01-09             0.0525  
##  7 FB     2013-01-10             0.0231  
##  8 FB     2013-01-11             0.0133  
##  9 FB     2013-01-14            -0.0244  
## 10 FB     2013-01-15            -0.0276  
## # ℹ 4,022 more rows</code></pre>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="r6.html"><span class="header-section-number">3</span> R6</a></div>
<div class="next"><a href="qualitytools.html"><span class="header-section-number">5</span> QualityTools</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#tidyquant"><span class="header-section-number">4</span> TidyQuant</a></li>
<li>
<a class="nav-link" href="#compatibilidad-de-funciones"><span class="header-section-number">4.1</span> Compatibilidad de funciones</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#funcionalidad-zoo"><span class="header-section-number">4.1.1</span> Funcionalidad zoo</a></li>
<li><a class="nav-link" href="#funcionalidad-xts"><span class="header-section-number">4.1.2</span> Funcionalidad xts</a></li>
<li><a class="nav-link" href="#funcionalidad-quantmod"><span class="header-section-number">4.1.3</span> Funcionalidad quantmod</a></li>
<li><a class="nav-link" href="#funcionalidad-ttr"><span class="header-section-number">4.1.4</span> Funcionalidad TTR</a></li>
<li><a class="nav-link" href="#funcionalidad-performanceanalytics"><span class="header-section-number">4.1.5</span> Funcionalidad PerformanceAnalytics</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#poder-cuantitativo-en-acci%C3%B3n"><span class="header-section-number">4.2</span> Poder Cuantitativo en Acción</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ejemplo-1-utilizar-quantmod-periodreturn-para-convertir-precios-en-rentabilidad"><span class="header-section-number">4.2.1</span> Ejemplo 1: utilizar quantmod periodReturn para convertir precios en rentabilidad</a></li>
<li><a class="nav-link" href="#ejemplo-2-utilice-xts-to.period-para-cambiar-la-periodicidad-de-diaria-a-mensual"><span class="header-section-number">4.2.2</span> Ejemplo 2: utilice xts to.period para cambiar la periodicidad de diaria a mensual</a></li>
<li><a class="nav-link" href="#ejemplo-3-utilice-ttr-runcor-para-visualizar-correlaciones-continuas-de-rendimientos"><span class="header-section-number">4.2.3</span> Ejemplo 3: utilice TTR runCor para visualizar correlaciones continuas de rendimientos</a></li>
<li><a class="nav-link" href="#ejemplo-4-utilizar-ttrmacd-para-visualizar-la-divergencia-y-convergencia-de-la-media-m%C3%B3vil"><span class="header-section-number">4.2.4</span> Ejemplo 4: utilizar TTR::MACD para visualizar la divergencia y convergencia de la media móvil</a></li>
<li><a class="nav-link" href="#ejemplo-5-utilizar-xtsapply.quarterly-para-obtener-el-precio-m%C3%A1ximo-y-m%C3%ADnimo-para-cada-trimestre"><span class="header-section-number">4.2.5</span> Ejemplo 5: utilizar xts::apply.quarterly para obtener el precio máximo y mínimo para cada trimestre</a></li>
<li><a class="nav-link" href="#ejemplo-6-utilizar-zoorollapply-para-visualizar-una-regresi%C3%B3n-continua"><span class="header-section-number">4.2.6</span> Ejemplo 6: utilizar zoo::rollapply para visualizar una regresión continua</a></li>
<li><a class="nav-link" href="#ejemplo-7-utilizar-return.clean-y-return.excess-para-limpiar-y-calcular-el-exceso-de-rendimiento"><span class="header-section-number">4.2.7</span> Ejemplo 7: utilizar return.clean y return.excess para limpiar y calcular el exceso de rendimiento</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Integración del Paquete QualityTools con Tidyverse</strong>" was written by Miguel Flores, Andrea Barahona, Fabián Encarnación, Dario Quishpe. It was last built on 2024-04-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
