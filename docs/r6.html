<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 3 R6 | Integración del Paquete QualityTools con Tidyverse</title>
<meta name="author" content="Miguel Flores">
<meta name="author" content="Andrea Barahona">
<meta name="author" content="Fabián Encarnación">
<meta name="author" content="Dario Quishpe">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="Capítulo 3 R6 | Integración del Paquete QualityTools con Tidyverse">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 3 R6 | Integración del Paquete QualityTools con Tidyverse">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.6.0/transition.js"></script><script src="libs/bs3compat-0.6.0/tabs.js"></script><script src="libs/bs3compat-0.6.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<meta name="description" content="El sistema POO R6 se lo puede empezar analizando mediante sus dos propiedades especiales : -Utiliza el paradigma de POO encapsulada, lo que significa que los métodos pertenecen a los objetos, no a...">
<meta property="og:description" content="El sistema POO R6 se lo puede empezar analizando mediante sus dos propiedades especiales : -Utiliza el paradigma de POO encapsulada, lo que significa que los métodos pertenecen a los objetos, no a...">
<meta name="twitter:description" content="El sistema POO R6 se lo puede empezar analizando mediante sus dos propiedades especiales : -Utiliza el paradigma de POO encapsulada, lo que significa que los métodos pertenecen a los objetos, no a...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Integración del Paquete QualityTools con Tidyverse</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Preámbulo</a></li>
<li><a class="" href="poo-programaci%C3%B3n-orientada-a-objetos.html"><span class="header-section-number">2</span> (POO) Programación Orientada a Objetos</a></li>
<li><a class="active" href="r6.html"><span class="header-section-number">3</span> R6</a></li>
<li><a class="" href="tidyquant.html"><span class="header-section-number">4</span> TidyQuant</a></li>
<li><a class="" href="qualitytools.html"><span class="header-section-number">5</span> QualityTools</a></li>
<li><a class="" href="cambio-de-funciones.html"><span class="header-section-number">6</span> Cambio de Funciones</a></li>
<li><a class="" href="referencias.html">Referencias</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="r6" class="section level1" number="3">
<h1>
<span class="header-section-number">Capítulo 3</span> R6<a class="anchor" aria-label="anchor" href="#r6"><i class="fas fa-link"></i></a>
</h1>
<div>
<img src="graficasR6/logo.svg" width="120" align="right">
</div>
<p>El sistema POO R6 se lo puede empezar analizando mediante sus dos propiedades especiales :</p>
<p>-Utiliza el paradigma de POO encapsulada, lo que significa que los métodos pertenecen a los objetos, no a los genéricos, y se se los puede llamar mediante <code>object$method()</code>.</p>
<p>-Los objetos R6 son mutables, lo que significa que se modifican en el lugar, y por lo tanto tienen semántica de referencia.</p>
<p>Si se tiene conocimientos de POO en otros lenguajes es probable que R6 resulte muy natural y sea una buena alternativa a S3.</p>
<p>Los temas a tratar en referencia a R6 son los siguiente :</p>
<ul>
<li><p>Clases y métodos : <code><a href="https://r6.r-lib.org/reference/R6Class.html">R6::R6Class()</a></code> la única función que necesitas conocer para crear clases R6. Aprenderás sobre el método constructor, $new(), que te permite crear objetos R6, así como otros métodos importantes como $initialize() y $print().</p></li>
<li><p>Controles de acceso: mecanismos de acceso de R6 , campos privados y activos. Juntos, permiten ocultar datos al usuario, o exponer datos privados para su lectura pero no para su escritura.</p></li>
<li><p>Semántica de referencia : explora las consecuencias de la semántica de referencia de R6. Se aprende el uso de finalizadores para limpiar automáticamente cualquier operación realizada en el inicializador, y un problema común si usas un objeto R6 como campo en otro objeto R6.</p></li>
<li><p>Por qué R6 en lugar del sistema RC base?</p></li>
</ul>
<p><strong>Requisito : </strong></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#install.packages("R6")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r6.r-lib.org">R6</a></span><span class="op">)</span></span></code></pre></div>
<div id="clases-y-métodos" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Clases y métodos<a class="anchor" aria-label="anchor" href="#clases-y-m%C3%A9todos"><i class="fas fa-link"></i></a>
</h2>
<p>Para crear las clases y sus métodos se utiliza: <code><a href="https://r6.r-lib.org/reference/R6Class.html">R6::R6Class()</a></code></p>
<p>Por ejemplo:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SumaAcum</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"SumaAcum"</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  suma <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sumar <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="va">self</span><span class="op">$</span><span class="va">suma</span><span class="op">&lt;-</span><span class="va">self</span><span class="op">$</span><span class="va">suma</span><span class="op">+</span><span class="va">x</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>En el ejemplo se muestra los argumentos que deben ir en la función <code><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class()</a></code>:</p>
<ul>
<li><p>El primer argumento es el nombre de la clase, el cual no es necesario, pero evita errores.</p></li>
<li><p>El segundo argumento son los métodos (funciones) y campos (variables) públicos del objeto. Los métodos pueden acceder a los métodos y campos del mismo objeto mediante <code>self</code></p></li>
</ul>
<p>Para crear un nuevo objeto se utiliza el método <code>$new()</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">SumaAcum</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">## &lt;SumaAcum&gt;</span></span>
<span><span class="co">##   Public:</span></span>
<span><span class="co">##     clone: function (deep = FALSE) </span></span>
<span><span class="co">##     suma: 0</span></span>
<span><span class="co">##     sumar: function (x = 1)</span></span></code></pre></div>
<p>Además, se accede a los campos y se llama a los métodos mediante <code>$</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span><span class="op">$</span><span class="fu">sumar</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">suma</span></span>
<span><span class="co">## [1] 2</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="fu">sumar</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">suma</span></span>
<span><span class="co">## [1] 6</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="fu">sumar</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">suma</span></span>
<span><span class="co">## [1] 7</span></span></code></pre></div>
<p>Vemos también que se utiliza <code>self$</code> para acceder a los miembros y métodos públicos de la clase (se puede usar <code>private$</code> o <code>super$</code> para miembros privados o que heredan que se verá más adelante)</p>
<div id="encadenamiento-de-métodos" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> Encadenamiento de métodos<a class="anchor" aria-label="anchor" href="#encadenamiento-de-m%C3%A9todos"><i class="fas fa-link"></i></a>
</h3>
<p>Debido a como se crean los métodos podemos realizar un encadenamiento, por ejemplo:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">SumaAcum</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">y</span><span class="op">$</span><span class="fu">sumar</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">$</span><span class="fu">sumar</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">y</span><span class="op">$</span><span class="va">suma</span></span>
<span><span class="co">## [1] 15</span></span></code></pre></div>
<p>Este encadenamiento está relacionados con los <strong>pipe</strong> y se revisará más adelante los pros y contras de esto.</p>
</div>
<div id="métodos-importantes" class="section level3" number="3.1.2">
<h3>
<span class="header-section-number">3.1.2</span> Métodos importantes<a class="anchor" aria-label="anchor" href="#m%C3%A9todos-importantes"><i class="fas fa-link"></i></a>
</h3>
<p>El método <code>$initialize()</code> modifica el comportamiento de <code>$new()</code>, por ejemplo:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Persona</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"Persona"</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  nombre <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  edad <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">nombre</span>, <span class="va">edad</span><span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">nombre</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nombre</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">is.numeric</a></span><span class="op">(</span><span class="va">edad</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">edad</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">nombre</span> <span class="op">&lt;-</span> <span class="va">nombre</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">edad</span> <span class="op">&lt;-</span> <span class="va">edad</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>De esta forma se asegura que el nombre sea un solo string y que la edad sea un solo número. Creemos por ejemplo:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Andrea</span> <span class="op">&lt;-</span> <span class="va">Persona</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Andrea"</span>, <span class="st">'veintidos'</span><span class="op">)</span></span>
<span><span class="co">## Error in initialize(...): is.numeric(edad) is not TRUE</span></span></code></pre></div>
<p>Por lo tanto no se crea, debido a que <code>'veintidos'</code> no es un número, y si se creará cuando lo creemos de esta forma:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Andrea</span> <span class="op">&lt;-</span> <span class="va">Persona</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Andrea"</span>, <span class="fl">22</span><span class="op">)</span></span></code></pre></div>
<p>En caso de tener requisitos más complejos se puede utilizar <code>$validate()</code></p>
<p>El método <code>$print()</code> permite modificar el comportamiento de la impresión por defecto, por ejemplo:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Persona</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"Persona"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  nombre <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  edad <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">nombre</span>, <span class="va">edad</span> <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">nombre</span> <span class="op">&lt;-</span> <span class="va">nombre</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">edad</span> <span class="op">&lt;-</span> <span class="va">edad</span></span>
<span>  <span class="op">}</span>,</span>
<span>  print <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Persona: \n"</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Nombre: "</span>, <span class="va">self</span><span class="op">$</span><span class="va">nombre</span>, <span class="st">"\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Edad:  "</span>, <span class="va">self</span><span class="op">$</span><span class="va">edad</span>, <span class="st">"\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Andrea2</span> <span class="op">&lt;-</span> <span class="va">Persona</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Andrea"</span><span class="op">)</span></span>
<span><span class="va">Andrea2</span></span>
<span><span class="co">## Persona: </span></span>
<span><span class="co">## Nombre: Andrea</span></span>
<span><span class="co">## Edad:  NA</span></span></code></pre></div>
<p>Ahora vemos que el objeto creado anteriormente no tiene relación con este nuevo, pues cada método está vinculado a un objeto individual. Vemos que:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Andrea</span></span>
<span><span class="co">## &lt;Persona&gt;</span></span>
<span><span class="co">##   Public:</span></span>
<span><span class="co">##     clone: function (deep = FALSE) </span></span>
<span><span class="co">##     edad: 22</span></span>
<span><span class="co">##     initialize: function (nombre, edad = NA) </span></span>
<span><span class="co">##     nombre: Andrea</span></span>
<span><span class="va">Andrea2</span></span>
<span><span class="co">## Persona: </span></span>
<span><span class="co">## Nombre: Andrea</span></span>
<span><span class="co">## Edad:  NA</span></span></code></pre></div>
<p>No imprimen lo mismo.</p>
</div>
<div id="agregar-métodos-después-de-la-creación" class="section level3" number="3.1.3">
<h3>
<span class="header-section-number">3.1.3</span> Agregar métodos después de la creación<a class="anchor" aria-label="anchor" href="#agregar-m%C3%A9todos-despu%C3%A9s-de-la-creaci%C3%B3n"><i class="fas fa-link"></i></a>
</h3>
<p>Para evitar crear nuevas clases, se puede modificar los campos o métodos de una ya existente. Se utiliza <code>$set()</code> para agregar nuevos elementos. Por ejemplo:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SumAcum</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"SumAcum"</span><span class="op">)</span></span>
<span><span class="va">SumAcum</span><span class="op">$</span><span class="fu">set</span><span class="op">(</span><span class="st">"public"</span>, <span class="st">"suma"</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">SumAcum</span><span class="op">$</span><span class="fu">set</span><span class="op">(</span><span class="st">"public"</span>, <span class="st">"sumar"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">self</span><span class="op">$</span><span class="va">suma</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="va">suma</span> <span class="op">+</span> <span class="va">x</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p>Para agregarlos debemos proporcionar: visibilidad (public, entre otros), nombre y lo que se va a agregrar.</p>
<p>De esta forma se crea este objeto igual al que se creó en la primera sección. Además, si se agregan nuevo campos o métodos solo estarán disponibles para los nuevos objetos creados a partir de esto.</p>
<p>Para evitar aumentar métodos o campos se puede bloquear la clase mediante <code>lock_class=TRUE</code>, de la siguiente forma:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SumaAcum</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"SumaAcum"</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  suma <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sumar <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="va">self</span><span class="op">$</span><span class="va">suma</span><span class="op">&lt;-</span><span class="va">self</span><span class="op">$</span><span class="va">suma</span><span class="op">+</span><span class="va">x</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span>,</span>
<span>  lock_class <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>De esta forma si intentamos utilizar <code>$set()</code> se tendrá un error:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SumaAcum</span><span class="op">$</span><span class="fu">set</span><span class="op">(</span><span class="st">'public'</span>,<span class="st">'y'</span>,<span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Error in SumaAcum$set("public", "y", 0): Can't modify a locked R6 class.</code></pre>
<p>Se puede también bloquear o desbloquear la clase mediante <code>$lock()</code> y <code>$unlock()</code> respectivamente.</p>
</div>
<div id="herencia" class="section level3" number="3.1.4">
<h3>
<span class="header-section-number">3.1.4</span> Herencia<a class="anchor" aria-label="anchor" href="#herencia"><i class="fas fa-link"></i></a>
</h3>
<p>Se puede heredar los comportamientos de una clase existente a otra utilizando <code>inherit</code>, para ello veamos el ejemplo:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">SumAcumMsg</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"SumAcumMsg"</span>,</span>
<span>  inherit <span class="op">=</span> <span class="va">SumAcum</span>,</span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    sumar <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Sumando "</span>, <span class="va">x</span>, <span class="st">"\n"</span>, sep<span class="op">=</span><span class="st">""</span> <span class="op">)</span></span>
<span>      <span class="va">super</span><span class="op">$</span><span class="fu">sumar</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Al agregar <code>$sumar()</code> se cambia la implementación de la clase que hereda (Super clase) y se modifica con la que se implementa en el código. Vemos que se puede acceder al método de la Super clase mediante <code>super$</code>, y cualquier método que no se modifique utilizará los métodos de la Super Clase.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="va">SumAcumMsg</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">x2</span><span class="op">$</span><span class="fu">sumar</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">$</span><span class="fu">sumar</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">$</span><span class="va">suma</span></span>
<span><span class="co">## Sumando 5</span></span>
<span><span class="co">## Sumando 3</span></span>
<span><span class="co">## [1] 8</span></span></code></pre></div>
</div>
<div id="introspección" class="section level3" number="3.1.5">
<h3>
<span class="header-section-number">3.1.5</span> Introspección<a class="anchor" aria-label="anchor" href="#introspecci%C3%B3n"><i class="fas fa-link"></i></a>
</h3>
<p>Para determinar la clase y todas las que hereda podemos utilizar <code><a href="https://rdrr.io/r/base/class.html">class()</a></code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span>
<span><span class="co">## [1] "SumAcumMsg" "SumAcum"    "R6"</span></span></code></pre></div>
<p>Podemos ver que métodos y campos contiene utilizando <code>name()</code>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">Andrea2</span><span class="op">)</span></span>
<span><span class="co">## [1] ".__enclos_env__" "edad"            "nombre"          "clone"          </span></span>
<span><span class="co">## [5] "print"           "initialize"</span></span></code></pre></div>
</div>
</div>
<div id="controles-de-acceso" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Controles de Acceso<a class="anchor" aria-label="anchor" href="#controles-de-acceso"><i class="fas fa-link"></i></a>
</h2>
<p><code><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class()</a></code> tiene otros 2 argumentos que funcionan similar a <code>public</code>:</p>
<ul>
<li><p><code>private</code> permite crear campos y métodos que solo están disponibles dentro de la clase y no fuera de ella.</p></li>
<li><p><code>active</code> permite utilizar funciones de acceso para definir campos dinámicos o activos.</p></li>
</ul>
<div id="privacidad" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Privacidad<a class="anchor" aria-label="anchor" href="#privacidad"><i class="fas fa-link"></i></a>
</h3>
<p>Con R6 es posible definir campos y metodos <strong>privados</strong>, es decir, que solo están disponibles dentro de la clase. Otros aspectos importantes de conocer son:</p>
<ul>
<li><p>El argumento <code>private</code> en <code>R6Class</code> se declara de la misma forma en la que se hace el argumento <code>public</code>, es decir, asigmar una lista de métodos (funciones) y campos (variables).</p></li>
<li><p>Los campos y métodos definidos en <code>private</code> estarán disponible dentro de los métodos usando <code>private$</code> en lugar de <code>self$</code>.</p></li>
</ul>
<p>Para poner esto en práctica, escribamos los campos <code>$edad</code> y <code>$nombre</code> como argumentos privados de la clase <em>Persona</em>.</p>
<p>Una vez definidos de esta forma, solo podremos establecer <code>$edad</code> y <code>$nombre</code> durante la creación del objeto, y no tendremos acceso a estos valores fuera de la clase.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Persona</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"Persona"</span>, </span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">nombre</span>, <span class="va">edad</span> <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="va">nombre</span> <span class="op">&lt;-</span> <span class="va">nombre</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="va">edad</span> <span class="op">&lt;-</span> <span class="va">edad</span></span>
<span>    <span class="op">}</span>,</span>
<span>    print <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Persona: \n"</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"  Nombre: "</span>, <span class="va">private</span><span class="op">$</span><span class="va">nombre</span>, <span class="st">"\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"  Edad:  "</span>, <span class="va">private</span><span class="op">$</span><span class="va">edad</span>, <span class="st">"\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span>,</span>
<span>  private <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    edad <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    nombre <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">Andrea3</span> <span class="op">&lt;-</span> <span class="va">Persona</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Andrea"</span><span class="op">)</span></span>
<span><span class="va">Andrea3</span></span>
<span><span class="co">## Persona: </span></span>
<span><span class="co">##   Nombre: Andrea</span></span>
<span><span class="co">##   Edad:  NA</span></span>
<span><span class="va">Andrea3</span><span class="op">$</span><span class="va">nombre</span></span>
<span><span class="co">## NULL</span></span></code></pre></div>
<p>Esta distinción entre campos públicos y privados es importante cuando se crea redes complejas de clases, ya que será fundamental tener claro a los campos que otros podrán acceder y cuales no.</p>
<p>Todo lo que sea privado se puede refactorizar más fácilmente porque sabes que los demás no dependen de estos campos. Los métodos privados tienden a ser menos importantes en R en comparación con otros lenguajes de programación porque las jerarquías de objetos en R tienden a ser más simples.</p>
</div>
<div id="campos-activos" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> Campos Activos<a class="anchor" aria-label="anchor" href="#campos-activos"><i class="fas fa-link"></i></a>
</h3>
<p>Los campos activos permiten definir componentes que funcionan como campos para los usuarios, pero están definidos como funciones, es decir, como métodos.</p>
<p>Los campos activos están implementados usando <strong>enlaces activos</strong>, que son funciones que toman un único argumento (<code>value</code>), si el argumento es <code><a href="https://rdrr.io/r/base/missing.html">missing()</a></code>, significa que el valor se está recuperando, o de lo contrario se está modificando.</p>
<p>Por ejemplo, creemos un campo activo llamado <code>random</code> que nos devuelva un valor diferente cada que accedemos a el:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Ran</span> <span class="op">&lt;-</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"Ran"</span>, active <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  random <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>  </span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Can't set `$random`"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">Ran</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">random</span></span>
<span><span class="co">## [1] 0.1002803</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">random</span></span>
<span><span class="co">## [1] 0.5582929</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">random</span></span>
<span><span class="co">## [1] 0.5201251</span></span></code></pre></div>
<p>Los campos activos son usandos particularmente junto con el argumento de campos privamos, ya que esto hace posible implementar componentes similares a los campos pero con controles adicionales. Por ejemplo, podemos usar esto para crear un campo solo de lectura para <code>edad</code>, y para asegurarnos que <code>nombre</code> sea un vector de un solo caracter.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Persona</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"Person"</span>, </span>
<span>  </span>
<span>  private <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    .edad <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    .nombre <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  active <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    edad <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">private</span><span class="op">$</span><span class="va">.edad</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"`$edad` solo se puede leeer"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span>,</span>
<span>    name <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">private</span><span class="op">$</span><span class="va">.nombre</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">is.character</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span>        <span class="va">private</span><span class="op">$</span><span class="va">.nombre</span> <span class="op">&lt;-</span> <span class="va">value</span></span>
<span>        <span class="va">self</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">nombre</span>, <span class="va">edad</span> <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="va">.nombre</span> <span class="op">&lt;-</span> <span class="va">nombre</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="va">.edad</span> <span class="op">&lt;-</span> <span class="va">edad</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">Andrea4</span> <span class="op">&lt;-</span> <span class="va">Persona</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"Andrea"</span>, edad <span class="op">=</span> <span class="fl">22</span><span class="op">)</span></span>
<span><span class="va">Andrea4</span><span class="op">$</span><span class="va">nombre</span></span>
<span><span class="co">## NULL</span></span>
<span><span class="va">Andrea4</span><span class="op">$</span><span class="va">nombre</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="co">## Error in Andrea4$nombre &lt;- 10: no se pueden adicionar vínculos a un ambiente bloqueado</span></span>
<span><span class="va">Andrea4</span><span class="op">$</span><span class="va">edad</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="co">## Error: `$edad` solo se puede leeer</span></span></code></pre></div>
</div>
</div>
<div id="semántica-de-referencia" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Semántica de referencia<a class="anchor" aria-label="anchor" href="#sem%C3%A1ntica-de-referencia"><i class="fas fa-link"></i></a>
</h2>
<p>Una de las grandes diferencias entre R6 y la mayoría de los demás objetos es que tienen una semántica de referencia. La principal consecuencia de la semántica de referencia es que los objetos no se copian cuando se modifican:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="va">SumaAcum</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="va">y1</span></span>
<span></span>
<span><span class="va">y1</span><span class="op">$</span><span class="fu">sumar</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>y1 <span class="op">=</span> <span class="va">y1</span><span class="op">$</span><span class="va">suma</span>, y2 <span class="op">=</span> <span class="va">y2</span><span class="op">$</span><span class="va">suma</span><span class="op">)</span></span>
<span><span class="co">## y1 y2 </span></span>
<span><span class="co">## 10 10</span></span></code></pre></div>
<p>En cambio, si queremos copiar, necesitamos expecificarlo con el método <code>$clone()</code>:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="va">SumaAcum</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="va">y1</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y1</span><span class="op">$</span><span class="fu">sumar</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>y1 <span class="op">=</span> <span class="va">y1</span><span class="op">$</span><span class="va">suma</span>, y2 <span class="op">=</span> <span class="va">y2</span><span class="op">$</span><span class="va">suma</span><span class="op">)</span></span>
<span><span class="co">## y1 y2 </span></span>
<span><span class="co">## 10  0</span></span></code></pre></div>
<p>(<code>$clone()</code> no clona recursivamente objetos R6 anidados. Si quieres eso, necesitarás usar <code>$clone(deep = TRUE)</code>.)</p>
<p>Hay otras tres consecuencias menos intuitivas:</p>
<ul>
<li><p>Es más difícil razonar sobre el código que utiliza objetos R6 porque es necesario comprender más contexto.</p></li>
<li><p>Tiene sentido pensar en cuándo se elimina un objeto R6 y puede escribir <code>$finalize()</code> para complementar <code>$initialize()</code>.</p></li>
<li><p>Si uno de los campos es un objeto R6, debe crearlo dentro de <code>$initialize()</code>, no de R6Class().</p></li>
</ul>
<p>Estas están descritas con mayor detalle a continuación.</p>
<div id="razonamientos" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Razonamientos<a class="anchor" aria-label="anchor" href="#razonamientos"><i class="fas fa-link"></i></a>
</h3>
<p>Generalmente, las semanticas de referencias hacen el código más difícil de entender. Tomemos el siguiente ejemplo sencillo:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p>Para la gran mayoría de funciones, sabes que la línea final solo modifica <code>z</code>.</p>
<p>Ahora, tomemos un ejemplo similar que utiliza una clase de referencia de <code>Lista</code> imaginaria:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">Lista</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">Lista</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>b <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p>Es mucho más difícil de entender la línea final: si <code>f()</code> llama a métodos de <code>x</code> o <code>y</code>, podría modificarlos al igual que <code>z</code>. Este es el mayor inconveniente potencial de R6 y se debe tener cuidado de evitarlo escribiendo funciones que devuelvan un valor o modifiquen sus entradas de R6, pero no ambas.</p>
</div>
<div id="finalización" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Finalización<a class="anchor" aria-label="anchor" href="#finalizaci%C3%B3n"><i class="fas fa-link"></i></a>
</h3>
<p>La semántica de referencia, permite pensar en el momento en que un objeto R6 es finalizado o eliminado. Esto es diferente a la mayoría de los objetos en R, donde la semántica de copia al modificar significa que puede haber muchas versiones transitorias de un objeto, lo que no permite pensar en cuándo se elimina un objeto de forma lógica.</p>
<p>Por ejemplo, en el caso de objetos de tipo factor en R, cuando se modifican los niveles de un factor, se crea un nuevo objeto factor y el objeto original se deja para que lo recolecte el recolector de basura.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"b"</span>, <span class="st">"a"</span><span class="op">)</span></span></code></pre></div>
<p>Debido a que los objetos R6 no se copian al modificarlos, solo se eliminan una vez, tiene sentido pensar en el método <code>$finalize()</code> como un complemento al método <code>$initialize()</code>. Los finalizadores generalmente tienen un papel similar a <code><a href="https://rdrr.io/r/base/on.exit.html">on.exit()</a></code>, limpiando cualquier recurso creado por el inicializador.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ArchivoTemporal</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"ArchivoTemporal"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  ruta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">ruta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  finalize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">"Cleaning up "</span>, <span class="va">self</span><span class="op">$</span><span class="va">ruta</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unlink.html">unlink</a></span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="va">ruta</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>El ejemplo proporcionado muestra una clase llamada <code>ArchivoTemporal</code>, que encapsula un archivo temporal y se encarga de eliminarlo automáticamente cuando se finaliza la instancia de la clase.</p>
<p>El método <code>finalize</code> será ejecutado cuando el objeto sea eliminado (o más precisamente, por la primera recolección de basura después de que el objeto haya sido desligado de todos los nombres) o cuando R se cierre.</p>
<p>Esto significa que el finalizador puede ser llamado efectivamente en cualquier parte de tu código en R, lo que hace casi imposible razonar sobre el código del finalizador que toca estructuras de datos compartidas. Se recomienda evitar estos posibles problemas utilizando el finalizador solo para limpiar recursos privados asignados por el inicializador.</p>
<p>Finalmente, veamos cómo se utiliza esta clase <code>ArchivoTemporal</code> creando una instancia, luego eliminando explícitamente la instancia con <code><a href="https://rdrr.io/r/base/rm.html">rm()</a></code>, lo que provoca que el finalizador se ejecute para limpiar el archivo temporal.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">at</span> <span class="op">&lt;-</span> <span class="va">ArchivoTemporal</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">at</span><span class="op">)</span></span></code></pre></div>
<p>En resumen, los objetos R6 permiten definir métodos <code>initialize</code> y <code>finalize</code>, que se ejecutan al crear y eliminar instancias de la clase respectivamente, permitiendo una gestión más controlada de los recursos y la limpieza de la memoria.</p>
</div>
<div id="campos-en-r6" class="section level3" number="3.3.3">
<h3>
<span class="header-section-number">3.3.3</span> Campos en R6<a class="anchor" aria-label="anchor" href="#campos-en-r6"><i class="fas fa-link"></i></a>
</h3>
<p>Una última consecuencia que puede surgir al utilizar semántica de referencia en R6, es particularmente cuando se usa una instancia de una clase R6 como valor predeterminado de un campo. La semántica de referencia significa que cuando asignas un objeto a otro, no se crea una copia independiente, sino que ambos hacen referencia al mismo objeto en la memoria.</p>
<p>Por ejemplo, creemos una clase llamada <code>DatabaseTemporal</code> que tiene un campo <code>archivo</code>, que es una instancia de la clase <code>ArchivoTemporal</code>.</p>
<p>Por ejemplo, dado el siguiente código, queremos crear una base de datos temporal cada vez que llamamos a DatabaseTemporal$new(), pero el código actual siempre usa la misma ruta.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DatabaseTemporal</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"DatabaseTemporal"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  con <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  file <span class="op">=</span> <span class="va">ArchivoTemporal</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html">dbConnect</a></span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html">SQLite</a></span><span class="op">(</span><span class="op">)</span>, ruta <span class="op">=</span> <span class="va">file</span><span class="op">$</span><span class="va">ruta</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  finalize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html">dbDisconnect</a></span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="va">con</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db_a</span> <span class="op">&lt;-</span> <span class="va">DatabaseTemporal</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">db_b</span> <span class="op">&lt;-</span> <span class="va">DatabaseTemporal</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db_a</span><span class="op">$</span><span class="va">file</span><span class="op">$</span><span class="va">ruta</span> <span class="op">==</span> <span class="va">db_b</span><span class="op">$</span><span class="va">file</span><span class="op">$</span><span class="va">ruta</span></span>
<span><span class="co">## [1] TRUE</span></span></code></pre></div>
<p>(Si está familiarizado con Python, esto es muy similar al problema del “argumento predeterminado mutable”).</p>
<p>El problema es que, cuando se usa una instancia de clase como valor predeterminado para un campo, esa instancia se comparte entre todas las instancias de la clase. Por lo tanto, cada instancia de <code>DatabaseTemporal</code> está haciendo referencia al mismo objeto <code>ArchivoTemporal</code>, en lugar de tener su propia instancia única.</p>
<p>Para solucionar este problema, se debe crear una nueva instancia de <code>ArchivoTemporal</code> dentro del método <code>initialize()</code>, de modo que cada instancia de <code>DatabaseTemporal</code> tenga su propia instancia única de <code>ArchivoTemporal</code>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">DatabaseTemporal</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"DatabaseTemporal"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  con <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  archivo <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">archivo</span> <span class="op">&lt;-</span> <span class="va">ArchivoTemporal</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html">dbConnect</a></span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html">SQLite</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                               ruta <span class="op">=</span> <span class="va">file</span><span class="op">$</span><span class="va">ruta</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  finalize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html">dbDisconnect</a></span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="va">con</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db_a</span> <span class="op">&lt;-</span> <span class="va">DatabaseTemporal</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">db_b</span> <span class="op">&lt;-</span> <span class="va">DatabaseTemporal</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db_a</span><span class="op">$</span><span class="va">archivo</span><span class="op">$</span><span class="va">ruta</span> <span class="op">==</span> <span class="va">db_b</span><span class="op">$</span><span class="va">archivo</span><span class="op">$</span><span class="va">ruta</span></span>
<span><span class="co">## [1] FALSE</span></span></code></pre></div>
<p>Ahora, cada instancia de <code>DatabaseTemporal</code> tiene su propia instancia única de <code>ArchivoTemporal</code>, y por lo tanto, sus caminos de archivo son diferentes, como se espera. Esto garantiza que cada instancia de <code>DatabaseTemporal</code> tenga sus propios recursos independientes.</p>
</div>
</div>
<div id="por-qué-r6" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> ¿Por qué R6?<a class="anchor" aria-label="anchor" href="#por-qu%C3%A9-r6"><i class="fas fa-link"></i></a>
</h2>
<p>Este texto explica por qué el autor prefiere utilizar R6 en lugar de Reference Classes (RC), una sistema de programación orientada a objetos (OO) incorporado en R, debido a las siguientes razones:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Simplicidad</strong>: R6 es mucho más simple que RC. Mientras que ambos están construidos sobre entornos (<em>environments</em>), R6 utiliza el sistema S3, que es más sencillo y fácil de entender que el sistema S4 utilizado por RC.</p></li>
<li><p><strong>Documentación exhaustiva</strong>: R6 cuenta con una documentación completa en línea disponible en <a href="https://r6.r-lib.org" class="uri">https://r6.r-lib.org</a>. Esta documentación proporciona recursos detallados y ejemplos para comprender y utilizar R6 de manera efectiva.</p></li>
<li><p><strong>Subclases entre paquetes</strong>: R6 ofrece un mecanismo más simple para la subclases entre paquetes, que funciona automáticamente sin necesidad de que el usuario lo configure. Por el contrario, RC requiere más configuración y atención al detalle para lograr la misma funcionalidad.</p></li>
<li><p><strong>Separación de variables y campos</strong>: En RC, las variables y los campos se mezclan en la misma pila de entornos, lo que puede conducir a confusión y a errores potenciales. En R6, los campos se colocan en un entorno separado, lo que hace que el código sea más explícito y menos propenso a errores.</p></li>
<li><p><strong>Velocidad</strong>: R6 es mucho más rápido que RC en términos de tiempo de despacho de métodos. Aunque generalmente la velocidad de despacho de métodos no es crítica en aplicaciones del mundo real, RC es notablemente más lento, y el cambio de RC a R6 ha llevado a mejoras sustanciales de rendimiento en el paquete Shiny.</p></li>
<li><p><strong>Independencia de la versión de R</strong>: RC está ligado a una versión específica de R. Esto significa que cualquier corrección de errores en RC solo se puede aprovechar si se requiere una versión más reciente de R. Esto puede dificultar la compatibilidad entre paquetes que necesitan funcionar en diferentes versiones de R.</p></li>
</ol>
</div>
<div id="ejercicios-prácticos" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Ejercicios prácticos<a class="anchor" aria-label="anchor" href="#ejercicios-pr%C3%A1cticos"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Create a bank account R6 class that stores a balance and allows you to deposit and withdraw money. Create a subclass that throws an error if you attempt to go into overdraft. Create another subclass that allows you to go into overdraft, but charges you a fee.</li>
</ol>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CuentaBanco</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"CuentaBanco"</span>,</span>
<span>  private <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    saldo <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span>,</span>
<span>  active <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    .saldo <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">private</span><span class="op">$</span><span class="va">saldo</span></span>
<span>      <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"`$saldo` solo se puede leer NO modificar"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span>,</span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="va">saldo</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>    <span class="op">}</span>,</span>
<span>    depositar <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="va">saldo</span> <span class="op">&lt;-</span> <span class="va">private</span><span class="op">$</span><span class="va">saldo</span> <span class="op">+</span> <span class="va">x</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    retirar <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="va">saldo</span> <span class="op">=</span> <span class="va">private</span><span class="op">$</span><span class="va">saldo</span> <span class="op">-</span> <span class="va">x</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    print <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Cuenta: \n"</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"  Saldo: "</span>, <span class="va">private</span><span class="op">$</span><span class="va">saldo</span>, <span class="st">"\n"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">SubCuentaBanco1</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">'SubCuentaBanco1'</span>,</span>
<span>  inherit <span class="op">=</span> <span class="va">CuentaBanco</span>,</span>
<span>  public <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    retirar <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="st">"Existe sobregiro"</span><span class="op">=</span> <span class="va">super</span><span class="op">$</span><span class="va">.saldo</span><span class="op">-</span><span class="va">x</span><span class="op">&gt;=</span><span class="fl">0</span><span class="op">)</span></span>
<span>      <span class="va">private</span><span class="op">$</span><span class="va">saldo</span><span class="op">&lt;-</span><span class="va">super</span><span class="op">$</span><span class="fu">retirar</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">.saldo</span></span>
<span>      <span class="op">}</span></span>
<span>  <span class="op">)</span>                          </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">SubCuentaBanco2</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">'SubCuentaBanco2'</span>,</span>
<span>  inherit <span class="op">=</span> <span class="va">CuentaBanco</span>,</span>
<span>  public <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    retirar <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">super</span><span class="op">$</span><span class="va">.saldo</span><span class="op">-</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">private</span><span class="op">$</span><span class="va">saldo</span> <span class="op">&lt;-</span> <span class="va">super</span><span class="op">$</span><span class="fu">retirar</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">.saldo</span> <span class="op">-</span> <span class="fl">1</span> <span class="co">#Cargo extra 1  </span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">else</span><span class="op">{</span><span class="va">private</span><span class="op">$</span><span class="va">saldo</span> <span class="op">&lt;-</span> <span class="va">super</span><span class="op">$</span><span class="fu">retirar</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">.saldo</span><span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>  <span class="op">)</span>                          </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">Fab</span> <span class="op">&lt;-</span> <span class="va">CuentaBanco</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">Fab</span></span>
<span><span class="co">## Cuenta: </span></span>
<span><span class="co">##   Saldo: 100</span></span>
<span></span>
<span><span class="va">Fab</span><span class="op">$</span><span class="fu">retirar</span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">Fab</span></span>
<span><span class="co">## Cuenta: </span></span>
<span><span class="co">##   Saldo: 50</span></span>
<span></span>
<span><span class="va">Fab</span><span class="op">$</span><span class="fu">depositar</span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">Fab</span></span>
<span><span class="co">## Cuenta: </span></span>
<span><span class="co">##   Saldo: 60</span></span>
<span></span>
<span><span class="va">Fab2</span><span class="op">&lt;-</span><span class="va">SubCuentaBanco1</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">Fab2</span></span>
<span><span class="co">## Cuenta: </span></span>
<span><span class="co">##   Saldo: 100</span></span>
<span></span>
<span><span class="va">Fab2</span><span class="op">$</span><span class="fu">retirar</span><span class="op">(</span><span class="fl">150</span><span class="op">)</span></span>
<span><span class="co">## Error in Fab2$retirar(150): Existe sobregiro</span></span>
<span><span class="va">Fab2</span></span>
<span><span class="co">## Cuenta: </span></span>
<span><span class="co">##   Saldo: 100</span></span>
<span></span>
<span><span class="va">Fab3</span> <span class="op">&lt;-</span> <span class="va">SubCuentaBanco2</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">Fab3</span></span>
<span><span class="co">## Cuenta: </span></span>
<span><span class="co">##   Saldo: 100</span></span>
<span></span>
<span><span class="va">Fab3</span><span class="op">$</span><span class="fu">retirar</span><span class="op">(</span><span class="fl">150</span><span class="op">)</span></span>
<span><span class="va">Fab3</span></span>
<span><span class="co">## Cuenta: </span></span>
<span><span class="co">##   Saldo: -51</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Create an R6 class that represents a shuffled deck of cards. You should be able to draw cards from the deck with <code>$draw(n)</code>, and return all cards to the deck and reshuffle with <code>$reshuffle()</code>. Use the following code to make a vector of cards.</li>
</ol>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r6.r-lib.org">R6</a></span><span class="op">)</span></span>
<span><span class="va">cartas</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">'cartas'</span>,</span>
<span>  private <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    suit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"♠"</span>, <span class="st">"♥"</span>, <span class="st">"♦"</span>, <span class="st">"♣"</span><span class="op">)</span>,</span>
<span>    val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="st">"J"</span>, <span class="st">"Q"</span>, <span class="st">"K"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,                </span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    cards <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="st">"J"</span>, <span class="st">"Q"</span>, <span class="st">"K"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"♠"</span>, <span class="st">"♥"</span>, <span class="st">"♦"</span>, <span class="st">"♣"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    drawn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">self</span><span class="op">$</span><span class="va">cards</span> <span class="op">&lt;-</span> <span class="va">self</span><span class="op">$</span><span class="va">cards</span><span class="op">[</span><span class="op">-</span><span class="va">n</span><span class="op">]</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    reshuffle<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">copy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">private</span><span class="op">$</span><span class="va">val</span>, <span class="fl">4</span><span class="op">)</span>, <span class="va">private</span><span class="op">$</span><span class="va">suit</span><span class="op">)</span></span>
<span>      <span class="va">x</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">52</span><span class="op">)</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">52</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">self</span><span class="op">$</span><span class="va">cards</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">copy</span><span class="op">[</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span>,</span>
<span>  active<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    .cartas<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">self</span><span class="op">$</span><span class="va">cards</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="kw">else</span><span class="op">{</span><span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"`Cartas` solo se puede leer NO modificar"</span>, </span>
<span>                call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">mazo</span><span class="op">&lt;-</span><span class="va">cartas</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mazo</span><span class="op">$</span><span class="va">.cartas</span></span>
<span><span class="co">##  [1] "A♠"  "2♥"  "3♦"  "4♣"  "5♠"  "6♥"  "7♦"  "8♣"  "9♠"  "10♥" "J♦"  "Q♣" </span></span>
<span><span class="co">## [13] "K♠"  "A♥"  "2♦"  "3♣"  "4♠"  "5♥"  "6♦"  "7♣"  "8♠"  "9♥"  "10♦" "J♣" </span></span>
<span><span class="co">## [25] "Q♠"  "K♥"  "A♦"  "2♣"  "3♠"  "4♥"  "5♦"  "6♣"  "7♠"  "8♥"  "9♦"  "10♣"</span></span>
<span><span class="co">## [37] "J♠"  "Q♥"  "K♦"  "A♣"  "2♠"  "3♥"  "4♦"  "5♣"  "6♠"  "7♥"  "8♦"  "9♣" </span></span>
<span><span class="co">## [49] "10♠" "J♥"  "Q♦"  "K♣"</span></span>
<span><span class="va">mazo</span><span class="op">$</span><span class="fu">drawn</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mazo</span><span class="op">$</span><span class="va">.cartas</span></span>
<span><span class="co">##  [1] "2♥"  "3♦"  "4♣"  "5♠"  "6♥"  "7♦"  "8♣"  "9♠"  "10♥" "J♦"  "Q♣"  "K♠" </span></span>
<span><span class="co">## [13] "A♥"  "2♦"  "3♣"  "4♠"  "5♥"  "6♦"  "7♣"  "8♠"  "9♥"  "10♦" "J♣"  "Q♠" </span></span>
<span><span class="co">## [25] "K♥"  "A♦"  "2♣"  "3♠"  "4♥"  "5♦"  "6♣"  "7♠"  "8♥"  "9♦"  "10♣" "J♠" </span></span>
<span><span class="co">## [37] "Q♥"  "K♦"  "A♣"  "2♠"  "3♥"  "4♦"  "5♣"  "6♠"  "7♥"  "8♦"  "9♣"  "10♠"</span></span>
<span><span class="co">## [49] "J♥"  "Q♦"  "K♣"</span></span>
<span><span class="va">mazo</span><span class="op">$</span><span class="fu">reshuffle</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mazo</span><span class="op">$</span><span class="va">.cartas</span></span>
<span><span class="co">##  [1] "6♦"  "2♥"  "10♦" "9♣"  "5♣"  "6♣"  "Q♦"  "8♥"  "7♣"  "9♦"  "3♥"  "5♥" </span></span>
<span><span class="co">## [13] "3♣"  "3♠"  "4♦"  "6♥"  "9♠"  "4♣"  "K♦"  "Q♣"  "9♥"  "A♣"  "3♦"  "K♠" </span></span>
<span><span class="co">## [25] "10♥" "4♠"  "Q♥"  "7♥"  "A♠"  "J♣"  "7♦"  "8♦"  "K♥"  "2♣"  "K♣"  "7♠" </span></span>
<span><span class="co">## [37] "2♦"  "10♠" "J♠"  "J♥"  "2♠"  "10♣" "A♦"  "A♥"  "4♥"  "J♦"  "5♦"  "8♣" </span></span>
<span><span class="co">## [49] "Q♠"  "5♠"  "8♠"  "6♠"</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Create an R6 class that allows you to get and set the current time zone. You can access the current time zone with <code><a href="https://rdrr.io/r/base/timezones.html">Sys.timezone()</a></code> and set it with <code>Sys.setenv(TZ = "newtimezone")</code>. When setting the time zone, make sure the new time zone is in the list provided by <code><a href="https://rdrr.io/r/base/timezones.html">OlsonNames()</a></code>.</li>
</ol>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ZonaHoraria</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">'ZonaHoraria'</span>,</span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    zona <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/timezones.html">Sys.timezone</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  cambiar_zona<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="st">"No existe esa zona horaria"</span> <span class="op">=</span> <span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/timezones.html">OlsonNames</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span>    <span class="va">self</span><span class="op">$</span><span class="va">zona</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span><span class="op">(</span>TZ <span class="op">=</span> <span class="va">name</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zona</span> <span class="op">&lt;-</span> <span class="va">ZonaHoraria</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">zona</span><span class="op">$</span><span class="fu">cambiar_zona</span><span class="op">(</span><span class="st">'America/Guayaquil'</span><span class="op">)</span></span>
<span><span class="va">zona</span></span>
<span><span class="co">## &lt;ZonaHoraria&gt;</span></span>
<span><span class="co">##   Public:</span></span>
<span><span class="co">##     cambiar_zona: function (name) </span></span>
<span><span class="co">##     clone: function (deep = FALSE) </span></span>
<span><span class="co">##     zona: TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/timezones.html">Sys.timezone</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## [1] "America/Guayaquil"</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Create an R6 class that manages the current working directory. It should have <code>$get()</code> and <code>$set()</code> methods.</li>
</ol>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Directorio</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">'Directorio'</span>,</span>
<span>  public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    get<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    set<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">path</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="va">self</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">direct</span> <span class="op">&lt;-</span> <span class="va">Directorio</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">direct</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## [1] "D:/OneDrive - Escuela Politécnica Nacional/PasantiasUDC/Libro_TidyQualityTools"</span></span>
<span><span class="va">direct</span><span class="op">$</span><span class="fu">set</span><span class="op">(</span><span class="st">"C:/Users/Dell/OneDrive - Escuela Politécnica Nacional/Pasantías UDC"</span><span class="op">)</span></span>
<span><span class="co">## Error in setwd(path): no es posible cambiar el directorio de trabajo</span></span>
<span><span class="va">direct</span><span class="op">$</span><span class="fu">get</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## [1] "D:/OneDrive - Escuela Politécnica Nacional/PasantiasUDC/Libro_TidyQualityTools"</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Create a class with a write-only <code>$password</code> field. It should have <code>$check_password(password)</code> method that returns <code>TRUE</code> or <code>FALSE</code>, but there should be no way to view the complete password.</li>
</ol>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("R6")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r6.r-lib.org">R6</a></span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">Bank_writeonly</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"Bank_writeonly"</span>, </span>
<span>      private <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>            user <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>            password <span class="op">=</span> <span class="cn">NULL</span></span>
<span>      <span class="op">)</span>,</span>
<span>      active <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>        .password <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"`$.password` solo permite cambiar tu contraseña, NO verla"</span>,</span>
<span>                 call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>          <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>            <span class="va">private</span><span class="op">$</span><span class="va">password</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Contraseña cambiada con éxito"</span><span class="op">)</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">)</span>,</span>
<span>      public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>            initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">.user</span>, <span class="va">.password</span><span class="op">)</span><span class="op">{</span></span>
<span>              <span class="va">private</span><span class="op">$</span><span class="va">password</span> <span class="op">&lt;-</span> <span class="va">.password</span></span>
<span>              <span class="va">private</span><span class="op">$</span><span class="va">user</span> <span class="op">&lt;-</span> <span class="va">.user</span></span>
<span>              <span class="op">}</span>,</span>
<span>            check_password <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">{</span></span>
<span>              <span class="kw">if</span><span class="op">(</span><span class="va">private</span><span class="op">$</span><span class="va">password</span> <span class="op">==</span> <span class="va">p</span><span class="op">)</span><span class="op">{</span> </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Tu contraseña SI coincide con la ingresada"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">}</span></span>
<span>              <span class="kw">else</span><span class="op">{</span></span>
<span>                <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Tu contraseña NO coincide con la ingresada"</span><span class="op">)</span><span class="op">}</span></span>
<span>              <span class="op">}</span>,</span>
<span>            print <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Bienvenido al Banco \n"</span><span class="op">)</span></span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"Tu cuenta se ha creado con el nombre de usuario:"</span>, <span class="va">private</span><span class="op">$</span><span class="va">user</span><span class="op">)</span></span>
<span>            <span class="op">}</span></span>
<span>      <span class="op">)</span></span>
<span>      </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prueba</span></span>
<span></span>
<span><span class="va">Cuenta_Andrea</span> <span class="op">&lt;-</span> <span class="va">Bank_writeonly</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="st">"AndreaBC"</span>, <span class="st">"prueba123"</span><span class="op">)</span></span>
<span><span class="co"># Print</span></span>
<span><span class="va">Cuenta_Andrea</span></span>
<span><span class="co">## Bienvenido al Banco </span></span>
<span><span class="co">## Tu cuenta se ha creado con el nombre de usuario: AndreaBC</span></span>
<span><span class="co"># Funcion Check_password</span></span>
<span><span class="va">Cuenta_Andrea</span><span class="op">$</span><span class="fu">check_password</span><span class="op">(</span><span class="st">"Nomeacuerdomicontraseña"</span><span class="op">)</span></span>
<span><span class="co">## Error in Cuenta_Andrea$check_password("Nomeacuerdomicontraseña"): Tu contraseña NO coincide con la ingresada</span></span>
<span><span class="va">Cuenta_Andrea</span><span class="op">$</span><span class="fu">check_password</span><span class="op">(</span><span class="st">"prueba123"</span><span class="op">)</span></span>
<span><span class="co">## Tu contraseña SI coincide con la ingresada FALSE</span></span>
<span><span class="co"># .password</span></span>
<span><span class="va">Cuenta_Andrea</span><span class="op">$</span><span class="va">.password</span></span>
<span><span class="co">## Error: `$.password` solo permite cambiar tu contraseña, NO verla</span></span>
<span><span class="va">Cuenta_Andrea</span><span class="op">$</span><span class="va">.password</span> <span class="op">&lt;-</span> <span class="st">"NuevaContraseña"</span></span>
<span><span class="co">## Contraseña cambiada con éxito</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Extend the Rando class with another active binding that allows you to access the previous random <code>value.</code> Ensure that active binding is the only way to access the value.</li>
</ol>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Rando</span> <span class="op">&lt;-</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html">R6Class</a></span><span class="op">(</span><span class="st">"Rando"</span>, </span>
<span>    private <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>prev <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>,</span>
<span>    active <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      random <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">private</span><span class="op">$</span><span class="va">prev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>          <span class="va">private</span><span class="op">$</span><span class="va">prev</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>          <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Can't set `$random`"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span>,</span>
<span>      previous <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">value</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/missing.html">missing</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">private</span><span class="op">$</span><span class="va">prev</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>          <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Can't set `$random`"</span>, call. <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">Rando</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">random</span></span>
<span><span class="co">## [1] 0.8139877</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">random</span></span>
<span><span class="co">## [1] 0.4313831</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">previous</span></span>
<span><span class="co">## [1] 0.4313831</span></span></code></pre></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="poo-programaci%C3%B3n-orientada-a-objetos.html"><span class="header-section-number">2</span> (POO) Programación Orientada a Objetos</a></div>
<div class="next"><a href="tidyquant.html"><span class="header-section-number">4</span> TidyQuant</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#r6"><span class="header-section-number">3</span> R6</a></li>
<li>
<a class="nav-link" href="#clases-y-m%C3%A9todos"><span class="header-section-number">3.1</span> Clases y métodos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#encadenamiento-de-m%C3%A9todos"><span class="header-section-number">3.1.1</span> Encadenamiento de métodos</a></li>
<li><a class="nav-link" href="#m%C3%A9todos-importantes"><span class="header-section-number">3.1.2</span> Métodos importantes</a></li>
<li><a class="nav-link" href="#agregar-m%C3%A9todos-despu%C3%A9s-de-la-creaci%C3%B3n"><span class="header-section-number">3.1.3</span> Agregar métodos después de la creación</a></li>
<li><a class="nav-link" href="#herencia"><span class="header-section-number">3.1.4</span> Herencia</a></li>
<li><a class="nav-link" href="#introspecci%C3%B3n"><span class="header-section-number">3.1.5</span> Introspección</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#controles-de-acceso"><span class="header-section-number">3.2</span> Controles de Acceso</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#privacidad"><span class="header-section-number">3.2.1</span> Privacidad</a></li>
<li><a class="nav-link" href="#campos-activos"><span class="header-section-number">3.2.2</span> Campos Activos</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#sem%C3%A1ntica-de-referencia"><span class="header-section-number">3.3</span> Semántica de referencia</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#razonamientos"><span class="header-section-number">3.3.1</span> Razonamientos</a></li>
<li><a class="nav-link" href="#finalizaci%C3%B3n"><span class="header-section-number">3.3.2</span> Finalización</a></li>
<li><a class="nav-link" href="#campos-en-r6"><span class="header-section-number">3.3.3</span> Campos en R6</a></li>
</ul>
</li>
<li><a class="nav-link" href="#por-qu%C3%A9-r6"><span class="header-section-number">3.4</span> ¿Por qué R6?</a></li>
<li><a class="nav-link" href="#ejercicios-pr%C3%A1cticos"><span class="header-section-number">3.5</span> Ejercicios prácticos</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Integración del Paquete QualityTools con Tidyverse</strong>" was written by Miguel Flores, Andrea Barahona, Fabián Encarnación, Dario Quishpe. It was last built on 2024-05-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
