<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 6 Cambio de Funciones | Integración del Paquete QualityTools con Tidyverse</title>
  <meta name="description" content="Capítulo 6 Cambio de Funciones | Integración del Paquete QualityTools con Tidyverse" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 6 Cambio de Funciones | Integración del Paquete QualityTools con Tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="rstudio/Libro_TidyQualityTools" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 6 Cambio de Funciones | Integración del Paquete QualityTools con Tidyverse" />
  
  
  

<meta name="author" content="Miguel Flores" />
<meta name="author" content="Andrea Barahona" />
<meta name="author" content="Fabián Encarnación" />
<meta name="author" content="Dario Quishpe" />


<meta name="date" content="2024-05-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="qualitytools.html"/>
<link rel="next" href="referencias.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">UDC</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preámbulo</a></li>
<li class="chapter" data-level="2" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html"><i class="fa fa-check"></i><b>2</b> (POO) Programación Orientada a Objetos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html#introducción"><i class="fa fa-check"></i><b>2.1</b> Introducción</a></li>
<li class="chapter" data-level="2.2" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html#sistemas-de-programación-orientada-a-objetos"><i class="fa fa-check"></i><b>2.2</b> Sistemas de programación orientada a objetos</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html#paradigmas"><i class="fa fa-check"></i><b>2.2.1</b> Paradigmas</a></li>
<li class="chapter" data-level="2.2.2" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html#especificaciones-de-los-principales-sistemas-poo-en-r"><i class="fa fa-check"></i><b>2.2.2</b> Especificaciones de los principales sistemas POO en R</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html#tipos-de-objetos"><i class="fa fa-check"></i><b>2.3</b> Tipos de objetos</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="poo-programación-orientada-a-objetos.html"><a href="poo-programación-orientada-a-objetos.html#objetos-base-vs-objetos-oo"><i class="fa fa-check"></i><b>2.3.1</b> Objetos Base vs Objetos OO</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r6.html"><a href="r6.html"><i class="fa fa-check"></i><b>3</b> R6</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r6.html"><a href="r6.html#clases-y-métodos"><i class="fa fa-check"></i><b>3.1</b> Clases y métodos</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="r6.html"><a href="r6.html#encadenamiento-de-métodos"><i class="fa fa-check"></i><b>3.1.1</b> Encadenamiento de métodos</a></li>
<li class="chapter" data-level="3.1.2" data-path="r6.html"><a href="r6.html#métodos-importantes"><i class="fa fa-check"></i><b>3.1.2</b> Métodos importantes</a></li>
<li class="chapter" data-level="3.1.3" data-path="r6.html"><a href="r6.html#agregar-métodos-después-de-la-creación"><i class="fa fa-check"></i><b>3.1.3</b> Agregar métodos después de la creación</a></li>
<li class="chapter" data-level="3.1.4" data-path="r6.html"><a href="r6.html#herencia"><i class="fa fa-check"></i><b>3.1.4</b> Herencia</a></li>
<li class="chapter" data-level="3.1.5" data-path="r6.html"><a href="r6.html#introspección"><i class="fa fa-check"></i><b>3.1.5</b> Introspección</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="r6.html"><a href="r6.html#controles-de-acceso"><i class="fa fa-check"></i><b>3.2</b> Controles de Acceso</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="r6.html"><a href="r6.html#privacidad"><i class="fa fa-check"></i><b>3.2.1</b> Privacidad</a></li>
<li class="chapter" data-level="3.2.2" data-path="r6.html"><a href="r6.html#campos-activos"><i class="fa fa-check"></i><b>3.2.2</b> Campos Activos</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="r6.html"><a href="r6.html#semántica-de-referencia"><i class="fa fa-check"></i><b>3.3</b> Semántica de referencia</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="r6.html"><a href="r6.html#razonamientos"><i class="fa fa-check"></i><b>3.3.1</b> Razonamientos</a></li>
<li class="chapter" data-level="3.3.2" data-path="r6.html"><a href="r6.html#finalización"><i class="fa fa-check"></i><b>3.3.2</b> Finalización</a></li>
<li class="chapter" data-level="3.3.3" data-path="r6.html"><a href="r6.html#campos-en-r6"><i class="fa fa-check"></i><b>3.3.3</b> Campos en R6</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="r6.html"><a href="r6.html#por-qué-r6"><i class="fa fa-check"></i><b>3.4</b> ¿Por qué R6?</a></li>
<li class="chapter" data-level="3.5" data-path="r6.html"><a href="r6.html#ejercicios-prácticos"><i class="fa fa-check"></i><b>3.5</b> Ejercicios prácticos</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidyquant.html"><a href="tidyquant.html"><i class="fa fa-check"></i><b>4</b> TidyQuant</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidyquant.html"><a href="tidyquant.html#compatibilidad-de-funciones"><i class="fa fa-check"></i><b>4.1</b> Compatibilidad de funciones</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="tidyquant.html"><a href="tidyquant.html#funcionalidad-zoo"><i class="fa fa-check"></i><b>4.1.1</b> Funcionalidad zoo</a></li>
<li class="chapter" data-level="4.1.2" data-path="tidyquant.html"><a href="tidyquant.html#funcionalidad-xts"><i class="fa fa-check"></i><b>4.1.2</b> Funcionalidad xts</a></li>
<li class="chapter" data-level="4.1.3" data-path="tidyquant.html"><a href="tidyquant.html#funcionalidad-quantmod"><i class="fa fa-check"></i><b>4.1.3</b> Funcionalidad quantmod</a></li>
<li class="chapter" data-level="4.1.4" data-path="tidyquant.html"><a href="tidyquant.html#funcionalidad-ttr"><i class="fa fa-check"></i><b>4.1.4</b> Funcionalidad TTR</a></li>
<li class="chapter" data-level="4.1.5" data-path="tidyquant.html"><a href="tidyquant.html#funcionalidad-performanceanalytics"><i class="fa fa-check"></i><b>4.1.5</b> Funcionalidad PerformanceAnalytics</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tidyquant.html"><a href="tidyquant.html#poder-cuantitativo-en-acción"><i class="fa fa-check"></i><b>4.2</b> Poder Cuantitativo en Acción</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-1-utilizar-quantmod-periodreturn-para-convertir-precios-en-rentabilidad"><i class="fa fa-check"></i><b>4.2.1</b> Ejemplo 1: utilizar quantmod periodReturn para convertir precios en rentabilidad</a></li>
<li class="chapter" data-level="4.2.2" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-2-utilice-xts-to.period-para-cambiar-la-periodicidad-de-diaria-a-mensual"><i class="fa fa-check"></i><b>4.2.2</b> Ejemplo 2: utilice xts to.period para cambiar la periodicidad de diaria a mensual</a></li>
<li class="chapter" data-level="4.2.3" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-3-utilice-ttr-runcor-para-visualizar-correlaciones-continuas-de-rendimientos"><i class="fa fa-check"></i><b>4.2.3</b> Ejemplo 3: utilice TTR runCor para visualizar correlaciones continuas de rendimientos</a></li>
<li class="chapter" data-level="4.2.4" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-4-utilizar-ttrmacd-para-visualizar-la-divergencia-y-convergencia-de-la-media-móvil"><i class="fa fa-check"></i><b>4.2.4</b> Ejemplo 4: utilizar TTR::MACD para visualizar la divergencia y convergencia de la media móvil</a></li>
<li class="chapter" data-level="4.2.5" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-5-utilizar-xtsapply.quarterly-para-obtener-el-precio-máximo-y-mínimo-para-cada-trimestre"><i class="fa fa-check"></i><b>4.2.5</b> Ejemplo 5: utilizar xts::apply.quarterly para obtener el precio máximo y mínimo para cada trimestre</a></li>
<li class="chapter" data-level="4.2.6" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-6-utilizar-zoorollapply-para-visualizar-una-regresión-continua"><i class="fa fa-check"></i><b>4.2.6</b> Ejemplo 6: utilizar zoo::rollapply para visualizar una regresión continua</a></li>
<li class="chapter" data-level="4.2.7" data-path="tidyquant.html"><a href="tidyquant.html#ejemplo-7-utilizar-return.clean-y-return.excess-para-limpiar-y-calcular-el-exceso-de-rendimiento"><i class="fa fa-check"></i><b>4.2.7</b> Ejemplo 7: utilizar return.clean y return.excess para limpiar y calcular el exceso de rendimiento</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="qualitytools.html"><a href="qualitytools.html"><i class="fa fa-check"></i><b>5</b> QualityTools</a>
<ul>
<li class="chapter" data-level="5.1" data-path="qualitytools.html"><a href="qualitytools.html#fase-1-definir"><i class="fa fa-check"></i><b>5.1</b> Fase 1: Definir</a></li>
<li class="chapter" data-level="5.2" data-path="qualitytools.html"><a href="qualitytools.html#fase-2-medir"><i class="fa fa-check"></i><b>5.2</b> Fase 2: Medir</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="qualitytools.html"><a href="qualitytools.html#capacidad-de-calibre---msa-tipo-i"><i class="fa fa-check"></i><b>5.2.1</b> Capacidad de calibre - MSA Tipo I</a></li>
<li class="chapter" data-level="5.2.2" data-path="qualitytools.html"><a href="qualitytools.html#repetibilidad-y-reproducibidad-del-calibre---msa-tipo-ii"><i class="fa fa-check"></i><b>5.2.2</b> Repetibilidad y reproducibidad del calibre - MSA Tipo II</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="qualitytools.html"><a href="qualitytools.html#fase-3-analizar"><i class="fa fa-check"></i><b>5.3</b> Fase 3: Analizar</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="qualitytools.html"><a href="qualitytools.html#capacidad-del-proceso"><i class="fa fa-check"></i><b>5.3.1</b> Capacidad del Proceso</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="qualitytools.html"><a href="qualitytools.html#fase-4-mejorar"><i class="fa fa-check"></i><b>5.4</b> Fase 4: Mejorar</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="qualitytools.html"><a href="qualitytools.html#diseños-factoriales-2k"><i class="fa fa-check"></i><b>5.4.1</b> Diseños factoriales <span class="math inline">\(2^{k}\)</span></a></li>
<li class="chapter" data-level="5.4.2" data-path="qualitytools.html"><a href="qualitytools.html#diseños-factoriales-fraccionarios-2k-p"><i class="fa fa-check"></i><b>5.4.2</b> Diseños factoriales fraccionarios <span class="math inline">\(2^{k-p}\)</span></a></li>
<li class="chapter" data-level="5.4.3" data-path="qualitytools.html"><a href="qualitytools.html#diseños-replicados-y-puntos-centrales"><i class="fa fa-check"></i><b>5.4.3</b> Diseños replicados y puntos centrales</a></li>
<li class="chapter" data-level="5.4.4" data-path="qualitytools.html"><a href="qualitytools.html#respuestas-múltiples"><i class="fa fa-check"></i><b>5.4.4</b> Respuestas múltiples</a></li>
<li class="chapter" data-level="5.4.5" data-path="qualitytools.html"><a href="qualitytools.html#pasar-a-un-entorno-de-proceso-con-un-mayor-rendimiento-esperado"><i class="fa fa-check"></i><b>5.4.5</b> Pasar a un entorno de proceso con un mayor rendimiento esperado</a></li>
<li class="chapter" data-level="5.4.6" data-path="qualitytools.html"><a href="qualitytools.html#diseños-de-superficies-de-respuesta"><i class="fa fa-check"></i><b>5.4.6</b> Diseños de superficies de respuesta</a></li>
<li class="chapter" data-level="5.4.7" data-path="qualitytools.html"><a href="qualitytools.html#deseabilidades"><i class="fa fa-check"></i><b>5.4.7</b> Deseabilidades</a></li>
<li class="chapter" data-level="5.4.8" data-path="qualitytools.html"><a href="qualitytools.html#utilización-de-deseabilidades-junto-con-experimentos-diseñados"><i class="fa fa-check"></i><b>5.4.8</b> Utilización de deseabilidades junto con experimentos diseñados</a></li>
<li class="chapter" data-level="5.4.9" data-path="qualitytools.html"><a href="qualitytools.html#diseños-de-mezclas"><i class="fa fa-check"></i><b>5.4.9</b> Diseños de mezclas</a></li>
<li class="chapter" data-level="5.4.10" data-path="qualitytools.html"><a href="qualitytools.html#diseños-taguchi"><i class="fa fa-check"></i><b>5.4.10</b> Diseños Taguchi</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="cambio-de-funciones.html"><a href="cambio-de-funciones.html"><i class="fa fa-check"></i><b>6</b> Cambio de Funciones</a>
<ul>
<li class="chapter" data-level="6.1" data-path="cambio-de-funciones.html"><a href="cambio-de-funciones.html#fase-1-definir-1"><i class="fa fa-check"></i><b>6.1</b> Fase 1: Definir</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="cambio-de-funciones.html"><a href="cambio-de-funciones.html#función-pareto"><i class="fa fa-check"></i><b>6.1.1</b> 1. Función Pareto</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="cambio-de-funciones.html"><a href="cambio-de-funciones.html#fase-2-medir-1"><i class="fa fa-check"></i><b>6.2</b> Fase 2: Medir</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="cambio-de-funciones.html"><a href="cambio-de-funciones.html#función-cg"><i class="fa fa-check"></i><b>6.2.1</b> 1. Función cg</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="cambio-de-funciones.html"><a href="cambio-de-funciones.html#fase-3-analizar-1"><i class="fa fa-check"></i><b>6.3</b> Fase 3: Analizar</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="cambio-de-funciones.html"><a href="cambio-de-funciones.html#función-gagerrdesign-y-gagerr_-modificadas-para-trabajar-con-objetos-r6"><i class="fa fa-check"></i><b>6.3.1</b> Función gageRRDesign y gageRR_ modificadas para trabajar con objetos R6</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Integración del Paquete QualityTools con Tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cambio-de-funciones" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Capítulo 6</span> Cambio de Funciones<a href="cambio-de-funciones.html#cambio-de-funciones" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<style type="text/css">
.scroll-100 {
  max-height: 100px;
  overflow-y: auto;
  background-color: inherit;
}
</style>
<div id="fase-1-definir-1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Fase 1: Definir<a href="cambio-de-funciones.html#fase-1-definir-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="función-pareto" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> 1. Función Pareto<a href="cambio-de-funciones.html#función-pareto" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Resultados antes:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="cambio-de-funciones.html#cb1-1" tabindex="-1"></a>defectos <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;E&quot;</span>,<span class="dv">62</span>),<span class="fu">rep</span>(<span class="st">&quot;B&quot;</span>,<span class="dv">15</span>),<span class="fu">rep</span>(<span class="st">&quot;F&quot;</span>,<span class="dv">3</span>),<span class="fu">rep</span>(<span class="st">&quot;A&quot;</span>,<span class="dv">10</span>),<span class="fu">rep</span>(<span class="st">&quot;C&quot;</span>,<span class="dv">20</span>),<span class="fu">rep</span>(<span class="st">&quot;D&quot;</span>,<span class="dv">10</span>))</span>
<span id="cb1-2"><a href="cambio-de-funciones.html#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="cambio-de-funciones.html#cb1-3" tabindex="-1"></a>qualityTools<span class="sc">::</span><span class="fu">paretoChart</span>(defectos)</span></code></pre></div>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<pre><code>##                                                     
## Frequency          62    20    15    10    10      3
## Cum. Frequency     62    82    97   107   117    120
## Percentage      51.7% 16.7% 12.5%  8.3%  8.3%   2.5%
## Cum. Percentage 51.7% 68.3% 80.8% 89.2% 97.5% 100.0%</code></pre>
<pre><code>##                                                                       
## Frequency       62.00000 20.00000 15.00000  10.000000  10.000000   3.0
## Cum. Frequency  62.00000 82.00000 97.00000 107.000000 117.000000 120.0
## Percentage      51.66667 16.66667 12.50000   8.333333   8.333333   2.5
## Cum. Percentage 51.66667 68.33333 80.83333  89.166667  97.500000 100.0</code></pre>
<ul>
<li>Resultados ahora:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="cambio-de-funciones.html#cb4-1" tabindex="-1"></a><span class="fu">ParetoChart_</span>(defectos)</span></code></pre></div>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Podemos utilizar parámetros para mostrar la tabla o la gráfica:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="cambio-de-funciones.html#cb5-1" tabindex="-1"></a><span class="co"># Mostrar solo la gráfica</span></span>
<span id="cb5-2"><a href="cambio-de-funciones.html#cb5-2" tabindex="-1"></a><span class="fu">ParetoChart_</span>(defectos, <span class="at">showTable =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="cambio-de-funciones.html#cb6-1" tabindex="-1"></a><span class="co"># Mostrar solo la tabla</span></span>
<span id="cb6-2"><a href="cambio-de-funciones.html#cb6-2" tabindex="-1"></a><span class="fu">ParetoChart_</span>(defectos, <span class="at">showPlot =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>##                    E     C     B      A      D     F
## Frequency      62.00 20.00 15.00  10.00  10.00   3.0
## Cum.Frequency  62.00 82.00 97.00 107.00 117.00 120.0
## Percentage     51.67 16.67 12.50   8.33   8.33   2.5
## Cum.Percentage 51.67 68.33 80.83  89.17  97.50 100.0</code></pre>
<p>Podemos cambiar los colores de los puntos y las barras:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="cambio-de-funciones.html#cb8-1" tabindex="-1"></a><span class="fu">ParetoChart_</span>(defectos, <span class="at">col=</span><span class="st">&#39;blue&#39;</span>, <span class="at">border=</span><span class="st">&#39;green&#39;</span>)</span></code></pre></div>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
</div>
<div id="fase-2-medir-1" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Fase 2: Medir<a href="cambio-de-funciones.html#fase-2-medir-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="función-cg" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> 1. Función cg<a href="cambio-de-funciones.html#función-cg" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para poder implementar esta función, primero debemos modificar 3 funciones que se utilizan en esta función macro.</p>
<p>Además utilizaremos los siguientes datos de pruebas:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="cambio-de-funciones.html#cb9-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">9.991</span>, <span class="fl">10.013</span>, <span class="fl">10.001</span>, <span class="fl">10.007</span>, <span class="fl">10.010</span>, <span class="fl">10.013</span>, <span class="fl">10.008</span>, <span class="fl">10.017</span>, <span class="fl">10.005</span>, <span class="fl">10.005</span>, <span class="fl">10.002</span>, <span class="fl">10.017</span>, <span class="fl">10.005</span>, <span class="fl">10.002</span>, <span class="fl">9.996</span>, <span class="fl">10.011</span>, <span class="fl">10.009</span>, <span class="fl">10.006</span>, <span class="fl">10.008</span>, <span class="fl">10.003</span>, <span class="fl">10.002</span>, <span class="fl">10.006</span>, <span class="fl">10.010</span>, <span class="fl">9.992</span>, <span class="fl">10.013</span>)</span>
<span id="cb9-2"><a href="cambio-de-funciones.html#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="cambio-de-funciones.html#cb9-3" tabindex="-1"></a>target <span class="ot">=</span> <span class="fl">10.003</span></span>
<span id="cb9-4"><a href="cambio-de-funciones.html#cb9-4" tabindex="-1"></a>tolerance <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">9.903</span>, <span class="fl">10.103</span>)</span>
<span id="cb9-5"><a href="cambio-de-funciones.html#cb9-5" tabindex="-1"></a>ref.interval <span class="ot">=</span> <span class="fu">pnorm</span>(<span class="dv">3</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">3</span>)</span>
<span id="cb9-6"><a href="cambio-de-funciones.html#cb9-6" tabindex="-1"></a>facCg <span class="ot">=</span> <span class="fl">0.2</span></span>
<span id="cb9-7"><a href="cambio-de-funciones.html#cb9-7" tabindex="-1"></a>facCgk <span class="ot">=</span> <span class="fl">0.1</span> </span>
<span id="cb9-8"><a href="cambio-de-funciones.html#cb9-8" tabindex="-1"></a>n <span class="ot">=</span> <span class="fl">0.2</span></span>
<span id="cb9-9"><a href="cambio-de-funciones.html#cb9-9" tabindex="-1"></a>type <span class="ot">=</span> <span class="st">&quot;b&quot;</span></span>
<span id="cb9-10"><a href="cambio-de-funciones.html#cb9-10" tabindex="-1"></a>col <span class="ot">=</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb9-11"><a href="cambio-de-funciones.html#cb9-11" tabindex="-1"></a>pch <span class="ot">=</span> <span class="dv">19</span></span>
<span id="cb9-12"><a href="cambio-de-funciones.html#cb9-12" tabindex="-1"></a><span class="co">#xlim = NULL</span></span>
<span id="cb9-13"><a href="cambio-de-funciones.html#cb9-13" tabindex="-1"></a><span class="co">#ylim = NULL</span></span>
<span id="cb9-14"><a href="cambio-de-funciones.html#cb9-14" tabindex="-1"></a>conf.level <span class="ot">=</span> <span class="fl">0.95</span></span>
<span id="cb9-15"><a href="cambio-de-funciones.html#cb9-15" tabindex="-1"></a>cex.val <span class="ot">=</span> <span class="fl">1.5</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="cambio-de-funciones.html#cb10-1" tabindex="-1"></a>sd <span class="ot">=</span> <span class="fu">sd</span>(x)</span>
<span id="cb10-2"><a href="cambio-de-funciones.html#cb10-2" tabindex="-1"></a>mean <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="cb10-3"><a href="cambio-de-funciones.html#cb10-3" tabindex="-1"></a>ref.ar <span class="ot">=</span> <span class="fu">qnorm</span>(ref.interval, mean, sd) <span class="sc">-</span> <span class="fu">qnorm</span>(<span class="dv">1</span> <span class="sc">-</span> ref.interval,mean, sd)</span>
<span id="cb10-4"><a href="cambio-de-funciones.html#cb10-4" tabindex="-1"></a>quant1 <span class="ot">=</span> <span class="fu">qnorm</span>((<span class="dv">1</span> <span class="sc">-</span> ref.interval)<span class="sc">/</span><span class="dv">2</span>, mean, sd)</span>
<span id="cb10-5"><a href="cambio-de-funciones.html#cb10-5" tabindex="-1"></a>quant2 <span class="ot">=</span> <span class="fu">qnorm</span>(ref.interval <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> ref.interval)<span class="sc">/</span><span class="dv">2</span>, mean,sd)</span>
<span id="cb10-6"><a href="cambio-de-funciones.html#cb10-6" tabindex="-1"></a>xlim <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">length</span>(x))</span>
<span id="cb10-7"><a href="cambio-de-funciones.html#cb10-7" tabindex="-1"></a>ylim <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">min</span>(x, target <span class="sc">-</span> n<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> (<span class="fu">abs</span>(<span class="fu">diff</span>(tolerance))), quant1, quant2),</span>
<span id="cb10-8"><a href="cambio-de-funciones.html#cb10-8" tabindex="-1"></a>         <span class="fu">max</span>(x, target <span class="sc">+</span> n<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> (<span class="fu">abs</span>(<span class="fu">diff</span>(tolerance))), quant1, quant2))</span></code></pre></div>
<div id="cgrunchart" class="section level4 hasAnchor" number="6.2.1.1">
<h4><span class="header-section-number">6.2.1.1</span> CgRunChart<a href="cambio-de-funciones.html#cgrunchart" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Resultados antes:</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="cambio-de-funciones.html#cb11-1" tabindex="-1"></a>qualityTools<span class="sc">::</span><span class="fu">cgRunChart</span>(<span class="at">x =</span> x, <span class="at">target =</span> target, <span class="at">tolerance =</span> tolerance, </span>
<span id="cb11-2"><a href="cambio-de-funciones.html#cb11-2" tabindex="-1"></a>           <span class="at">ref.interval =</span> ref.interval, <span class="at">facCg =</span> facCg, <span class="at">facCgk =</span> facCgk, </span>
<span id="cb11-3"><a href="cambio-de-funciones.html#cb11-3" tabindex="-1"></a>           <span class="at">n =</span> n, <span class="at">type =</span> type, <span class="at">col =</span> col, <span class="at">pch =</span> pch, <span class="at">xlim =</span> xlim, </span>
<span id="cb11-4"><a href="cambio-de-funciones.html#cb11-4" tabindex="-1"></a>           <span class="at">ylim =</span> ylim, <span class="at">main =</span> <span class="st">&quot;Run Chart&quot;</span>, <span class="at">conf.level =</span> conf.level, <span class="at">cgOut =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<ul>
<li>Resultados Ahora:</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="cambio-de-funciones.html#cb12-1" tabindex="-1"></a><span class="fu">cg_RunChart</span>(<span class="at">x =</span> x, <span class="at">target =</span> target, <span class="at">tolerance =</span> tolerance, </span>
<span id="cb12-2"><a href="cambio-de-funciones.html#cb12-2" tabindex="-1"></a>                    <span class="at">ref.interval =</span> ref.interval, <span class="at">facCg =</span> facCg, <span class="at">facCgk =</span> facCgk, </span>
<span id="cb12-3"><a href="cambio-de-funciones.html#cb12-3" tabindex="-1"></a>                    <span class="at">n =</span> n, <span class="at">type =</span> type, <span class="at">col =</span> col, <span class="at">pch =</span> pch, <span class="at">xlim =</span> xlim, </span>
<span id="cb12-4"><a href="cambio-de-funciones.html#cb12-4" tabindex="-1"></a>                    <span class="at">ylim =</span> ylim, <span class="at">main =</span> <span class="st">&quot;Run Chart&quot;</span>, <span class="at">conf.level =</span> conf.level, <span class="at">cgOut =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
<div id="cghist" class="section level4 hasAnchor" number="6.2.1.2">
<h4><span class="header-section-number">6.2.1.2</span> cgHist<a href="cambio-de-funciones.html#cghist" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Resultados Anteriores:</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="cambio-de-funciones.html#cb14-1" tabindex="-1"></a>qualityTools<span class="sc">::</span><span class="fu">cgHist</span>(<span class="at">x =</span> x, <span class="at">target =</span> target, <span class="at">tolerance =</span> tolerance, <span class="at">ref.interval =</span> ref.interval, </span>
<span id="cb14-2"><a href="cambio-de-funciones.html#cb14-2" tabindex="-1"></a>       <span class="at">facCg =</span> facCg, <span class="at">facCgk =</span> facCgk, <span class="at">n =</span> n, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, </span>
<span id="cb14-3"><a href="cambio-de-funciones.html#cb14-3" tabindex="-1"></a>       <span class="at">xlim =</span> xlim, <span class="at">ylim =</span> ylim, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Histogram of&quot;</span>, </span>
<span id="cb14-4"><a href="cambio-de-funciones.html#cb14-4" tabindex="-1"></a>                                              <span class="fu">deparse</span>(<span class="fu">substitute</span>(x)), <span class="st">&quot;- target&quot;</span>), conf.level</span>
<span id="cb14-5"><a href="cambio-de-funciones.html#cb14-5" tabindex="-1"></a>       <span class="ot">=</span> conf.level, <span class="at">cgOut =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<ul>
<li>Resultados Ahora:</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="cambio-de-funciones.html#cb15-1" tabindex="-1"></a><span class="fu">cg_HistChart</span>(<span class="at">x =</span> x, <span class="at">target =</span> target, <span class="at">tolerance =</span> tolerance, <span class="at">ref.interval =</span> ref.interval, </span>
<span id="cb15-2"><a href="cambio-de-funciones.html#cb15-2" tabindex="-1"></a>            <span class="at">facCg =</span> facCg, <span class="at">facCgk =</span> facCgk, <span class="at">n =</span> n, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>, </span>
<span id="cb15-3"><a href="cambio-de-funciones.html#cb15-3" tabindex="-1"></a>            <span class="at">xlim =</span> xlim, <span class="at">ylim =</span> ylim, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Histogram of&quot;</span>, </span>
<span id="cb15-4"><a href="cambio-de-funciones.html#cb15-4" tabindex="-1"></a>                                                   <span class="fu">deparse</span>(<span class="fu">substitute</span>(x)), <span class="st">&quot;- target&quot;</span>),</span>
<span id="cb15-5"><a href="cambio-de-funciones.html#cb15-5" tabindex="-1"></a>            <span class="at">conf.level =</span> conf.level, <span class="at">cgOut =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="cgtoleranceview" class="section level4 hasAnchor" number="6.2.1.3">
<h4><span class="header-section-number">6.2.1.3</span> cgToleranceView<a href="cambio-de-funciones.html#cgtoleranceview" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Resultados Antes:</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="cambio-de-funciones.html#cb16-1" tabindex="-1"></a>qualityTools<span class="sc">::</span><span class="fu">cgToleranceView</span>(<span class="at">x =</span> x, <span class="at">target =</span> target, <span class="at">tolerance =</span> tolerance, </span>
<span id="cb16-2"><a href="cambio-de-funciones.html#cb16-2" tabindex="-1"></a>                <span class="at">ref.interval =</span> ref.interval, <span class="at">facCg =</span> facCg, <span class="at">facCgk =</span> facCgk, </span>
<span id="cb16-3"><a href="cambio-de-funciones.html#cb16-3" tabindex="-1"></a>                <span class="at">n =</span> n, <span class="at">type =</span> type, <span class="at">col =</span> col, <span class="at">pch =</span> pch, <span class="at">xlim =</span> xlim, </span>
<span id="cb16-4"><a href="cambio-de-funciones.html#cb16-4" tabindex="-1"></a>                <span class="at">ylim =</span> ylim, <span class="at">main =</span> <span class="st">&quot;Tolerance View&quot;</span>, <span class="at">conf.level =</span> conf.level, <span class="at">cgOut =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<ul>
<li>Resultados Ahora:</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="cambio-de-funciones.html#cb17-1" tabindex="-1"></a><span class="fu">cg_ToleranceChart</span>(<span class="at">x =</span> x, <span class="at">target =</span> target, <span class="at">tolerance =</span> tolerance, </span>
<span id="cb17-2"><a href="cambio-de-funciones.html#cb17-2" tabindex="-1"></a>                 <span class="at">ref.interval =</span> ref.interval, <span class="at">facCg =</span> facCg, <span class="at">facCgk =</span> facCgk, </span>
<span id="cb17-3"><a href="cambio-de-funciones.html#cb17-3" tabindex="-1"></a>                 <span class="at">n =</span> n, <span class="at">type =</span> type, <span class="at">col =</span> col, <span class="at">pch =</span> pch, <span class="at">xlim =</span> xlim, </span>
<span id="cb17-4"><a href="cambio-de-funciones.html#cb17-4" tabindex="-1"></a>                 <span class="at">ylim =</span> ylim, <span class="at">main =</span> <span class="st">&quot;Tolerance View&quot;</span>, <span class="at">conf.level =</span> conf.level, <span class="at">cgOut =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="funcion-cg" class="section level4 hasAnchor" number="6.2.1.4">
<h4><span class="header-section-number">6.2.1.4</span> Funcion cg<a href="cambio-de-funciones.html#funcion-cg" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ahora la función <code>cg</code> se modificará de la siguiente forma:</p>
<ul>
<li>Resultados Antes:</li>
</ul>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="cambio-de-funciones.html#cb18-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span> ( <span class="fl">9.991</span>, <span class="fl">10.013</span>, <span class="fl">10.001</span>, <span class="fl">10.007</span>, <span class="fl">10.010</span>, <span class="fl">10.013</span>, <span class="fl">10.008</span>, <span class="fl">10.017</span>, <span class="fl">10.005</span>, <span class="fl">10.005</span>, <span class="fl">10.002</span>,</span>
<span id="cb18-2"><a href="cambio-de-funciones.html#cb18-2" tabindex="-1"></a>         <span class="fl">10.017</span>, <span class="fl">10.005</span>, <span class="fl">10.002</span>, <span class="fl">9.996</span>, <span class="fl">10.011</span>, <span class="fl">10.009</span> , <span class="fl">10.006</span>, <span class="fl">10.008</span>, <span class="fl">10.003</span>, <span class="fl">10.002</span>, <span class="fl">10.006</span>, </span>
<span id="cb18-3"><a href="cambio-de-funciones.html#cb18-3" tabindex="-1"></a>         <span class="fl">10.010</span>, <span class="fl">9.992</span>, <span class="fl">10.013</span>)</span>
<span id="cb18-4"><a href="cambio-de-funciones.html#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="cambio-de-funciones.html#cb18-5" tabindex="-1"></a>qualityTools<span class="sc">::</span><span class="fu">cg</span>(x, <span class="at">target =</span> <span class="fl">10.003</span>, <span class="at">tolerance =</span> <span class="fu">c</span>(<span class="fl">9.903</span>, <span class="fl">10.103</span>))</span></code></pre></div>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<ul>
<li>Resultados Ahora:</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="cambio-de-funciones.html#cb19-1" tabindex="-1"></a><span class="fu">cg_</span>(x, <span class="at">target =</span> <span class="fl">10.003</span>, <span class="at">tolerance =</span> <span class="fu">c</span>(<span class="fl">9.903</span>, <span class="fl">10.103</span>))</span></code></pre></div>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="fase-3-analizar-1" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Fase 3: Analizar<a href="cambio-de-funciones.html#fase-3-analizar-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="capacidad-del-proceso-1" class="section level4 hasAnchor" number="6.3.0.1">
<h4><span class="header-section-number">6.3.0.1</span> Capacidad del proceso:<a href="cambio-de-funciones.html#capacidad-del-proceso-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ol style="list-style-type: decimal">
<li>Distribución Normal</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="cambio-de-funciones.html#cb20-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb20-2"><a href="cambio-de-funciones.html#cb20-2" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> <span class="dv">20</span>)</span>
<span id="cb20-3"><a href="cambio-de-funciones.html#cb20-3" tabindex="-1"></a><span class="fu">pcr_</span>(datos, <span class="st">&quot;normal&quot;</span>, <span class="at">lsl =</span> <span class="dv">17</span>, <span class="at">usl =</span> <span class="dv">23</span>)</span></code></pre></div>
<pre><code>## 
##  Anderson Darling Test for normal distribution
## 
## data:  datos 
## A = 0.5722, mean = 19.749, sd = 1.014, p-value = 0.1191
## alternative hypothesis: true distribution is not equal to normal</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (`geom_text()`).</code></pre>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
</div>
<div id="función-gagerrdesign-y-gagerr_-modificadas-para-trabajar-con-objetos-r6" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Función gageRRDesign y gageRR_ modificadas para trabajar con objetos R6<a href="cambio-de-funciones.html#función-gagerrdesign-y-gagerr_-modificadas-para-trabajar-con-objetos-r6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="cambio-de-funciones.html#cb23-1" tabindex="-1"></a><span class="co"># Funciones auxiliares</span></span>
<span id="cb23-2"><a href="cambio-de-funciones.html#cb23-2" tabindex="-1"></a>.aip <span class="ot">&lt;-</span> <span class="cf">function</span>(x.factor, trace.factor, response, <span class="at">fun =</span> mean, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;l&quot;</span>, <span class="st">&quot;p&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="at">legend =</span> <span class="cn">TRUE</span>, <span class="at">trace.label =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-3"><a href="cambio-de-funciones.html#cb23-3" tabindex="-1"></a>                       <span class="at">fixed =</span> <span class="cn">FALSE</span>, <span class="at">xlab =</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(x.factor)), <span class="at">ylab =</span><span class="st">&quot;Measurement&quot;</span> , <span class="at">ylim =</span> <span class="cn">NULL</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(<span class="fu">unique</span>(trace.factor)),</span>
<span id="cb23-4"><a href="cambio-de-funciones.html#cb23-4" tabindex="-1"></a>                       <span class="at">col =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="fu">c</span>(1L<span class="sc">:</span><span class="dv">9</span>, <span class="dv">0</span>, letters), <span class="at">xpd =</span> <span class="cn">NULL</span>, <span class="at">leg.bg =</span> <span class="fu">par</span>(<span class="st">&quot;bg&quot;</span>), <span class="at">leg.bty =</span> <span class="st">&quot;o&quot;</span>, <span class="at">xtick =</span> <span class="cn">FALSE</span>, <span class="at">xaxt =</span> <span class="fu">par</span>(<span class="st">&quot;xaxt&quot;</span>), <span class="at">axes =</span> <span class="cn">TRUE</span>, <span class="at">title =</span> <span class="st">&quot;&quot;</span>, ...) {</span>
<span id="cb23-5"><a href="cambio-de-funciones.html#cb23-5" tabindex="-1"></a>  ylabel <span class="ot">&lt;-</span> <span class="fu">paste</span>(ylab )</span>
<span id="cb23-6"><a href="cambio-de-funciones.html#cb23-6" tabindex="-1"></a>  type <span class="ot">&lt;-</span> <span class="fu">match.arg</span>(type)</span>
<span id="cb23-7"><a href="cambio-de-funciones.html#cb23-7" tabindex="-1"></a></span>
<span id="cb23-8"><a href="cambio-de-funciones.html#cb23-8" tabindex="-1"></a>  <span class="co"># Asegurarse de que los factores son realmente factores</span></span>
<span id="cb23-9"><a href="cambio-de-funciones.html#cb23-9" tabindex="-1"></a>  x.factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(x.factor)</span>
<span id="cb23-10"><a href="cambio-de-funciones.html#cb23-10" tabindex="-1"></a>  trace.factor <span class="ot">&lt;-</span> <span class="fu">factor</span>(trace.factor)</span>
<span id="cb23-11"><a href="cambio-de-funciones.html#cb23-11" tabindex="-1"></a></span>
<span id="cb23-12"><a href="cambio-de-funciones.html#cb23-12" tabindex="-1"></a>  <span class="co"># Calcular los valores de celda</span></span>
<span id="cb23-13"><a href="cambio-de-funciones.html#cb23-13" tabindex="-1"></a>  cellNew <span class="ot">&lt;-</span> <span class="fu">tapply</span>(response, <span class="fu">list</span>(x.factor, trace.factor), fun)</span>
<span id="cb23-14"><a href="cambio-de-funciones.html#cb23-14" tabindex="-1"></a>  cellNew <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(cellNew))</span>
<span id="cb23-15"><a href="cambio-de-funciones.html#cb23-15" tabindex="-1"></a>  <span class="fu">colnames</span>(cellNew) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x.factor&quot;</span>, <span class="st">&quot;trace.factor&quot;</span>, <span class="st">&quot;response&quot;</span>)</span>
<span id="cb23-16"><a href="cambio-de-funciones.html#cb23-16" tabindex="-1"></a></span>
<span id="cb23-17"><a href="cambio-de-funciones.html#cb23-17" tabindex="-1"></a>  <span class="co"># Convertir x.factor a numérico sólo para la visualización, pero mantenerlo como factor en los datos</span></span>
<span id="cb23-18"><a href="cambio-de-funciones.html#cb23-18" tabindex="-1"></a>  cellNew<span class="sc">$</span>x.numeric <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(cellNew<span class="sc">$</span>x.factor)</span>
<span id="cb23-19"><a href="cambio-de-funciones.html#cb23-19" tabindex="-1"></a></span>
<span id="cb23-20"><a href="cambio-de-funciones.html#cb23-20" tabindex="-1"></a>  <span class="co"># Crear el gráfico</span></span>
<span id="cb23-21"><a href="cambio-de-funciones.html#cb23-21" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cellNew, <span class="fu">aes</span>(<span class="at">x =</span> x.numeric, <span class="at">y =</span> response, <span class="at">group =</span> trace.factor, <span class="at">color =</span> trace.factor, <span class="at">shape =</span> trace.factor, <span class="at">linetype =</span> trace.factor)) <span class="sc">+</span></span>
<span id="cb23-22"><a href="cambio-de-funciones.html#cb23-22" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb23-23"><a href="cambio-de-funciones.html#cb23-23" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb23-24"><a href="cambio-de-funciones.html#cb23-24" tabindex="-1"></a>    <span class="co"># geom_text(aes(label = round(response, 2)), vjust = -0.5) +  # Comentar o eliminar esta línea para ocultar números</span></span>
<span id="cb23-25"><a href="cambio-de-funciones.html#cb23-25" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">unique</span>(cellNew<span class="sc">$</span>x.numeric), <span class="at">labels =</span> <span class="fu">levels</span>(cellNew<span class="sc">$</span>x.factor)) <span class="sc">+</span>  <span class="co"># Etiquetas de x.factor</span></span>
<span id="cb23-26"><a href="cambio-de-funciones.html#cb23-26" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> xlab, <span class="at">y =</span> ylabel, <span class="at">title =</span> title, <span class="at">color =</span> trace.label, <span class="at">shape =</span> trace.label, <span class="at">linetype =</span> trace.label) <span class="sc">+</span></span>
<span id="cb23-27"><a href="cambio-de-funciones.html#cb23-27" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb23-28"><a href="cambio-de-funciones.html#cb23-28" tabindex="-1"></a></span>
<span id="cb23-29"><a href="cambio-de-funciones.html#cb23-29" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(ylim)) {</span>
<span id="cb23-30"><a href="cambio-de-funciones.html#cb23-30" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">ylim</span>(ylim)</span>
<span id="cb23-31"><a href="cambio-de-funciones.html#cb23-31" tabindex="-1"></a>  }</span>
<span id="cb23-32"><a href="cambio-de-funciones.html#cb23-32" tabindex="-1"></a></span>
<span id="cb23-33"><a href="cambio-de-funciones.html#cb23-33" tabindex="-1"></a>  <span class="cf">if</span> (legend) {</span>
<span id="cb23-34"><a href="cambio-de-funciones.html#cb23-34" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb23-35"><a href="cambio-de-funciones.html#cb23-35" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-36"><a href="cambio-de-funciones.html#cb23-36" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb23-37"><a href="cambio-de-funciones.html#cb23-37" tabindex="-1"></a>  }</span>
<span id="cb23-38"><a href="cambio-de-funciones.html#cb23-38" tabindex="-1"></a></span>
<span id="cb23-39"><a href="cambio-de-funciones.html#cb23-39" tabindex="-1"></a>  <span class="fu">print</span>(p)</span>
<span id="cb23-40"><a href="cambio-de-funciones.html#cb23-40" tabindex="-1"></a></span>
<span id="cb23-41"><a href="cambio-de-funciones.html#cb23-41" tabindex="-1"></a>  <span class="fu">invisible</span>()</span>
<span id="cb23-42"><a href="cambio-de-funciones.html#cb23-42" tabindex="-1"></a>}</span>
<span id="cb23-43"><a href="cambio-de-funciones.html#cb23-43" tabindex="-1"></a></span>
<span id="cb23-44"><a href="cambio-de-funciones.html#cb23-44" tabindex="-1"></a></span>
<span id="cb23-45"><a href="cambio-de-funciones.html#cb23-45" tabindex="-1"></a></span>
<span id="cb23-46"><a href="cambio-de-funciones.html#cb23-46" tabindex="-1"></a>.c4 <span class="ot">=</span> <span class="cf">function</span>(n) {</span>
<span id="cb23-47"><a href="cambio-de-funciones.html#cb23-47" tabindex="-1"></a>  <span class="cf">if</span> (n <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;&amp;</span> n <span class="sc">&lt;</span> <span class="dv">342</span>)</span>
<span id="cb23-48"><a href="cambio-de-funciones.html#cb23-48" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">/</span>(n <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> (<span class="fu">factorial</span>(n<span class="sc">/</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="fu">factorial</span>((n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb23-49"><a href="cambio-de-funciones.html#cb23-49" tabindex="-1"></a>  <span class="cf">else</span> <span class="fu">stop</span>(<span class="st">&quot;n needs to be bigger than 1 and smaller than 342&quot;</span>)</span>
<span id="cb23-50"><a href="cambio-de-funciones.html#cb23-50" tabindex="-1"></a>}</span>
<span id="cb23-51"><a href="cambio-de-funciones.html#cb23-51" tabindex="-1"></a><span class="co"># Definición de la clase gageRR</span></span>
<span id="cb23-52"><a href="cambio-de-funciones.html#cb23-52" tabindex="-1"></a>gageRR <span class="ot">&lt;-</span> <span class="fu">R6Class</span>(<span class="st">&quot;gageRR&quot;</span>,</span>
<span id="cb23-53"><a href="cambio-de-funciones.html#cb23-53" tabindex="-1"></a>                  <span class="at">public =</span> <span class="fu">list</span>(</span>
<span id="cb23-54"><a href="cambio-de-funciones.html#cb23-54" tabindex="-1"></a>                    <span class="at">X =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-55"><a href="cambio-de-funciones.html#cb23-55" tabindex="-1"></a>                    <span class="at">ANOVA =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-56"><a href="cambio-de-funciones.html#cb23-56" tabindex="-1"></a>                    <span class="at">RedANOVA =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-57"><a href="cambio-de-funciones.html#cb23-57" tabindex="-1"></a>                    <span class="at">method =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-58"><a href="cambio-de-funciones.html#cb23-58" tabindex="-1"></a>                    <span class="at">Estimates =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-59"><a href="cambio-de-funciones.html#cb23-59" tabindex="-1"></a>                    <span class="at">Varcomp =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-60"><a href="cambio-de-funciones.html#cb23-60" tabindex="-1"></a>                    <span class="at">Sigma =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-61"><a href="cambio-de-funciones.html#cb23-61" tabindex="-1"></a>                    <span class="at">GageName =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-62"><a href="cambio-de-funciones.html#cb23-62" tabindex="-1"></a>                    <span class="at">GageTolerance =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-63"><a href="cambio-de-funciones.html#cb23-63" tabindex="-1"></a>                    <span class="at">DateOfStudy =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-64"><a href="cambio-de-funciones.html#cb23-64" tabindex="-1"></a>                    <span class="at">PersonResponsible =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-65"><a href="cambio-de-funciones.html#cb23-65" tabindex="-1"></a>                    <span class="at">Comments =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-66"><a href="cambio-de-funciones.html#cb23-66" tabindex="-1"></a>                    <span class="at">b =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-67"><a href="cambio-de-funciones.html#cb23-67" tabindex="-1"></a>                    <span class="at">a =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-68"><a href="cambio-de-funciones.html#cb23-68" tabindex="-1"></a>                    <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-69"><a href="cambio-de-funciones.html#cb23-69" tabindex="-1"></a>                    <span class="at">facNames =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-70"><a href="cambio-de-funciones.html#cb23-70" tabindex="-1"></a>                    <span class="at">numO =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-71"><a href="cambio-de-funciones.html#cb23-71" tabindex="-1"></a>                    <span class="at">numP =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-72"><a href="cambio-de-funciones.html#cb23-72" tabindex="-1"></a>                    <span class="at">numM =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-73"><a href="cambio-de-funciones.html#cb23-73" tabindex="-1"></a>                    <span class="at">initialize =</span> <span class="cf">function</span>(X, <span class="at">ANOVA =</span> <span class="cn">NULL</span>, <span class="at">RedANOVA =</span> <span class="cn">NULL</span>, <span class="at">method =</span> <span class="cn">NULL</span>, <span class="at">Estimates =</span> <span class="cn">NULL</span>, <span class="at">Varcomp =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-74"><a href="cambio-de-funciones.html#cb23-74" tabindex="-1"></a>                                                                <span class="at">Sigma =</span> <span class="cn">NULL</span>, <span class="at">GageName =</span> <span class="cn">NULL</span>, <span class="at">GageTolerance =</span> <span class="cn">NULL</span>, <span class="at">DateOfStudy =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-75"><a href="cambio-de-funciones.html#cb23-75" tabindex="-1"></a>                                                                <span class="at">PersonResponsible =</span> <span class="cn">NULL</span>, <span class="at">Comments =</span> <span class="cn">NULL</span>, <span class="at">b =</span> <span class="cn">NULL</span>, <span class="at">a =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-76"><a href="cambio-de-funciones.html#cb23-76" tabindex="-1"></a>                                                                <span class="at">facNames =</span> <span class="cn">NULL</span>, <span class="at">numO =</span> <span class="cn">NULL</span>, <span class="at">numP =</span> <span class="cn">NULL</span>, <span class="at">numM =</span> <span class="cn">NULL</span>) {</span>
<span id="cb23-77"><a href="cambio-de-funciones.html#cb23-77" tabindex="-1"></a>                      self<span class="sc">$</span>X <span class="ot">&lt;-</span> X</span>
<span id="cb23-78"><a href="cambio-de-funciones.html#cb23-78" tabindex="-1"></a>                      self<span class="sc">$</span>ANOVA <span class="ot">&lt;-</span> ANOVA</span>
<span id="cb23-79"><a href="cambio-de-funciones.html#cb23-79" tabindex="-1"></a>                      self<span class="sc">$</span>RedANOVA <span class="ot">&lt;-</span> RedANOVA</span>
<span id="cb23-80"><a href="cambio-de-funciones.html#cb23-80" tabindex="-1"></a>                      self<span class="sc">$</span>method <span class="ot">&lt;-</span> method</span>
<span id="cb23-81"><a href="cambio-de-funciones.html#cb23-81" tabindex="-1"></a>                      self<span class="sc">$</span>Estimates <span class="ot">&lt;-</span> Estimates</span>
<span id="cb23-82"><a href="cambio-de-funciones.html#cb23-82" tabindex="-1"></a>                      self<span class="sc">$</span>Varcomp <span class="ot">&lt;-</span> Varcomp</span>
<span id="cb23-83"><a href="cambio-de-funciones.html#cb23-83" tabindex="-1"></a>                      self<span class="sc">$</span>Sigma <span class="ot">&lt;-</span> Sigma</span>
<span id="cb23-84"><a href="cambio-de-funciones.html#cb23-84" tabindex="-1"></a>                      self<span class="sc">$</span>GageName <span class="ot">&lt;-</span> GageName</span>
<span id="cb23-85"><a href="cambio-de-funciones.html#cb23-85" tabindex="-1"></a>                      self<span class="sc">$</span>GageTolerance <span class="ot">&lt;-</span> GageTolerance</span>
<span id="cb23-86"><a href="cambio-de-funciones.html#cb23-86" tabindex="-1"></a>                      self<span class="sc">$</span>DateOfStudy <span class="ot">&lt;-</span> DateOfStudy</span>
<span id="cb23-87"><a href="cambio-de-funciones.html#cb23-87" tabindex="-1"></a>                      self<span class="sc">$</span>PersonResponsible <span class="ot">&lt;-</span> PersonResponsible</span>
<span id="cb23-88"><a href="cambio-de-funciones.html#cb23-88" tabindex="-1"></a>                      self<span class="sc">$</span>Comments <span class="ot">&lt;-</span> Comments</span>
<span id="cb23-89"><a href="cambio-de-funciones.html#cb23-89" tabindex="-1"></a>                      self<span class="sc">$</span>b <span class="ot">&lt;-</span> b</span>
<span id="cb23-90"><a href="cambio-de-funciones.html#cb23-90" tabindex="-1"></a>                      self<span class="sc">$</span>a <span class="ot">&lt;-</span> a</span>
<span id="cb23-91"><a href="cambio-de-funciones.html#cb23-91" tabindex="-1"></a>                      self<span class="sc">$</span>y <span class="ot">&lt;-</span> y</span>
<span id="cb23-92"><a href="cambio-de-funciones.html#cb23-92" tabindex="-1"></a>                      self<span class="sc">$</span>facNames <span class="ot">&lt;-</span> facNames</span>
<span id="cb23-93"><a href="cambio-de-funciones.html#cb23-93" tabindex="-1"></a>                      self<span class="sc">$</span>numO <span class="ot">&lt;-</span> numO</span>
<span id="cb23-94"><a href="cambio-de-funciones.html#cb23-94" tabindex="-1"></a>                      self<span class="sc">$</span>numP <span class="ot">&lt;-</span> numP</span>
<span id="cb23-95"><a href="cambio-de-funciones.html#cb23-95" tabindex="-1"></a>                      self<span class="sc">$</span>numM <span class="ot">&lt;-</span> numM</span>
<span id="cb23-96"><a href="cambio-de-funciones.html#cb23-96" tabindex="-1"></a>                    },</span>
<span id="cb23-97"><a href="cambio-de-funciones.html#cb23-97" tabindex="-1"></a>    <span class="at">show =</span> <span class="cf">function</span>() {</span>
<span id="cb23-98"><a href="cambio-de-funciones.html#cb23-98" tabindex="-1"></a>      <span class="fu">print</span>(<span class="fu">as.data.frame</span>(self<span class="sc">$</span>X))</span>
<span id="cb23-99"><a href="cambio-de-funciones.html#cb23-99" tabindex="-1"></a>    },</span>
<span id="cb23-100"><a href="cambio-de-funciones.html#cb23-100" tabindex="-1"></a>    <span class="at">subset =</span> <span class="cf">function</span>(i, j) {</span>
<span id="cb23-101"><a href="cambio-de-funciones.html#cb23-101" tabindex="-1"></a>      <span class="fu">return</span>(self<span class="sc">$</span>X[i, j])</span>
<span id="cb23-102"><a href="cambio-de-funciones.html#cb23-102" tabindex="-1"></a>    },</span>
<span id="cb23-103"><a href="cambio-de-funciones.html#cb23-103" tabindex="-1"></a>    <span class="at">summary =</span> <span class="cf">function</span>() {</span>
<span id="cb23-104"><a href="cambio-de-funciones.html#cb23-104" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">all</span>(<span class="fu">is.na</span>(self<span class="sc">$</span>X<span class="sc">$</span>Measurement))) {</span>
<span id="cb23-105"><a href="cambio-de-funciones.html#cb23-105" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Gage R&amp;R Summary</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-106"><a href="cambio-de-funciones.html#cb23-106" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;-----------------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-107"><a href="cambio-de-funciones.html#cb23-107" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Method: &quot;</span>, self<span class="sc">$</span>method, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-108"><a href="cambio-de-funciones.html#cb23-108" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Sigma: &quot;</span>, self<span class="sc">$</span>Sigma, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-109"><a href="cambio-de-funciones.html#cb23-109" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Gage Name: &quot;</span>, self<span class="sc">$</span>GageName, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-110"><a href="cambio-de-funciones.html#cb23-110" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Gage Tolerance: &quot;</span>, self<span class="sc">$</span>GageTolerance, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-111"><a href="cambio-de-funciones.html#cb23-111" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Date of Study: &quot;</span>, self<span class="sc">$</span>DateOfStudy, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-112"><a href="cambio-de-funciones.html#cb23-112" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Person Responsible: &quot;</span>, self<span class="sc">$</span>PersonResponsible, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-113"><a href="cambio-de-funciones.html#cb23-113" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Comments: &quot;</span>, self<span class="sc">$</span>Comments, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-114"><a href="cambio-de-funciones.html#cb23-114" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Operators: &quot;</span>, self<span class="sc">$</span>numO, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-115"><a href="cambio-de-funciones.html#cb23-115" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Parts: &quot;</span>, self<span class="sc">$</span>numP, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-116"><a href="cambio-de-funciones.html#cb23-116" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Measurements per Part: &quot;</span>, self<span class="sc">$</span>numM, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-117"><a href="cambio-de-funciones.html#cb23-117" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb23-118"><a href="cambio-de-funciones.html#cb23-118" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-119"><a href="cambio-de-funciones.html#cb23-119" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Operators:</span><span class="sc">\t</span><span class="st">&quot;</span>, self<span class="sc">$</span>numO, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">Parts:</span><span class="sc">\t</span><span class="st">&quot;</span>, self<span class="sc">$</span>numP, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-120"><a href="cambio-de-funciones.html#cb23-120" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;Measurements:</span><span class="sc">\t</span><span class="st">&quot;</span>, self<span class="sc">$</span>numM, <span class="st">&quot;</span><span class="sc">\t</span><span class="st">Total:</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="fu">nrow</span>(self<span class="sc">$</span>X), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-121"><a href="cambio-de-funciones.html#cb23-121" tabindex="-1"></a>        <span class="fu">cat</span>(<span class="st">&quot;----------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-122"><a href="cambio-de-funciones.html#cb23-122" tabindex="-1"></a>      }</span>
<span id="cb23-123"><a href="cambio-de-funciones.html#cb23-123" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">invisible</span>(self))</span>
<span id="cb23-124"><a href="cambio-de-funciones.html#cb23-124" tabindex="-1"></a>    },</span>
<span id="cb23-125"><a href="cambio-de-funciones.html#cb23-125" tabindex="-1"></a>    <span class="at">response =</span> <span class="cf">function</span>() {</span>
<span id="cb23-126"><a href="cambio-de-funciones.html#cb23-126" tabindex="-1"></a>      <span class="fu">return</span>(self<span class="sc">$</span>X<span class="sc">$</span>Measurement)</span>
<span id="cb23-127"><a href="cambio-de-funciones.html#cb23-127" tabindex="-1"></a>    },</span>
<span id="cb23-128"><a href="cambio-de-funciones.html#cb23-128" tabindex="-1"></a>    <span class="at">replace_response =</span> <span class="cf">function</span>(value) {</span>
<span id="cb23-129"><a href="cambio-de-funciones.html#cb23-129" tabindex="-1"></a>      self<span class="sc">$</span>X<span class="sc">$</span>Measurement <span class="ot">=</span> value</span>
<span id="cb23-130"><a href="cambio-de-funciones.html#cb23-130" tabindex="-1"></a>      <span class="fu">return</span>(self)</span>
<span id="cb23-131"><a href="cambio-de-funciones.html#cb23-131" tabindex="-1"></a>    },</span>
<span id="cb23-132"><a href="cambio-de-funciones.html#cb23-132" tabindex="-1"></a>    <span class="at">names =</span> <span class="cf">function</span>() {</span>
<span id="cb23-133"><a href="cambio-de-funciones.html#cb23-133" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">names</span>(<span class="fu">as.data.frame</span>(self)))</span>
<span id="cb23-134"><a href="cambio-de-funciones.html#cb23-134" tabindex="-1"></a>    },</span>
<span id="cb23-135"><a href="cambio-de-funciones.html#cb23-135" tabindex="-1"></a>    <span class="at">as_data_frame =</span> <span class="cf">function</span>() {</span>
<span id="cb23-136"><a href="cambio-de-funciones.html#cb23-136" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">as.data.frame</span>(self))</span>
<span id="cb23-137"><a href="cambio-de-funciones.html#cb23-137" tabindex="-1"></a>    },</span>
<span id="cb23-138"><a href="cambio-de-funciones.html#cb23-138" tabindex="-1"></a>    <span class="at">get_tolerance =</span> <span class="cf">function</span>() {</span>
<span id="cb23-139"><a href="cambio-de-funciones.html#cb23-139" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">unlist</span>(self<span class="sc">$</span>GageTolerance))</span>
<span id="cb23-140"><a href="cambio-de-funciones.html#cb23-140" tabindex="-1"></a>    },</span>
<span id="cb23-141"><a href="cambio-de-funciones.html#cb23-141" tabindex="-1"></a>    <span class="at">set_tolerance =</span> <span class="cf">function</span>(value) {</span>
<span id="cb23-142"><a href="cambio-de-funciones.html#cb23-142" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(value))</span>
<span id="cb23-143"><a href="cambio-de-funciones.html#cb23-143" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;GageTolerance needs to be numeric&quot;</span>)</span>
<span id="cb23-144"><a href="cambio-de-funciones.html#cb23-144" tabindex="-1"></a>      self<span class="sc">$</span>GageTolerance <span class="ot">=</span> value</span>
<span id="cb23-145"><a href="cambio-de-funciones.html#cb23-145" tabindex="-1"></a>      <span class="fu">return</span>(self)</span>
<span id="cb23-146"><a href="cambio-de-funciones.html#cb23-146" tabindex="-1"></a>    },</span>
<span id="cb23-147"><a href="cambio-de-funciones.html#cb23-147" tabindex="-1"></a>    <span class="at">get_sigma =</span> <span class="cf">function</span>() {</span>
<span id="cb23-148"><a href="cambio-de-funciones.html#cb23-148" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fu">unlist</span>(self<span class="sc">$</span>Sigma))</span>
<span id="cb23-149"><a href="cambio-de-funciones.html#cb23-149" tabindex="-1"></a>    },</span>
<span id="cb23-150"><a href="cambio-de-funciones.html#cb23-150" tabindex="-1"></a>    <span class="at">set_sigma =</span> <span class="cf">function</span>(value) {</span>
<span id="cb23-151"><a href="cambio-de-funciones.html#cb23-151" tabindex="-1"></a>      <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(value))</span>
<span id="cb23-152"><a href="cambio-de-funciones.html#cb23-152" tabindex="-1"></a>        <span class="fu">stop</span>(<span class="st">&quot;Sigma needs to be numeric&quot;</span>)</span>
<span id="cb23-153"><a href="cambio-de-funciones.html#cb23-153" tabindex="-1"></a>      self<span class="sc">$</span>Sigma <span class="ot">=</span> value</span>
<span id="cb23-154"><a href="cambio-de-funciones.html#cb23-154" tabindex="-1"></a>      <span class="fu">return</span>(self)</span>
<span id="cb23-155"><a href="cambio-de-funciones.html#cb23-155" tabindex="-1"></a>    }</span>
<span id="cb23-156"><a href="cambio-de-funciones.html#cb23-156" tabindex="-1"></a>                  )</span>
<span id="cb23-157"><a href="cambio-de-funciones.html#cb23-157" tabindex="-1"></a>)</span>
<span id="cb23-158"><a href="cambio-de-funciones.html#cb23-158" tabindex="-1"></a></span>
<span id="cb23-159"><a href="cambio-de-funciones.html#cb23-159" tabindex="-1"></a><span class="co"># función gageRRdesign modificada</span></span>
<span id="cb23-160"><a href="cambio-de-funciones.html#cb23-160" tabindex="-1"></a>gageRRDesign <span class="ot">=</span> <span class="cf">function</span>(<span class="at">Operators =</span> <span class="dv">3</span>, <span class="at">Parts =</span> <span class="dv">10</span>, <span class="at">Measurements =</span> <span class="dv">3</span>, <span class="at">method =</span> <span class="st">&quot;crossed&quot;</span>, <span class="at">sigma =</span> <span class="dv">6</span>, <span class="at">randomize =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb23-161"><a href="cambio-de-funciones.html#cb23-161" tabindex="-1"></a>  <span class="co"># Validación de argumentos</span></span>
<span id="cb23-162"><a href="cambio-de-funciones.html#cb23-162" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(sigma))</span>
<span id="cb23-163"><a href="cambio-de-funciones.html#cb23-163" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;sigma needs to be numeric&quot;</span>)</span>
<span id="cb23-164"><a href="cambio-de-funciones.html#cb23-164" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">!=</span> <span class="st">&quot;nested&quot;</span> <span class="sc">&amp;&amp;</span> method <span class="sc">!=</span> <span class="st">&quot;crossed&quot;</span>)</span>
<span id="cb23-165"><a href="cambio-de-funciones.html#cb23-165" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Unknown method specified. Use &#39;method = nested&#39; or &#39;method = crossed&#39;.&quot;</span>)</span>
<span id="cb23-166"><a href="cambio-de-funciones.html#cb23-166" tabindex="-1"></a>  Measurements <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(Measurements)</span>
<span id="cb23-167"><a href="cambio-de-funciones.html#cb23-167" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(Measurements) <span class="sc">||</span> Measurements <span class="sc">&lt;=</span> <span class="dv">0</span>)</span>
<span id="cb23-168"><a href="cambio-de-funciones.html#cb23-168" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Number of Measurements per Part must be a positive integer.&quot;</span>)</span>
<span id="cb23-169"><a href="cambio-de-funciones.html#cb23-169" tabindex="-1"></a></span>
<span id="cb23-170"><a href="cambio-de-funciones.html#cb23-170" tabindex="-1"></a></span>
<span id="cb23-171"><a href="cambio-de-funciones.html#cb23-171" tabindex="-1"></a>  opvec <span class="ot">&lt;-</span> <span class="fu">factor</span>()</span>
<span id="cb23-172"><a href="cambio-de-funciones.html#cb23-172" tabindex="-1"></a>  partvec <span class="ot">&lt;-</span> <span class="fu">factor</span>()</span>
<span id="cb23-173"><a href="cambio-de-funciones.html#cb23-173" tabindex="-1"></a></span>
<span id="cb23-174"><a href="cambio-de-funciones.html#cb23-174" tabindex="-1"></a>  yName <span class="ot">&lt;-</span> <span class="st">&quot;Measurement&quot;</span></span>
<span id="cb23-175"><a href="cambio-de-funciones.html#cb23-175" tabindex="-1"></a>  aName <span class="ot">&lt;-</span> <span class="st">&quot;Operator&quot;</span></span>
<span id="cb23-176"><a href="cambio-de-funciones.html#cb23-176" tabindex="-1"></a>  bName <span class="ot">&lt;-</span> <span class="st">&quot;Part&quot;</span></span>
<span id="cb23-177"><a href="cambio-de-funciones.html#cb23-177" tabindex="-1"></a>  abName <span class="ot">&lt;-</span> <span class="st">&quot;Operator:Part&quot;</span></span>
<span id="cb23-178"><a href="cambio-de-funciones.html#cb23-178" tabindex="-1"></a></span>
<span id="cb23-179"><a href="cambio-de-funciones.html#cb23-179" tabindex="-1"></a>  Operators <span class="ot">&lt;-</span> <span class="fu">unique</span>(Operators)</span>
<span id="cb23-180"><a href="cambio-de-funciones.html#cb23-180" tabindex="-1"></a>  Parts <span class="ot">&lt;-</span> <span class="fu">unique</span>(Parts)</span>
<span id="cb23-181"><a href="cambio-de-funciones.html#cb23-181" tabindex="-1"></a></span>
<span id="cb23-182"><a href="cambio-de-funciones.html#cb23-182" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.numeric</span>(Operators))</span>
<span id="cb23-183"><a href="cambio-de-funciones.html#cb23-183" tabindex="-1"></a>    opvec <span class="ot">&lt;-</span> <span class="fu">factor</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span>Operators[<span class="dv">1</span>]])</span>
<span id="cb23-184"><a href="cambio-de-funciones.html#cb23-184" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.character</span>(Operators))</span>
<span id="cb23-185"><a href="cambio-de-funciones.html#cb23-185" tabindex="-1"></a>    opvec <span class="ot">&lt;-</span> <span class="fu">factor</span>(Operators)</span>
<span id="cb23-186"><a href="cambio-de-funciones.html#cb23-186" tabindex="-1"></a></span>
<span id="cb23-187"><a href="cambio-de-funciones.html#cb23-187" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(opvec)) <span class="sc">&gt;</span> <span class="dv">26</span>)</span>
<span id="cb23-188"><a href="cambio-de-funciones.html#cb23-188" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Too many Operators!&quot;</span>)</span>
<span id="cb23-189"><a href="cambio-de-funciones.html#cb23-189" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(opvec)) <span class="sc">&lt;</span> <span class="dv">2</span>)</span>
<span id="cb23-190"><a href="cambio-de-funciones.html#cb23-190" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Not enough Operators&quot;</span>)</span>
<span id="cb23-191"><a href="cambio-de-funciones.html#cb23-191" tabindex="-1"></a></span>
<span id="cb23-192"><a href="cambio-de-funciones.html#cb23-192" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.numeric</span>(Parts))</span>
<span id="cb23-193"><a href="cambio-de-funciones.html#cb23-193" tabindex="-1"></a>    partvec <span class="ot">&lt;-</span> <span class="fu">factor</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span>Parts[<span class="dv">1</span>]])</span>
<span id="cb23-194"><a href="cambio-de-funciones.html#cb23-194" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.character</span>(Parts))</span>
<span id="cb23-195"><a href="cambio-de-funciones.html#cb23-195" tabindex="-1"></a>    partvec <span class="ot">&lt;-</span> <span class="fu">factor</span>(Parts)</span>
<span id="cb23-196"><a href="cambio-de-funciones.html#cb23-196" tabindex="-1"></a></span>
<span id="cb23-197"><a href="cambio-de-funciones.html#cb23-197" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(partvec)) <span class="sc">&gt;</span> <span class="dv">26</span>)</span>
<span id="cb23-198"><a href="cambio-de-funciones.html#cb23-198" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Too many Parts!&quot;</span>)</span>
<span id="cb23-199"><a href="cambio-de-funciones.html#cb23-199" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unique</span>(partvec)) <span class="sc">&lt;</span> <span class="dv">2</span>)</span>
<span id="cb23-200"><a href="cambio-de-funciones.html#cb23-200" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Too few Parts&quot;</span>)</span>
<span id="cb23-201"><a href="cambio-de-funciones.html#cb23-201" tabindex="-1"></a></span>
<span id="cb23-202"><a href="cambio-de-funciones.html#cb23-202" tabindex="-1"></a>  Measurement <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, (<span class="fu">length</span>(opvec) <span class="sc">*</span> <span class="fu">length</span>(partvec) <span class="sc">*</span> Measurements))</span>
<span id="cb23-203"><a href="cambio-de-funciones.html#cb23-203" tabindex="-1"></a>  outFrame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb23-204"><a href="cambio-de-funciones.html#cb23-204" tabindex="-1"></a></span>
<span id="cb23-205"><a href="cambio-de-funciones.html#cb23-205" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">&quot;crossed&quot;</span>) {</span>
<span id="cb23-206"><a href="cambio-de-funciones.html#cb23-206" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(opvec, partvec)</span>
<span id="cb23-207"><a href="cambio-de-funciones.html#cb23-207" tabindex="-1"></a>    o <span class="ot">&lt;-</span> <span class="fu">rep</span>(temp[, <span class="dv">1</span>], Measurements)</span>
<span id="cb23-208"><a href="cambio-de-funciones.html#cb23-208" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">rep</span>(temp[, <span class="dv">2</span>], Measurements)</span>
<span id="cb23-209"><a href="cambio-de-funciones.html#cb23-209" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-210"><a href="cambio-de-funciones.html#cb23-210" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">sort</span>(<span class="fu">rep</span>(partvec, <span class="fu">length</span>(opvec))), Measurements)</span>
<span id="cb23-211"><a href="cambio-de-funciones.html#cb23-211" tabindex="-1"></a>    o <span class="ot">&lt;-</span> (<span class="fu">rep</span>(opvec, <span class="fu">length</span>(Measurement) <span class="sc">/</span> <span class="fu">length</span>(opvec)))</span>
<span id="cb23-212"><a href="cambio-de-funciones.html#cb23-212" tabindex="-1"></a>    p <span class="ot">&lt;-</span> p[<span class="fu">order</span>(o,p)]</span>
<span id="cb23-213"><a href="cambio-de-funciones.html#cb23-213" tabindex="-1"></a>    o <span class="ot">&lt;-</span> o[<span class="fu">order</span>(o,p)]</span>
<span id="cb23-214"><a href="cambio-de-funciones.html#cb23-214" tabindex="-1"></a>  }</span>
<span id="cb23-215"><a href="cambio-de-funciones.html#cb23-215" tabindex="-1"></a></span>
<span id="cb23-216"><a href="cambio-de-funciones.html#cb23-216" tabindex="-1"></a>  <span class="cf">if</span> (randomize)</span>
<span id="cb23-217"><a href="cambio-de-funciones.html#cb23-217" tabindex="-1"></a>    outFrame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">StandardOrder =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Measurement), <span class="at">RunOrder =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Measurement), <span class="fu">length</span>(Measurement)), <span class="at">Operator =</span> <span class="fu">factor</span>(o), <span class="at">Part =</span> <span class="fu">factor</span>(p), Measurement)</span>
<span id="cb23-218"><a href="cambio-de-funciones.html#cb23-218" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb23-219"><a href="cambio-de-funciones.html#cb23-219" tabindex="-1"></a>    outFrame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">StandardOrder =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Measurement), <span class="at">RunOrder =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Measurement), <span class="at">Operator =</span> <span class="fu">factor</span>(o), <span class="at">Part =</span> <span class="fu">factor</span>(p), Measurement)</span>
<span id="cb23-220"><a href="cambio-de-funciones.html#cb23-220" tabindex="-1"></a></span>
<span id="cb23-221"><a href="cambio-de-funciones.html#cb23-221" tabindex="-1"></a>  outFrame <span class="ot">&lt;-</span> outFrame[<span class="fu">order</span>(outFrame<span class="sc">$</span>RunOrder), ]</span>
<span id="cb23-222"><a href="cambio-de-funciones.html#cb23-222" tabindex="-1"></a>  <span class="co"># Valores predeterminados</span></span>
<span id="cb23-223"><a href="cambio-de-funciones.html#cb23-223" tabindex="-1"></a>  gageRRObj <span class="ot">&lt;-</span> gageRR<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb23-224"><a href="cambio-de-funciones.html#cb23-224" tabindex="-1"></a>    <span class="at">X =</span> outFrame,</span>
<span id="cb23-225"><a href="cambio-de-funciones.html#cb23-225" tabindex="-1"></a>    <span class="at">ANOVA =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-226"><a href="cambio-de-funciones.html#cb23-226" tabindex="-1"></a>    <span class="at">RedANOVA =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-227"><a href="cambio-de-funciones.html#cb23-227" tabindex="-1"></a>    <span class="at">method =</span> method,</span>
<span id="cb23-228"><a href="cambio-de-funciones.html#cb23-228" tabindex="-1"></a>    <span class="at">Estimates =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-229"><a href="cambio-de-funciones.html#cb23-229" tabindex="-1"></a>    <span class="at">Varcomp =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-230"><a href="cambio-de-funciones.html#cb23-230" tabindex="-1"></a>    <span class="at">Sigma =</span> sigma,</span>
<span id="cb23-231"><a href="cambio-de-funciones.html#cb23-231" tabindex="-1"></a>    <span class="at">GageName =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-232"><a href="cambio-de-funciones.html#cb23-232" tabindex="-1"></a>    <span class="at">GageTolerance =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-233"><a href="cambio-de-funciones.html#cb23-233" tabindex="-1"></a>    <span class="at">DateOfStudy =</span> <span class="fu">Sys.Date</span>(),</span>
<span id="cb23-234"><a href="cambio-de-funciones.html#cb23-234" tabindex="-1"></a>    <span class="at">PersonResponsible =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-235"><a href="cambio-de-funciones.html#cb23-235" tabindex="-1"></a>    <span class="at">Comments =</span> <span class="cn">NULL</span>,</span>
<span id="cb23-236"><a href="cambio-de-funciones.html#cb23-236" tabindex="-1"></a>    <span class="at">b =</span> <span class="fu">factor</span>(p),</span>
<span id="cb23-237"><a href="cambio-de-funciones.html#cb23-237" tabindex="-1"></a>    <span class="at">a =</span> <span class="fu">factor</span>(o),</span>
<span id="cb23-238"><a href="cambio-de-funciones.html#cb23-238" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">as.numeric</span>(Measurement),</span>
<span id="cb23-239"><a href="cambio-de-funciones.html#cb23-239" tabindex="-1"></a>    <span class="at">facNames =</span> <span class="fu">c</span>(yName, aName, bName, abName),</span>
<span id="cb23-240"><a href="cambio-de-funciones.html#cb23-240" tabindex="-1"></a>    <span class="at">numO =</span> <span class="fu">length</span>(<span class="fu">unique</span>(opvec)),  <span class="co"># Número de operadores</span></span>
<span id="cb23-241"><a href="cambio-de-funciones.html#cb23-241" tabindex="-1"></a>    <span class="at">numP =</span> <span class="fu">length</span>(<span class="fu">unique</span>(partvec)),  <span class="co"># Número de partes</span></span>
<span id="cb23-242"><a href="cambio-de-funciones.html#cb23-242" tabindex="-1"></a>    <span class="at">numM =</span> Measurements  <span class="co"># Número de mediciones</span></span>
<span id="cb23-243"><a href="cambio-de-funciones.html#cb23-243" tabindex="-1"></a>  )</span>
<span id="cb23-244"><a href="cambio-de-funciones.html#cb23-244" tabindex="-1"></a></span>
<span id="cb23-245"><a href="cambio-de-funciones.html#cb23-245" tabindex="-1"></a>  <span class="fu">return</span>(gageRRObj)</span>
<span id="cb23-246"><a href="cambio-de-funciones.html#cb23-246" tabindex="-1"></a>}</span>
<span id="cb23-247"><a href="cambio-de-funciones.html#cb23-247" tabindex="-1"></a></span>
<span id="cb23-248"><a href="cambio-de-funciones.html#cb23-248" tabindex="-1"></a>gageRR_ <span class="ot">=</span> <span class="cf">function</span>(gdo, <span class="at">method =</span> <span class="st">&quot;crossed&quot;</span>, <span class="at">sigma =</span> <span class="dv">6</span>, <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">DM =</span> <span class="cn">NULL</span>, <span class="at">HM =</span> <span class="cn">NULL</span>, <span class="at">tolerance =</span> <span class="cn">NULL</span>, <span class="at">dig =</span> <span class="dv">3</span>, ...) {</span>
<span id="cb23-249"><a href="cambio-de-funciones.html#cb23-249" tabindex="-1"></a>  method <span class="ot">&lt;-</span> method</span>
<span id="cb23-250"><a href="cambio-de-funciones.html#cb23-250" tabindex="-1"></a></span>
<span id="cb23-251"><a href="cambio-de-funciones.html#cb23-251" tabindex="-1"></a>  yName <span class="ot">&lt;-</span> <span class="st">&quot;Measurement&quot;</span></span>
<span id="cb23-252"><a href="cambio-de-funciones.html#cb23-252" tabindex="-1"></a>  aName <span class="ot">&lt;-</span> <span class="st">&quot;Operator&quot;</span></span>
<span id="cb23-253"><a href="cambio-de-funciones.html#cb23-253" tabindex="-1"></a>  bName <span class="ot">&lt;-</span> <span class="st">&quot;Part&quot;</span></span>
<span id="cb23-254"><a href="cambio-de-funciones.html#cb23-254" tabindex="-1"></a></span>
<span id="cb23-255"><a href="cambio-de-funciones.html#cb23-255" tabindex="-1"></a>  abName <span class="ot">&lt;-</span> <span class="cf">if</span>(method <span class="sc">==</span> <span class="st">&quot;crossed&quot;</span>) <span class="fu">paste</span>(aName, <span class="st">&quot;:&quot;</span>, bName, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb23-256"><a href="cambio-de-funciones.html#cb23-256" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span>(method <span class="sc">==</span> <span class="st">&quot;nested&quot;</span>) <span class="fu">paste</span>(bName, <span class="st">&quot;(&quot;</span>, aName, <span class="st">&quot;)&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb23-257"><a href="cambio-de-funciones.html#cb23-257" tabindex="-1"></a>  <span class="cf">else</span> <span class="cn">NA</span></span>
<span id="cb23-258"><a href="cambio-de-funciones.html#cb23-258" tabindex="-1"></a></span>
<span id="cb23-259"><a href="cambio-de-funciones.html#cb23-259" tabindex="-1"></a>  bTobName <span class="ot">&lt;-</span> <span class="fu">paste</span>(bName, <span class="st">&quot;to&quot;</span>, bName, <span class="at">sep =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb23-260"><a href="cambio-de-funciones.html#cb23-260" tabindex="-1"></a></span>
<span id="cb23-261"><a href="cambio-de-funciones.html#cb23-261" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(tolerance)) tolerance <span class="ot">&lt;-</span> gdo<span class="sc">$</span><span class="fu">get_tolerance</span>()</span>
<span id="cb23-262"><a href="cambio-de-funciones.html#cb23-262" tabindex="-1"></a></span>
<span id="cb23-263"><a href="cambio-de-funciones.html#cb23-263" tabindex="-1"></a>  y <span class="ot">&lt;-</span> gdo<span class="sc">$</span>X[[yName]]</span>
<span id="cb23-264"><a href="cambio-de-funciones.html#cb23-264" tabindex="-1"></a>  a <span class="ot">&lt;-</span> gdo<span class="sc">$</span>X[[aName]]</span>
<span id="cb23-265"><a href="cambio-de-funciones.html#cb23-265" tabindex="-1"></a>  b <span class="ot">&lt;-</span> gdo<span class="sc">$</span>X[[bName]]</span>
<span id="cb23-266"><a href="cambio-de-funciones.html#cb23-266" tabindex="-1"></a></span>
<span id="cb23-267"><a href="cambio-de-funciones.html#cb23-267" tabindex="-1"></a>  nestedFormula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(yName, <span class="st">&quot;~&quot;</span>, aName, <span class="st">&quot;/&quot;</span>, bName))</span>
<span id="cb23-268"><a href="cambio-de-funciones.html#cb23-268" tabindex="-1"></a>  crossedFormula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(yName, <span class="st">&quot;~&quot;</span>, aName, <span class="st">&quot;*&quot;</span>, bName))</span>
<span id="cb23-269"><a href="cambio-de-funciones.html#cb23-269" tabindex="-1"></a>  reducedFormula <span class="ot">&lt;-</span> <span class="fu">as.formula</span>(<span class="fu">paste</span>(yName, <span class="st">&quot;~&quot;</span>, aName, <span class="st">&quot;+&quot;</span>, bName))</span>
<span id="cb23-270"><a href="cambio-de-funciones.html#cb23-270" tabindex="-1"></a></span>
<span id="cb23-271"><a href="cambio-de-funciones.html#cb23-271" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">&quot;nested&quot;</span>) {</span>
<span id="cb23-272"><a href="cambio-de-funciones.html#cb23-272" tabindex="-1"></a>    numA <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(a)</span>
<span id="cb23-273"><a href="cambio-de-funciones.html#cb23-273" tabindex="-1"></a>    numB <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(b)</span>
<span id="cb23-274"><a href="cambio-de-funciones.html#cb23-274" tabindex="-1"></a>    numMPP <span class="ot">&lt;-</span> <span class="fu">length</span>(y) <span class="sc">/</span> (numB <span class="sc">*</span> numA)</span>
<span id="cb23-275"><a href="cambio-de-funciones.html#cb23-275" tabindex="-1"></a></span>
<span id="cb23-276"><a href="cambio-de-funciones.html#cb23-276" tabindex="-1"></a>    gdo<span class="sc">$</span>numO <span class="ot">&lt;-</span> numA</span>
<span id="cb23-277"><a href="cambio-de-funciones.html#cb23-277" tabindex="-1"></a>    gdo<span class="sc">$</span>numP <span class="ot">&lt;-</span> numB</span>
<span id="cb23-278"><a href="cambio-de-funciones.html#cb23-278" tabindex="-1"></a>    gdo<span class="sc">$</span>numM <span class="ot">&lt;-</span> numMPP</span>
<span id="cb23-279"><a href="cambio-de-funciones.html#cb23-279" tabindex="-1"></a></span>
<span id="cb23-280"><a href="cambio-de-funciones.html#cb23-280" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(nestedFormula, <span class="at">data =</span> gdo<span class="sc">$</span>X)</span>
<span id="cb23-281"><a href="cambio-de-funciones.html#cb23-281" tabindex="-1"></a>    meanSq <span class="ot">&lt;-</span> <span class="fu">anova</span>(fit)[, <span class="dv">3</span>]</span>
<span id="cb23-282"><a href="cambio-de-funciones.html#cb23-282" tabindex="-1"></a></span>
<span id="cb23-283"><a href="cambio-de-funciones.html#cb23-283" tabindex="-1"></a>    gdo<span class="sc">$</span>ANOVA <span class="ot">&lt;-</span> fit</span>
<span id="cb23-284"><a href="cambio-de-funciones.html#cb23-284" tabindex="-1"></a>    gdo<span class="sc">$</span>method <span class="ot">&lt;-</span> <span class="st">&quot;nested&quot;</span></span>
<span id="cb23-285"><a href="cambio-de-funciones.html#cb23-285" tabindex="-1"></a></span>
<span id="cb23-286"><a href="cambio-de-funciones.html#cb23-286" tabindex="-1"></a>    MSa <span class="ot">&lt;-</span> meanSq[<span class="dv">1</span>]</span>
<span id="cb23-287"><a href="cambio-de-funciones.html#cb23-287" tabindex="-1"></a>    MSab <span class="ot">&lt;-</span> meanSq[<span class="dv">2</span>]</span>
<span id="cb23-288"><a href="cambio-de-funciones.html#cb23-288" tabindex="-1"></a>    MSe <span class="ot">&lt;-</span> meanSq[<span class="dv">3</span>]</span>
<span id="cb23-289"><a href="cambio-de-funciones.html#cb23-289" tabindex="-1"></a></span>
<span id="cb23-290"><a href="cambio-de-funciones.html#cb23-290" tabindex="-1"></a>    Cerror <span class="ot">&lt;-</span> MSe</span>
<span id="cb23-291"><a href="cambio-de-funciones.html#cb23-291" tabindex="-1"></a>    Cb <span class="ot">&lt;-</span> (MSab <span class="sc">-</span> MSe) <span class="sc">/</span> numMPP</span>
<span id="cb23-292"><a href="cambio-de-funciones.html#cb23-292" tabindex="-1"></a>    Ca <span class="ot">&lt;-</span> (MSa <span class="sc">-</span> MSab) <span class="sc">/</span> (numB <span class="sc">*</span> numMPP)</span>
<span id="cb23-293"><a href="cambio-de-funciones.html#cb23-293" tabindex="-1"></a></span>
<span id="cb23-294"><a href="cambio-de-funciones.html#cb23-294" tabindex="-1"></a>    <span class="cf">if</span> (Ca <span class="sc">&lt;=</span> <span class="dv">0</span>) Ca <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-295"><a href="cambio-de-funciones.html#cb23-295" tabindex="-1"></a>    <span class="cf">if</span> (Cb <span class="sc">&lt;=</span> <span class="dv">0</span>) Cb <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-296"><a href="cambio-de-funciones.html#cb23-296" tabindex="-1"></a></span>
<span id="cb23-297"><a href="cambio-de-funciones.html#cb23-297" tabindex="-1"></a>    Cab <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-298"><a href="cambio-de-funciones.html#cb23-298" tabindex="-1"></a>    totalRR <span class="ot">&lt;-</span> Ca <span class="sc">+</span> Cab <span class="sc">+</span> Cerror</span>
<span id="cb23-299"><a href="cambio-de-funciones.html#cb23-299" tabindex="-1"></a>    repeatability <span class="ot">&lt;-</span> Cerror</span>
<span id="cb23-300"><a href="cambio-de-funciones.html#cb23-300" tabindex="-1"></a>    reproducibility <span class="ot">&lt;-</span> Ca</span>
<span id="cb23-301"><a href="cambio-de-funciones.html#cb23-301" tabindex="-1"></a>    bTob <span class="ot">&lt;-</span> Cb</span>
<span id="cb23-302"><a href="cambio-de-funciones.html#cb23-302" tabindex="-1"></a>    totalVar <span class="ot">&lt;-</span> Cb <span class="sc">+</span> Ca <span class="sc">+</span> Cab <span class="sc">+</span> Cerror</span>
<span id="cb23-303"><a href="cambio-de-funciones.html#cb23-303" tabindex="-1"></a></span>
<span id="cb23-304"><a href="cambio-de-funciones.html#cb23-304" tabindex="-1"></a>    estimates <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Cb =</span> Cb, <span class="at">Ca =</span> Ca, <span class="at">Cab =</span> Cab, <span class="at">Cerror =</span> Cerror)</span>
<span id="cb23-305"><a href="cambio-de-funciones.html#cb23-305" tabindex="-1"></a>    varcomp <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">totalRR =</span> totalRR, <span class="at">repeatability =</span> repeatability, <span class="at">reproducibility =</span> reproducibility, <span class="at">bTob =</span> bTob, <span class="at">totalVar =</span> totalVar)</span>
<span id="cb23-306"><a href="cambio-de-funciones.html#cb23-306" tabindex="-1"></a></span>
<span id="cb23-307"><a href="cambio-de-funciones.html#cb23-307" tabindex="-1"></a>    gdo<span class="sc">$</span>Estimates <span class="ot">&lt;-</span> estimates</span>
<span id="cb23-308"><a href="cambio-de-funciones.html#cb23-308" tabindex="-1"></a>    gdo<span class="sc">$</span>Varcomp <span class="ot">&lt;-</span> varcomp</span>
<span id="cb23-309"><a href="cambio-de-funciones.html#cb23-309" tabindex="-1"></a>  }</span>
<span id="cb23-310"><a href="cambio-de-funciones.html#cb23-310" tabindex="-1"></a></span>
<span id="cb23-311"><a href="cambio-de-funciones.html#cb23-311" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">&quot;crossed&quot;</span>) {</span>
<span id="cb23-312"><a href="cambio-de-funciones.html#cb23-312" tabindex="-1"></a>    numA <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(a)</span>
<span id="cb23-313"><a href="cambio-de-funciones.html#cb23-313" tabindex="-1"></a>    numB <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(b)</span>
<span id="cb23-314"><a href="cambio-de-funciones.html#cb23-314" tabindex="-1"></a>    numMPP <span class="ot">&lt;-</span> <span class="fu">length</span>(a) <span class="sc">/</span> (numA <span class="sc">*</span> numB)</span>
<span id="cb23-315"><a href="cambio-de-funciones.html#cb23-315" tabindex="-1"></a></span>
<span id="cb23-316"><a href="cambio-de-funciones.html#cb23-316" tabindex="-1"></a>    gdo<span class="sc">$</span>numO <span class="ot">&lt;-</span> numA</span>
<span id="cb23-317"><a href="cambio-de-funciones.html#cb23-317" tabindex="-1"></a>    gdo<span class="sc">$</span>numP <span class="ot">&lt;-</span> numB</span>
<span id="cb23-318"><a href="cambio-de-funciones.html#cb23-318" tabindex="-1"></a>    gdo<span class="sc">$</span>numM <span class="ot">&lt;-</span> numMPP</span>
<span id="cb23-319"><a href="cambio-de-funciones.html#cb23-319" tabindex="-1"></a></span>
<span id="cb23-320"><a href="cambio-de-funciones.html#cb23-320" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(crossedFormula, <span class="at">data =</span> gdo<span class="sc">$</span>X)</span>
<span id="cb23-321"><a href="cambio-de-funciones.html#cb23-321" tabindex="-1"></a>    model <span class="ot">&lt;-</span> <span class="fu">anova</span>(fit)</span>
<span id="cb23-322"><a href="cambio-de-funciones.html#cb23-322" tabindex="-1"></a></span>
<span id="cb23-323"><a href="cambio-de-funciones.html#cb23-323" tabindex="-1"></a>    gdo<span class="sc">$</span>ANOVA <span class="ot">&lt;-</span> fit</span>
<span id="cb23-324"><a href="cambio-de-funciones.html#cb23-324" tabindex="-1"></a>    gdo<span class="sc">$</span>method <span class="ot">&lt;-</span> <span class="st">&quot;crossed&quot;</span></span>
<span id="cb23-325"><a href="cambio-de-funciones.html#cb23-325" tabindex="-1"></a></span>
<span id="cb23-326"><a href="cambio-de-funciones.html#cb23-326" tabindex="-1"></a>    MSb <span class="ot">&lt;-</span> MSa <span class="ot">&lt;-</span> MSab <span class="ot">&lt;-</span> MSe <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-327"><a href="cambio-de-funciones.html#cb23-327" tabindex="-1"></a></span>
<span id="cb23-328"><a href="cambio-de-funciones.html#cb23-328" tabindex="-1"></a>    <span class="cf">if</span> (bName <span class="sc">%in%</span> <span class="fu">row.names</span>(model)) MSb <span class="ot">&lt;-</span> model[bName, <span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb23-329"><a href="cambio-de-funciones.html#cb23-329" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;missing factor&quot;</span>, bName, <span class="st">&quot;in model&quot;</span>))</span>
<span id="cb23-330"><a href="cambio-de-funciones.html#cb23-330" tabindex="-1"></a></span>
<span id="cb23-331"><a href="cambio-de-funciones.html#cb23-331" tabindex="-1"></a>    <span class="cf">if</span> (aName <span class="sc">%in%</span> <span class="fu">row.names</span>(model)) MSa <span class="ot">&lt;-</span> model[aName, <span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb23-332"><a href="cambio-de-funciones.html#cb23-332" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;missing factor&quot;</span>, aName, <span class="st">&quot;in model&quot;</span>))</span>
<span id="cb23-333"><a href="cambio-de-funciones.html#cb23-333" tabindex="-1"></a></span>
<span id="cb23-334"><a href="cambio-de-funciones.html#cb23-334" tabindex="-1"></a>    <span class="cf">if</span> (abName <span class="sc">%in%</span> <span class="fu">row.names</span>(model)) MSab <span class="ot">&lt;-</span> model[abName, <span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb23-335"><a href="cambio-de-funciones.html#cb23-335" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;missing interaction&quot;</span>, abName, <span class="st">&quot;in model&quot;</span>))</span>
<span id="cb23-336"><a href="cambio-de-funciones.html#cb23-336" tabindex="-1"></a></span>
<span id="cb23-337"><a href="cambio-de-funciones.html#cb23-337" tabindex="-1"></a>    <span class="cf">if</span> (<span class="st">&quot;Residuals&quot;</span> <span class="sc">%in%</span> <span class="fu">row.names</span>(model)) MSe <span class="ot">&lt;-</span> model[<span class="st">&quot;Residuals&quot;</span>, <span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb23-338"><a href="cambio-de-funciones.html#cb23-338" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">warning</span>(<span class="st">&quot;missing Residuals in model&quot;</span>)</span>
<span id="cb23-339"><a href="cambio-de-funciones.html#cb23-339" tabindex="-1"></a></span>
<span id="cb23-340"><a href="cambio-de-funciones.html#cb23-340" tabindex="-1"></a>    Cb <span class="ot">&lt;-</span> Ca <span class="ot">&lt;-</span> Cab <span class="ot">&lt;-</span> Cerror <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-341"><a href="cambio-de-funciones.html#cb23-341" tabindex="-1"></a></span>
<span id="cb23-342"><a href="cambio-de-funciones.html#cb23-342" tabindex="-1"></a>    Cb <span class="ot">&lt;-</span> (MSb <span class="sc">-</span> MSab) <span class="sc">/</span> (numA <span class="sc">*</span> numMPP)</span>
<span id="cb23-343"><a href="cambio-de-funciones.html#cb23-343" tabindex="-1"></a>    Ca <span class="ot">&lt;-</span> (MSa <span class="sc">-</span> MSab) <span class="sc">/</span> (numB <span class="sc">*</span> numMPP)</span>
<span id="cb23-344"><a href="cambio-de-funciones.html#cb23-344" tabindex="-1"></a>    Cab <span class="ot">&lt;-</span> (MSab <span class="sc">-</span> MSe) <span class="sc">/</span> numMPP</span>
<span id="cb23-345"><a href="cambio-de-funciones.html#cb23-345" tabindex="-1"></a>    Cerror <span class="ot">&lt;-</span> (MSe)</span>
<span id="cb23-346"><a href="cambio-de-funciones.html#cb23-346" tabindex="-1"></a></span>
<span id="cb23-347"><a href="cambio-de-funciones.html#cb23-347" tabindex="-1"></a>    gdo<span class="sc">$</span>RedANOVA <span class="ot">&lt;-</span> gdo<span class="sc">$</span>ANOVA</span>
<span id="cb23-348"><a href="cambio-de-funciones.html#cb23-348" tabindex="-1"></a></span>
<span id="cb23-349"><a href="cambio-de-funciones.html#cb23-349" tabindex="-1"></a>    <span class="cf">if</span> ((Cab <span class="sc">&lt;</span> <span class="dv">0</span>) <span class="sc">||</span> (model[abName, <span class="st">&quot;Pr(&gt;F)&quot;</span>] <span class="sc">&gt;=</span> alpha)) {</span>
<span id="cb23-350"><a href="cambio-de-funciones.html#cb23-350" tabindex="-1"></a>      redFit <span class="ot">&lt;-</span> <span class="fu">aov</span>(reducedFormula, <span class="at">data =</span> gdo<span class="sc">$</span>X)</span>
<span id="cb23-351"><a href="cambio-de-funciones.html#cb23-351" tabindex="-1"></a>      model <span class="ot">&lt;-</span> <span class="fu">anova</span>(redFit)</span>
<span id="cb23-352"><a href="cambio-de-funciones.html#cb23-352" tabindex="-1"></a></span>
<span id="cb23-353"><a href="cambio-de-funciones.html#cb23-353" tabindex="-1"></a>      MSb <span class="ot">&lt;-</span> MSa <span class="ot">&lt;-</span> MSab <span class="ot">&lt;-</span> MSe <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-354"><a href="cambio-de-funciones.html#cb23-354" tabindex="-1"></a></span>
<span id="cb23-355"><a href="cambio-de-funciones.html#cb23-355" tabindex="-1"></a>      <span class="cf">if</span> (bName <span class="sc">%in%</span> <span class="fu">row.names</span>(model)) MSb <span class="ot">&lt;-</span> model[bName, <span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb23-356"><a href="cambio-de-funciones.html#cb23-356" tabindex="-1"></a>      <span class="cf">else</span> <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;missing factor&quot;</span>, bName, <span class="st">&quot;in model&quot;</span>))</span>
<span id="cb23-357"><a href="cambio-de-funciones.html#cb23-357" tabindex="-1"></a></span>
<span id="cb23-358"><a href="cambio-de-funciones.html#cb23-358" tabindex="-1"></a>      <span class="cf">if</span> (aName <span class="sc">%in%</span> <span class="fu">row.names</span>(model)) MSa <span class="ot">&lt;-</span> model[aName, <span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb23-359"><a href="cambio-de-funciones.html#cb23-359" tabindex="-1"></a>      <span class="cf">else</span> <span class="fu">warning</span>(<span class="fu">paste</span>(<span class="st">&quot;missing factor&quot;</span>, aName, <span class="st">&quot;in model&quot;</span>))</span>
<span id="cb23-360"><a href="cambio-de-funciones.html#cb23-360" tabindex="-1"></a></span>
<span id="cb23-361"><a href="cambio-de-funciones.html#cb23-361" tabindex="-1"></a>      <span class="cf">if</span> (<span class="st">&quot;Residuals&quot;</span> <span class="sc">%in%</span> <span class="fu">row.names</span>(model)) MSe <span class="ot">&lt;-</span> model[<span class="st">&quot;Residuals&quot;</span>, <span class="st">&quot;Mean Sq&quot;</span>]</span>
<span id="cb23-362"><a href="cambio-de-funciones.html#cb23-362" tabindex="-1"></a>      <span class="cf">else</span> <span class="fu">warning</span>(<span class="st">&quot;missing Residuals in model&quot;</span>)</span>
<span id="cb23-363"><a href="cambio-de-funciones.html#cb23-363" tabindex="-1"></a></span>
<span id="cb23-364"><a href="cambio-de-funciones.html#cb23-364" tabindex="-1"></a>      Cb <span class="ot">&lt;-</span> Ca <span class="ot">&lt;-</span> Cab <span class="ot">&lt;-</span> Cerror <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-365"><a href="cambio-de-funciones.html#cb23-365" tabindex="-1"></a></span>
<span id="cb23-366"><a href="cambio-de-funciones.html#cb23-366" tabindex="-1"></a>      Cb <span class="ot">&lt;-</span> (MSb <span class="sc">-</span> MSe) <span class="sc">/</span> (numA <span class="sc">*</span> numMPP)</span>
<span id="cb23-367"><a href="cambio-de-funciones.html#cb23-367" tabindex="-1"></a>      Ca <span class="ot">&lt;-</span> (MSa <span class="sc">-</span> MSe) <span class="sc">/</span> (numB <span class="sc">*</span> numMPP)</span>
<span id="cb23-368"><a href="cambio-de-funciones.html#cb23-368" tabindex="-1"></a>      Cab <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-369"><a href="cambio-de-funciones.html#cb23-369" tabindex="-1"></a>      Cerror <span class="ot">&lt;-</span> (MSe)</span>
<span id="cb23-370"><a href="cambio-de-funciones.html#cb23-370" tabindex="-1"></a></span>
<span id="cb23-371"><a href="cambio-de-funciones.html#cb23-371" tabindex="-1"></a>      gdo<span class="sc">$</span>RedANOVA <span class="ot">&lt;-</span> redFit</span>
<span id="cb23-372"><a href="cambio-de-funciones.html#cb23-372" tabindex="-1"></a>    }</span>
<span id="cb23-373"><a href="cambio-de-funciones.html#cb23-373" tabindex="-1"></a></span>
<span id="cb23-374"><a href="cambio-de-funciones.html#cb23-374" tabindex="-1"></a>    gdo<span class="sc">$</span>method <span class="ot">&lt;-</span> <span class="st">&quot;crossed&quot;</span></span>
<span id="cb23-375"><a href="cambio-de-funciones.html#cb23-375" tabindex="-1"></a>    Ca <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, Ca)</span>
<span id="cb23-376"><a href="cambio-de-funciones.html#cb23-376" tabindex="-1"></a>    Cb <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, Cb)</span>
<span id="cb23-377"><a href="cambio-de-funciones.html#cb23-377" tabindex="-1"></a>    Cab <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, Cab)</span>
<span id="cb23-378"><a href="cambio-de-funciones.html#cb23-378" tabindex="-1"></a></span>
<span id="cb23-379"><a href="cambio-de-funciones.html#cb23-379" tabindex="-1"></a>    totalRR <span class="ot">&lt;-</span> Ca <span class="sc">+</span> Cab <span class="sc">+</span> Cerror</span>
<span id="cb23-380"><a href="cambio-de-funciones.html#cb23-380" tabindex="-1"></a>    repeatability <span class="ot">&lt;-</span> Cerror</span>
<span id="cb23-381"><a href="cambio-de-funciones.html#cb23-381" tabindex="-1"></a>    reproducibility <span class="ot">&lt;-</span> Ca <span class="sc">+</span> Cab</span>
<span id="cb23-382"><a href="cambio-de-funciones.html#cb23-382" tabindex="-1"></a>    bTob <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="dv">0</span>, Cb)</span>
<span id="cb23-383"><a href="cambio-de-funciones.html#cb23-383" tabindex="-1"></a>    totalVar <span class="ot">&lt;-</span> Cb <span class="sc">+</span> Ca <span class="sc">+</span> Cab <span class="sc">+</span> Cerror</span>
<span id="cb23-384"><a href="cambio-de-funciones.html#cb23-384" tabindex="-1"></a></span>
<span id="cb23-385"><a href="cambio-de-funciones.html#cb23-385" tabindex="-1"></a>    estimates <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">Cb =</span> Cb, <span class="at">Ca =</span> Ca, <span class="at">Cab =</span> Cab, <span class="at">Cerror =</span> Cerror)</span>
<span id="cb23-386"><a href="cambio-de-funciones.html#cb23-386" tabindex="-1"></a>    varcomp <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">totalRR =</span> totalRR, <span class="at">repeatability =</span> repeatability, <span class="at">reproducibility =</span> reproducibility, <span class="at">a =</span> Ca, <span class="at">a_b =</span> Cab, <span class="at">bTob =</span> bTob, <span class="at">totalVar =</span> totalVar)</span>
<span id="cb23-387"><a href="cambio-de-funciones.html#cb23-387" tabindex="-1"></a></span>
<span id="cb23-388"><a href="cambio-de-funciones.html#cb23-388" tabindex="-1"></a>    gdo<span class="sc">$</span>Estimates <span class="ot">&lt;-</span> estimates</span>
<span id="cb23-389"><a href="cambio-de-funciones.html#cb23-389" tabindex="-1"></a>    gdo<span class="sc">$</span>Varcomp <span class="ot">&lt;-</span> varcomp</span>
<span id="cb23-390"><a href="cambio-de-funciones.html#cb23-390" tabindex="-1"></a>  }</span>
<span id="cb23-391"><a href="cambio-de-funciones.html#cb23-391" tabindex="-1"></a></span>
<span id="cb23-392"><a href="cambio-de-funciones.html#cb23-392" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-393"><a href="cambio-de-funciones.html#cb23-393" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;AnOVa Table - &quot;</span>, gdo<span class="sc">$</span>method, <span class="st">&quot;Design</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb23-394"><a href="cambio-de-funciones.html#cb23-394" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(gdo<span class="sc">$</span>ANOVA))</span>
<span id="cb23-395"><a href="cambio-de-funciones.html#cb23-395" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-396"><a href="cambio-de-funciones.html#cb23-396" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;----------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-397"><a href="cambio-de-funciones.html#cb23-397" tabindex="-1"></a></span>
<span id="cb23-398"><a href="cambio-de-funciones.html#cb23-398" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">identical</span>(gdo<span class="sc">$</span>RedANOVA, gdo<span class="sc">$</span>ANOVA) <span class="sc">&amp;&amp;</span> gdo<span class="sc">$</span>method <span class="sc">==</span> <span class="st">&quot;crossed&quot;</span>) {</span>
<span id="cb23-399"><a href="cambio-de-funciones.html#cb23-399" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;AnOVa Table Without Interaction - &quot;</span>, gdo<span class="sc">$</span>method, <span class="st">&quot;Design</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb23-400"><a href="cambio-de-funciones.html#cb23-400" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">summary</span>(gdo<span class="sc">$</span>RedANOVA))</span>
<span id="cb23-401"><a href="cambio-de-funciones.html#cb23-401" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-402"><a href="cambio-de-funciones.html#cb23-402" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;----------</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-403"><a href="cambio-de-funciones.html#cb23-403" tabindex="-1"></a>  }</span>
<span id="cb23-404"><a href="cambio-de-funciones.html#cb23-404" tabindex="-1"></a></span>
<span id="cb23-405"><a href="cambio-de-funciones.html#cb23-405" tabindex="-1"></a>  Source <span class="ot">&lt;-</span> <span class="fu">names</span>(gdo<span class="sc">$</span>Varcomp)</span>
<span id="cb23-406"><a href="cambio-de-funciones.html#cb23-406" tabindex="-1"></a>  Source[Source <span class="sc">==</span> <span class="st">&quot;repeatability&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot; repeatability&quot;</span></span>
<span id="cb23-407"><a href="cambio-de-funciones.html#cb23-407" tabindex="-1"></a>  Source[Source <span class="sc">==</span> <span class="st">&quot;reproducibility&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot; reproducibility&quot;</span></span>
<span id="cb23-408"><a href="cambio-de-funciones.html#cb23-408" tabindex="-1"></a>  Source[Source <span class="sc">==</span> <span class="st">&quot;a_b&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;  &quot;</span>, abName)</span>
<span id="cb23-409"><a href="cambio-de-funciones.html#cb23-409" tabindex="-1"></a>  Source[Source <span class="sc">==</span> <span class="st">&quot;a&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;  &quot;</span>, aName)</span>
<span id="cb23-410"><a href="cambio-de-funciones.html#cb23-410" tabindex="-1"></a>  Source[Source <span class="sc">==</span> <span class="st">&quot;bTob&quot;</span>] <span class="ot">&lt;-</span> bTobName</span>
<span id="cb23-411"><a href="cambio-de-funciones.html#cb23-411" tabindex="-1"></a></span>
<span id="cb23-412"><a href="cambio-de-funciones.html#cb23-412" tabindex="-1"></a>  VarComp <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(gdo<span class="sc">$</span>Varcomp[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gdo<span class="sc">$</span>Varcomp))]), <span class="dv">3</span>)</span>
<span id="cb23-413"><a href="cambio-de-funciones.html#cb23-413" tabindex="-1"></a>  Contribution <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(gdo<span class="sc">$</span>Varcomp[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gdo<span class="sc">$</span>Varcomp))]) <span class="sc">/</span> <span class="fu">as.numeric</span>(gdo<span class="sc">$</span>Varcomp[<span class="fu">length</span>(gdo<span class="sc">$</span>Varcomp)]), <span class="dv">3</span>)</span>
<span id="cb23-414"><a href="cambio-de-funciones.html#cb23-414" tabindex="-1"></a>  VarComp <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">data.frame</span>(gdo<span class="sc">$</span>Varcomp))</span>
<span id="cb23-415"><a href="cambio-de-funciones.html#cb23-415" tabindex="-1"></a>  VarCompContrib <span class="ot">&lt;-</span> VarComp <span class="sc">/</span> gdo<span class="sc">$</span>Varcomp<span class="sc">$</span>totalVar</span>
<span id="cb23-416"><a href="cambio-de-funciones.html#cb23-416" tabindex="-1"></a>  Stdev <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(VarComp)</span>
<span id="cb23-417"><a href="cambio-de-funciones.html#cb23-417" tabindex="-1"></a>  StudyVar <span class="ot">&lt;-</span> Stdev <span class="sc">*</span> gdo<span class="sc">$</span>Sigma</span>
<span id="cb23-418"><a href="cambio-de-funciones.html#cb23-418" tabindex="-1"></a>  StudyVarContrib <span class="ot">&lt;-</span> StudyVar <span class="sc">/</span> StudyVar[<span class="st">&quot;totalVar&quot;</span>, ]</span>
<span id="cb23-419"><a href="cambio-de-funciones.html#cb23-419" tabindex="-1"></a>  SNR <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb23-420"><a href="cambio-de-funciones.html#cb23-420" tabindex="-1"></a>  ptRatio <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb23-421"><a href="cambio-de-funciones.html#cb23-421" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb23-422"><a href="cambio-de-funciones.html#cb23-422" tabindex="-1"></a></span>
<span id="cb23-423"><a href="cambio-de-funciones.html#cb23-423" tabindex="-1"></a>  <span class="cf">if</span> ((<span class="fu">length</span>(gdo<span class="sc">$</span>GageTolerance) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">&amp;&amp;</span> (gdo<span class="sc">$</span>GageTolerance <span class="sc">&gt;</span> <span class="dv">0</span>)) {</span>
<span id="cb23-424"><a href="cambio-de-funciones.html#cb23-424" tabindex="-1"></a>    ptRatio <span class="ot">&lt;-</span> StudyVar <span class="sc">/</span> gdo<span class="sc">$</span>GageTolerance</span>
<span id="cb23-425"><a href="cambio-de-funciones.html#cb23-425" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(VarComp, VarCompContrib, Stdev, StudyVar, StudyVarContrib, ptRatio)</span>
<span id="cb23-426"><a href="cambio-de-funciones.html#cb23-426" tabindex="-1"></a>    <span class="fu">names</span>(temp)[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;P/T Ratio&quot;</span>)</span>
<span id="cb23-427"><a href="cambio-de-funciones.html#cb23-427" tabindex="-1"></a>    <span class="fu">row.names</span>(temp) <span class="ot">&lt;-</span> <span class="fu">c</span>(Source)</span>
<span id="cb23-428"><a href="cambio-de-funciones.html#cb23-428" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-429"><a href="cambio-de-funciones.html#cb23-429" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(VarComp, VarCompContrib, Stdev, StudyVar, StudyVarContrib)</span>
<span id="cb23-430"><a href="cambio-de-funciones.html#cb23-430" tabindex="-1"></a>    <span class="fu">row.names</span>(temp) <span class="ot">&lt;-</span> <span class="fu">c</span>(Source)</span>
<span id="cb23-431"><a href="cambio-de-funciones.html#cb23-431" tabindex="-1"></a>  }</span>
<span id="cb23-432"><a href="cambio-de-funciones.html#cb23-432" tabindex="-1"></a></span>
<span id="cb23-433"><a href="cambio-de-funciones.html#cb23-433" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-434"><a href="cambio-de-funciones.html#cb23-434" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Gage R&amp;R</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-435"><a href="cambio-de-funciones.html#cb23-435" tabindex="-1"></a>  tempout <span class="ot">&lt;-</span> temp</span>
<span id="cb23-436"><a href="cambio-de-funciones.html#cb23-436" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">format</span>(tempout, <span class="at">digits =</span> dig))</span>
<span id="cb23-437"><a href="cambio-de-funciones.html#cb23-437" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-438"><a href="cambio-de-funciones.html#cb23-438" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;---</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-439"><a href="cambio-de-funciones.html#cb23-439" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot; * Contrib equals Contribution in %</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-440"><a href="cambio-de-funciones.html#cb23-440" tabindex="-1"></a></span>
<span id="cb23-441"><a href="cambio-de-funciones.html#cb23-441" tabindex="-1"></a>  SNRTemp <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span>) <span class="sc">*</span> (temp[bTobName, <span class="st">&quot;Stdev&quot;</span>] <span class="sc">/</span> temp[<span class="st">&quot;totalRR&quot;</span>, <span class="st">&quot;Stdev&quot;</span>])</span>
<span id="cb23-442"><a href="cambio-de-funciones.html#cb23-442" tabindex="-1"></a>  <span class="cf">if</span> (SNRTemp <span class="sc">&gt;</span> <span class="dv">1</span>) SNR <span class="ot">&lt;-</span> SNRTemp</span>
<span id="cb23-443"><a href="cambio-de-funciones.html#cb23-443" tabindex="-1"></a></span>
<span id="cb23-444"><a href="cambio-de-funciones.html#cb23-444" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot; **Number of Distinct Categories (truncated signal-to-noise-ratio) =&quot;</span>, <span class="fu">floor</span>(SNR), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb23-445"><a href="cambio-de-funciones.html#cb23-445" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb23-446"><a href="cambio-de-funciones.html#cb23-446" tabindex="-1"></a>  <span class="fu">invisible</span>(gdo)</span>
<span id="cb23-447"><a href="cambio-de-funciones.html#cb23-447" tabindex="-1"></a>}</span>
<span id="cb23-448"><a href="cambio-de-funciones.html#cb23-448" tabindex="-1"></a><span class="fu">setMethod</span>(<span class="st">&quot;plot&quot;</span>, <span class="fu">signature</span>(<span class="at">x =</span> <span class="st">&quot;gageRR&quot;</span>), <span class="cf">function</span>(x, y, <span class="at">main=</span><span class="cn">NULL</span>, <span class="at">xlab=</span><span class="cn">NULL</span>, <span class="at">ylab=</span><span class="cn">NULL</span>, col, lwd, <span class="at">fun =</span> mean, ...) {</span>
<span id="cb23-449"><a href="cambio-de-funciones.html#cb23-449" tabindex="-1"></a>  gdo <span class="ot">&lt;-</span> x</span>
<span id="cb23-450"><a href="cambio-de-funciones.html#cb23-450" tabindex="-1"></a>  yName <span class="ot">&lt;-</span> x<span class="sc">$</span>facNames[<span class="dv">1</span>]</span>
<span id="cb23-451"><a href="cambio-de-funciones.html#cb23-451" tabindex="-1"></a>  aName <span class="ot">&lt;-</span> x<span class="sc">$</span>facNames[<span class="dv">2</span>]</span>
<span id="cb23-452"><a href="cambio-de-funciones.html#cb23-452" tabindex="-1"></a>  bName <span class="ot">&lt;-</span> x<span class="sc">$</span>facNames[<span class="dv">3</span>]</span>
<span id="cb23-453"><a href="cambio-de-funciones.html#cb23-453" tabindex="-1"></a>  abName <span class="ot">&lt;-</span> <span class="fu">paste</span>(aName, <span class="st">&quot;:&quot;</span>, bName, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb23-454"><a href="cambio-de-funciones.html#cb23-454" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(col))</span>
<span id="cb23-455"><a href="cambio-de-funciones.html#cb23-455" tabindex="-1"></a>    col <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span>(<span class="fu">length</span>(<span class="fu">unique</span>(gdo<span class="sc">$</span>b)) <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb23-456"><a href="cambio-de-funciones.html#cb23-456" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(lwd))</span>
<span id="cb23-457"><a href="cambio-de-funciones.html#cb23-457" tabindex="-1"></a>    lwd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb23-458"><a href="cambio-de-funciones.html#cb23-458" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb23-459"><a href="cambio-de-funciones.html#cb23-459" tabindex="-1"></a>  Source <span class="ot">&lt;-</span> <span class="fu">names</span>(gdo<span class="sc">$</span>Varcomp)</span>
<span id="cb23-460"><a href="cambio-de-funciones.html#cb23-460" tabindex="-1"></a>  VarComp <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(gdo<span class="sc">$</span>Varcomp), <span class="dv">3</span>)</span>
<span id="cb23-461"><a href="cambio-de-funciones.html#cb23-461" tabindex="-1"></a>  Contribution <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(gdo<span class="sc">$</span>Varcomp) <span class="sc">/</span> <span class="fu">as.numeric</span>(gdo<span class="sc">$</span>Varcomp[<span class="fu">length</span>(gdo<span class="sc">$</span>Varcomp)]), <span class="dv">3</span>)</span>
<span id="cb23-462"><a href="cambio-de-funciones.html#cb23-462" tabindex="-1"></a>  VarComp <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">data.frame</span>(gdo<span class="sc">$</span>Varcomp))</span>
<span id="cb23-463"><a href="cambio-de-funciones.html#cb23-463" tabindex="-1"></a>  VarCompContrib <span class="ot">&lt;-</span> VarComp <span class="sc">/</span> gdo<span class="sc">$</span>Varcomp<span class="sc">$</span>totalVar</span>
<span id="cb23-464"><a href="cambio-de-funciones.html#cb23-464" tabindex="-1"></a>  Stdev <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(VarComp)</span>
<span id="cb23-465"><a href="cambio-de-funciones.html#cb23-465" tabindex="-1"></a>  StudyVar <span class="ot">&lt;-</span> Stdev <span class="sc">*</span> gdo<span class="sc">$</span>Sigma</span>
<span id="cb23-466"><a href="cambio-de-funciones.html#cb23-466" tabindex="-1"></a>  StudyVarContrib <span class="ot">&lt;-</span> StudyVar <span class="sc">/</span> StudyVar[<span class="st">&quot;totalVar&quot;</span>, ]</span>
<span id="cb23-467"><a href="cambio-de-funciones.html#cb23-467" tabindex="-1"></a>  <span class="cf">if</span> ((<span class="fu">length</span>(gdo<span class="sc">$</span>GageTolerance) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">&amp;&amp;</span> (gdo<span class="sc">$</span>GageTolerance <span class="sc">&gt;</span> <span class="dv">0</span>)) {</span>
<span id="cb23-468"><a href="cambio-de-funciones.html#cb23-468" tabindex="-1"></a>    ptRatio <span class="ot">&lt;-</span> StudyVar <span class="sc">/</span> gdo<span class="sc">$</span>GageTolerance</span>
<span id="cb23-469"><a href="cambio-de-funciones.html#cb23-469" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(VarComp, VarCompContrib, Stdev, StudyVar, StudyVarContrib, ptRatio)</span>
<span id="cb23-470"><a href="cambio-de-funciones.html#cb23-470" tabindex="-1"></a>    contribFrame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(VarCompContrib, StudyVarContrib, ptRatio)</span>
<span id="cb23-471"><a href="cambio-de-funciones.html#cb23-471" tabindex="-1"></a>    <span class="fu">names</span>(temp)[<span class="dv">6</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;P/T Ratio&quot;</span>)</span>
<span id="cb23-472"><a href="cambio-de-funciones.html#cb23-472" tabindex="-1"></a>    <span class="fu">row.names</span>(temp) <span class="ot">&lt;-</span> <span class="fu">c</span>(Source)</span>
<span id="cb23-473"><a href="cambio-de-funciones.html#cb23-473" tabindex="-1"></a>    SNR <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> (temp[<span class="st">&quot;bTob&quot;</span>, <span class="st">&quot;VarComp&quot;</span>] <span class="sc">/</span> temp[<span class="st">&quot;totalRR&quot;</span>, <span class="st">&quot;VarComp&quot;</span>]))</span>
<span id="cb23-474"><a href="cambio-de-funciones.html#cb23-474" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb23-475"><a href="cambio-de-funciones.html#cb23-475" tabindex="-1"></a>    temp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(VarComp, VarCompContrib, Stdev, StudyVar, StudyVarContrib)</span>
<span id="cb23-476"><a href="cambio-de-funciones.html#cb23-476" tabindex="-1"></a>    contribFrame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(VarCompContrib, StudyVarContrib)</span>
<span id="cb23-477"><a href="cambio-de-funciones.html#cb23-477" tabindex="-1"></a>  }</span>
<span id="cb23-478"><a href="cambio-de-funciones.html#cb23-478" tabindex="-1"></a>  bTob <span class="ot">&lt;-</span> <span class="fu">paste</span>(bName, <span class="st">&quot;To&quot;</span>, bName, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb23-479"><a href="cambio-de-funciones.html#cb23-479" tabindex="-1"></a>  Source[Source <span class="sc">==</span> <span class="st">&quot;bTob&quot;</span>] <span class="ot">&lt;-</span> bTob</span>
<span id="cb23-480"><a href="cambio-de-funciones.html#cb23-480" tabindex="-1"></a>  <span class="fu">row.names</span>(contribFrame) <span class="ot">&lt;-</span> Source</span>
<span id="cb23-481"><a href="cambio-de-funciones.html#cb23-481" tabindex="-1"></a>  <span class="cf">if</span> (gdo<span class="sc">$</span>method <span class="sc">==</span> <span class="st">&quot;crossed&quot;</span>)</span>
<span id="cb23-482"><a href="cambio-de-funciones.html#cb23-482" tabindex="-1"></a>    contribFrame <span class="ot">&lt;-</span> contribFrame[<span class="sc">-</span><span class="fu">match</span>(<span class="fu">c</span>(<span class="st">&quot;totalVar&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;a_b&quot;</span>), <span class="fu">row.names</span>(temp)), ]</span>
<span id="cb23-483"><a href="cambio-de-funciones.html#cb23-483" tabindex="-1"></a>  <span class="cf">else</span> contribFrame <span class="ot">&lt;-</span> contribFrame[<span class="sc">-</span><span class="fu">match</span>(<span class="fu">c</span>(<span class="st">&quot;totalVar&quot;</span>), <span class="fu">row.names</span>(temp)), ]</span>
<span id="cb23-484"><a href="cambio-de-funciones.html#cb23-484" tabindex="-1"></a>  numBars <span class="ot">&lt;-</span><span class="fu">ncol</span>(contribFrame)</span>
<span id="cb23-485"><a href="cambio-de-funciones.html#cb23-485" tabindex="-1"></a>  <span class="co"># Convertir los datos en un formato adecuado</span></span>
<span id="cb23-486"><a href="cambio-de-funciones.html#cb23-486" tabindex="-1"></a>  contrib_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(contribFrame)</span>
<span id="cb23-487"><a href="cambio-de-funciones.html#cb23-487" tabindex="-1"></a>  contrib_df<span class="sc">$</span>component <span class="ot">&lt;-</span> <span class="fu">rownames</span>(contribFrame)</span>
<span id="cb23-488"><a href="cambio-de-funciones.html#cb23-488" tabindex="-1"></a>  contrib_df <span class="ot">&lt;-</span> contrib_df <span class="sc">%&gt;%</span></span>
<span id="cb23-489"><a href="cambio-de-funciones.html#cb23-489" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;Source&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-490"><a href="cambio-de-funciones.html#cb23-490" tabindex="-1"></a>    <span class="fu">filter</span>(Source <span class="sc">!=</span> <span class="st">&quot;totalVar&quot;</span>)</span>
<span id="cb23-491"><a href="cambio-de-funciones.html#cb23-491" tabindex="-1"></a>  ymax <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">max</span>(contribFrame))</span>
<span id="cb23-492"><a href="cambio-de-funciones.html#cb23-492" tabindex="-1"></a>  main1 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb23-493"><a href="cambio-de-funciones.html#cb23-493" tabindex="-1"></a>  <span class="co"># Crear el gráfico</span></span>
<span id="cb23-494"><a href="cambio-de-funciones.html#cb23-494" tabindex="-1"></a>  <span class="co">#  format for ggplot2</span></span>
<span id="cb23-495"><a href="cambio-de-funciones.html#cb23-495" tabindex="-1"></a>  contribFrame_long <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(contribFrame)</span>
<span id="cb23-496"><a href="cambio-de-funciones.html#cb23-496" tabindex="-1"></a>  contribFrame_long<span class="sc">$</span>Component <span class="ot">&lt;-</span> <span class="fu">rownames</span>(contribFrame_long)</span>
<span id="cb23-497"><a href="cambio-de-funciones.html#cb23-497" tabindex="-1"></a>  contribFrame_long <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">gather</span>(contribFrame_long, <span class="at">key =</span> <span class="st">&quot;Metric&quot;</span>, <span class="at">value =</span> <span class="st">&quot;Value&quot;</span>, <span class="sc">-</span>Component)</span>
<span id="cb23-498"><a href="cambio-de-funciones.html#cb23-498" tabindex="-1"></a>  <span class="co"># Components of Variation</span></span>
<span id="cb23-499"><a href="cambio-de-funciones.html#cb23-499" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(contribFrame_long, <span class="fu">aes</span>(<span class="at">x =</span> Component, <span class="at">y =</span> Value, <span class="at">fill =</span> Metric)) <span class="sc">+</span></span>
<span id="cb23-500"><a href="cambio-de-funciones.html#cb23-500" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-501"><a href="cambio-de-funciones.html#cb23-501" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(main[<span class="dv">1</span>]), <span class="st">&quot;Components of Variation&quot;</span>, main[<span class="dv">1</span>]),</span>
<span id="cb23-502"><a href="cambio-de-funciones.html#cb23-502" tabindex="-1"></a>         <span class="at">x =</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(xlab[<span class="dv">1</span>]), <span class="st">&quot;Component&quot;</span>, xlab[<span class="dv">1</span>]),</span>
<span id="cb23-503"><a href="cambio-de-funciones.html#cb23-503" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(ylab[<span class="dv">1</span>]), <span class="st">&quot;&quot;</span>, ylab[<span class="dv">1</span>])) <span class="sc">+</span></span>
<span id="cb23-504"><a href="cambio-de-funciones.html#cb23-504" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-505"><a href="cambio-de-funciones.html#cb23-505" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> col[<span class="dv">1</span><span class="sc">:</span><span class="fu">nlevels</span>(<span class="fu">factor</span>(contribFrame_long<span class="sc">$</span>Metric))])</span>
<span id="cb23-506"><a href="cambio-de-funciones.html#cb23-506" tabindex="-1"></a></span>
<span id="cb23-507"><a href="cambio-de-funciones.html#cb23-507" tabindex="-1"></a>  <span class="fu">print</span>(p1)</span>
<span id="cb23-508"><a href="cambio-de-funciones.html#cb23-508" tabindex="-1"></a>  <span class="co">#Measurement by part</span></span>
<span id="cb23-509"><a href="cambio-de-funciones.html#cb23-509" tabindex="-1"></a>  main2<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb23-510"><a href="cambio-de-funciones.html#cb23-510" tabindex="-1"></a>  <span class="cf">if</span> (gdo<span class="sc">$</span>method <span class="sc">==</span> <span class="st">&quot;crossed&quot;</span>) {</span>
<span id="cb23-511"><a href="cambio-de-funciones.html#cb23-511" tabindex="-1"></a>    main2 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb23-512"><a href="cambio-de-funciones.html#cb23-512" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">missing</span>(main) <span class="sc">||</span> <span class="fu">is.na</span>(main[<span class="dv">2</span>]))</span>
<span id="cb23-513"><a href="cambio-de-funciones.html#cb23-513" tabindex="-1"></a>      main2 <span class="ot">&lt;-</span> <span class="fu">paste</span>(yName, <span class="st">&quot;by&quot;</span>, bName)</span>
<span id="cb23-514"><a href="cambio-de-funciones.html#cb23-514" tabindex="-1"></a>    <span class="cf">else</span> main2 <span class="ot">&lt;-</span> main[<span class="dv">2</span>]</span>
<span id="cb23-515"><a href="cambio-de-funciones.html#cb23-515" tabindex="-1"></a>    xlab2 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb23-516"><a href="cambio-de-funciones.html#cb23-516" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">missing</span>(xlab) <span class="sc">||</span> <span class="fu">is.na</span>(xlab[<span class="dv">2</span>]))</span>
<span id="cb23-517"><a href="cambio-de-funciones.html#cb23-517" tabindex="-1"></a>      xlab2 <span class="ot">&lt;-</span> bName</span>
<span id="cb23-518"><a href="cambio-de-funciones.html#cb23-518" tabindex="-1"></a>    <span class="cf">else</span> xlab2 <span class="ot">&lt;-</span> xlab[<span class="dv">2</span>]</span>
<span id="cb23-519"><a href="cambio-de-funciones.html#cb23-519" tabindex="-1"></a>    ylab2 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb23-520"><a href="cambio-de-funciones.html#cb23-520" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">missing</span>(ylab) <span class="sc">||</span> <span class="fu">is.na</span>(ylab[<span class="dv">2</span>]))</span>
<span id="cb23-521"><a href="cambio-de-funciones.html#cb23-521" tabindex="-1"></a>      ylab2 <span class="ot">&lt;-</span> yName</span>
<span id="cb23-522"><a href="cambio-de-funciones.html#cb23-522" tabindex="-1"></a>    <span class="cf">else</span> ylab2 <span class="ot">&lt;-</span> ylab[<span class="dv">2</span>]</span>
<span id="cb23-523"><a href="cambio-de-funciones.html#cb23-523" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gdo<span class="sc">$</span>X, <span class="fu">aes_string</span>(<span class="at">x =</span> bName, <span class="at">y =</span> yName)) <span class="sc">+</span></span>
<span id="cb23-524"><a href="cambio-de-funciones.html#cb23-524" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb23-525"><a href="cambio-de-funciones.html#cb23-525" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">fun =</span> median, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> lwd) <span class="sc">+</span></span>
<span id="cb23-526"><a href="cambio-de-funciones.html#cb23-526" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">fun =</span> median, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-527"><a href="cambio-de-funciones.html#cb23-527" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(main2), <span class="fu">paste</span>(yName, <span class="st">&quot;by&quot;</span>, bName), main2),</span>
<span id="cb23-528"><a href="cambio-de-funciones.html#cb23-528" tabindex="-1"></a>         <span class="at">x =</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(xlab2), bName, xlab2),</span>
<span id="cb23-529"><a href="cambio-de-funciones.html#cb23-529" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(ylab2), yName, ylab2)) <span class="sc">+</span></span>
<span id="cb23-530"><a href="cambio-de-funciones.html#cb23-530" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb23-531"><a href="cambio-de-funciones.html#cb23-531" tabindex="-1"></a></span>
<span id="cb23-532"><a href="cambio-de-funciones.html#cb23-532" tabindex="-1"></a>  <span class="fu">print</span>(p2)</span>
<span id="cb23-533"><a href="cambio-de-funciones.html#cb23-533" tabindex="-1"></a>  <span class="co">#Measurement by operator</span></span>
<span id="cb23-534"><a href="cambio-de-funciones.html#cb23-534" tabindex="-1"></a>  main3 <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb23-535"><a href="cambio-de-funciones.html#cb23-535" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(main) <span class="sc">||</span> <span class="fu">is.na</span>(main[<span class="dv">3</span>]))</span>
<span id="cb23-536"><a href="cambio-de-funciones.html#cb23-536" tabindex="-1"></a>    main3 <span class="ot">=</span> <span class="fu">paste</span>(yName, <span class="st">&quot;by&quot;</span>, aName)</span>
<span id="cb23-537"><a href="cambio-de-funciones.html#cb23-537" tabindex="-1"></a>  <span class="cf">else</span> main3 <span class="ot">=</span> main[<span class="dv">3</span>]</span>
<span id="cb23-538"><a href="cambio-de-funciones.html#cb23-538" tabindex="-1"></a>  xlab3 <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb23-539"><a href="cambio-de-funciones.html#cb23-539" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(xlab) <span class="sc">||</span> <span class="fu">is.na</span>(xlab[<span class="dv">3</span>]))</span>
<span id="cb23-540"><a href="cambio-de-funciones.html#cb23-540" tabindex="-1"></a>    xlab3 <span class="ot">=</span> aName</span>
<span id="cb23-541"><a href="cambio-de-funciones.html#cb23-541" tabindex="-1"></a>  <span class="cf">else</span> xlab3 <span class="ot">=</span> xlab[<span class="dv">3</span>]</span>
<span id="cb23-542"><a href="cambio-de-funciones.html#cb23-542" tabindex="-1"></a>  ylab3 <span class="ot">=</span> <span class="cn">NA</span></span>
<span id="cb23-543"><a href="cambio-de-funciones.html#cb23-543" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(ylab) <span class="sc">||</span> <span class="fu">is.na</span>(ylab[<span class="dv">3</span>]))</span>
<span id="cb23-544"><a href="cambio-de-funciones.html#cb23-544" tabindex="-1"></a>    ylab3 <span class="ot">=</span> yName</span>
<span id="cb23-545"><a href="cambio-de-funciones.html#cb23-545" tabindex="-1"></a>  <span class="cf">else</span> ylab3 <span class="ot">=</span> ylab[<span class="dv">3</span>]</span>
<span id="cb23-546"><a href="cambio-de-funciones.html#cb23-546" tabindex="-1"></a></span>
<span id="cb23-547"><a href="cambio-de-funciones.html#cb23-547" tabindex="-1"></a>  p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(gdo<span class="sc">$</span>X, <span class="fu">aes_string</span>(<span class="at">x =</span> aName, <span class="at">y =</span> yName)) <span class="sc">+</span></span>
<span id="cb23-548"><a href="cambio-de-funciones.html#cb23-548" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(gdo<span class="sc">$</span>X[, <span class="dv">3</span>]))) <span class="sc">+</span></span>
<span id="cb23-549"><a href="cambio-de-funciones.html#cb23-549" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">fun =</span> median, <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>), <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> lwd) <span class="sc">+</span></span>
<span id="cb23-550"><a href="cambio-de-funciones.html#cb23-550" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">fun =</span> median, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-551"><a href="cambio-de-funciones.html#cb23-551" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(main[<span class="dv">3</span>]), <span class="fu">paste</span>(yName, <span class="st">&quot;by&quot;</span>, aName), main[<span class="dv">3</span>]),</span>
<span id="cb23-552"><a href="cambio-de-funciones.html#cb23-552" tabindex="-1"></a>         <span class="at">x =</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(xlab[<span class="dv">3</span>]), aName, xlab[<span class="dv">3</span>]),</span>
<span id="cb23-553"><a href="cambio-de-funciones.html#cb23-553" tabindex="-1"></a>         <span class="at">y =</span> <span class="fu">ifelse</span>(<span class="fu">is.null</span>(ylab[<span class="dv">3</span>]), yName, ylab[<span class="dv">3</span>]),</span>
<span id="cb23-554"><a href="cambio-de-funciones.html#cb23-554" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">&quot;Factor&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-555"><a href="cambio-de-funciones.html#cb23-555" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-556"><a href="cambio-de-funciones.html#cb23-556" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> col)</span>
<span id="cb23-557"><a href="cambio-de-funciones.html#cb23-557" tabindex="-1"></a></span>
<span id="cb23-558"><a href="cambio-de-funciones.html#cb23-558" tabindex="-1"></a>  <span class="fu">print</span>(p3)</span>
<span id="cb23-559"><a href="cambio-de-funciones.html#cb23-559" tabindex="-1"></a>  <span class="co">#R chart</span></span>
<span id="cb23-560"><a href="cambio-de-funciones.html#cb23-560" tabindex="-1"></a>  main4 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb23-561"><a href="cambio-de-funciones.html#cb23-561" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(main) <span class="sc">||</span> <span class="fu">is.na</span>(main[<span class="dv">4</span>]))</span>
<span id="cb23-562"><a href="cambio-de-funciones.html#cb23-562" tabindex="-1"></a>    main4 <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Interaction&quot;</span>, abName)</span>
<span id="cb23-563"><a href="cambio-de-funciones.html#cb23-563" tabindex="-1"></a>  <span class="cf">else</span> main4 <span class="ot">&lt;-</span> main[<span class="dv">4</span>]</span>
<span id="cb23-564"><a href="cambio-de-funciones.html#cb23-564" tabindex="-1"></a></span>
<span id="cb23-565"><a href="cambio-de-funciones.html#cb23-565" tabindex="-1"></a>  xlab4 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb23-566"><a href="cambio-de-funciones.html#cb23-566" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(xlab) <span class="sc">||</span> <span class="fu">is.na</span>(xlab[<span class="dv">4</span>]))</span>
<span id="cb23-567"><a href="cambio-de-funciones.html#cb23-567" tabindex="-1"></a>    xlab4 <span class="ot">&lt;-</span> <span class="fu">colnames</span>(gdo<span class="sc">$</span>X)[<span class="dv">4</span>]</span>
<span id="cb23-568"><a href="cambio-de-funciones.html#cb23-568" tabindex="-1"></a>  <span class="cf">else</span> xlab4 <span class="ot">&lt;-</span> xlab[<span class="dv">4</span>]</span>
<span id="cb23-569"><a href="cambio-de-funciones.html#cb23-569" tabindex="-1"></a></span>
<span id="cb23-570"><a href="cambio-de-funciones.html#cb23-570" tabindex="-1"></a>  ylab4 <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb23-571"><a href="cambio-de-funciones.html#cb23-571" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(ylab) <span class="sc">||</span> <span class="fu">is.na</span>(ylab[<span class="dv">4</span>]))</span>
<span id="cb23-572"><a href="cambio-de-funciones.html#cb23-572" tabindex="-1"></a>    ylab4 <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">as.character</span>(<span class="fu">body</span>(<span class="fu">match.fun</span>(fun)))[<span class="dv">2</span>], <span class="st">&quot;of&quot;</span>, <span class="fu">colnames</span>(gdo<span class="sc">$</span>X)[<span class="dv">5</span>])</span>
<span id="cb23-573"><a href="cambio-de-funciones.html#cb23-573" tabindex="-1"></a>  <span class="cf">else</span> ylab4 <span class="ot">&lt;-</span> ylab[<span class="dv">4</span>]</span>
<span id="cb23-574"><a href="cambio-de-funciones.html#cb23-574" tabindex="-1"></a>  agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gdo<span class="sc">$</span>X[, yName], <span class="fu">list</span>(gdo<span class="sc">$</span>X[, aName], gdo<span class="sc">$</span>X[, bName]), <span class="at">FUN =</span> mean)</span>
<span id="cb23-575"><a href="cambio-de-funciones.html#cb23-575" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">table</span>(agg[, <span class="dv">2</span>])</span>
<span id="cb23-576"><a href="cambio-de-funciones.html#cb23-576" tabindex="-1"></a>  sgSize <span class="ot">&lt;-</span> tab[<span class="dv">1</span>]</span>
<span id="cb23-577"><a href="cambio-de-funciones.html#cb23-577" tabindex="-1"></a>  old.par <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>mar</span>
<span id="cb23-578"><a href="cambio-de-funciones.html#cb23-578" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">10.1</span>))</span>
<span id="cb23-579"><a href="cambio-de-funciones.html#cb23-579" tabindex="-1"></a>  <span class="fu">.aip</span>(gdo<span class="sc">$</span>X[, <span class="dv">4</span>], gdo<span class="sc">$</span>X[, <span class="dv">3</span>], <span class="at">response =</span> gdo<span class="sc">$</span>X[, <span class="dv">5</span>], <span class="at">xlab =</span> xlab4, <span class="at">ylab =</span> ylab4, <span class="at">title =</span> <span class="st">&quot;Interaction Operator: Part&quot;</span>, <span class="at">legend =</span> <span class="cn">TRUE</span>,<span class="at">col =</span> col, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, ...)</span>
<span id="cb23-580"><a href="cambio-de-funciones.html#cb23-580" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> old.par)</span>
<span id="cb23-581"><a href="cambio-de-funciones.html#cb23-581" tabindex="-1"></a>  <span class="co"># Convertir datos a formato adecuado</span></span>
<span id="cb23-582"><a href="cambio-de-funciones.html#cb23-582" tabindex="-1"></a>  D3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.076</span>, <span class="fl">0.136</span>, <span class="fl">0.184</span>, <span class="fl">0.223</span>, <span class="fl">0.256</span>, <span class="fl">0.284</span>, <span class="fl">0.308</span>, <span class="fl">0.329</span>, <span class="fl">0.348</span>)</span>
<span id="cb23-583"><a href="cambio-de-funciones.html#cb23-583" tabindex="-1"></a>  D4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3.267</span>, <span class="fl">2.574</span>, <span class="fl">2.282</span>, <span class="fl">2.115</span>, <span class="fl">2.004</span>, <span class="fl">1.924</span>, <span class="fl">1.864</span>, <span class="fl">1.816</span>, <span class="fl">1.777</span>, <span class="fl">1.744</span>, <span class="fl">1.716</span>, <span class="fl">1.692</span>, <span class="fl">1.671</span>, <span class="fl">1.652</span>)</span>
<span id="cb23-584"><a href="cambio-de-funciones.html#cb23-584" tabindex="-1"></a>  <span class="co"># Calcular Rm, UCL, LCL</span></span>
<span id="cb23-585"><a href="cambio-de-funciones.html#cb23-585" tabindex="-1"></a>  helpRange <span class="ot">&lt;-</span><span class="cf">function</span>(x) {</span>
<span id="cb23-586"><a href="cambio-de-funciones.html#cb23-586" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">diff</span>(<span class="fu">range</span>(x)))</span>
<span id="cb23-587"><a href="cambio-de-funciones.html#cb23-587" tabindex="-1"></a>  }</span>
<span id="cb23-588"><a href="cambio-de-funciones.html#cb23-588" tabindex="-1"></a>  aggForLimits <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gdo<span class="sc">$</span>X[, yName], <span class="fu">list</span>(gdo<span class="sc">$</span>X[, aName], gdo<span class="sc">$</span>X[, bName]), <span class="at">FUN =</span> helpRange)</span>
<span id="cb23-589"><a href="cambio-de-funciones.html#cb23-589" tabindex="-1"></a>  Rm <span class="ot">&lt;-</span> <span class="fu">mean</span>(aggForLimits[, <span class="dv">3</span>])</span>
<span id="cb23-590"><a href="cambio-de-funciones.html#cb23-590" tabindex="-1"></a>  UCL <span class="ot">&lt;-</span> D4[sgSize] <span class="sc">*</span> Rm</span>
<span id="cb23-591"><a href="cambio-de-funciones.html#cb23-591" tabindex="-1"></a>  LCL <span class="ot">&lt;-</span> D3[sgSize] <span class="sc">*</span> Rm</span>
<span id="cb23-592"><a href="cambio-de-funciones.html#cb23-592" tabindex="-1"></a>  agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gdo<span class="sc">$</span>X[, yName], <span class="fu">list</span>(gdo<span class="sc">$</span>X[, bName], gdo<span class="sc">$</span>X[, aName]), <span class="at">FUN =</span> helpRange)</span>
<span id="cb23-593"><a href="cambio-de-funciones.html#cb23-593" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">table</span>(agg[, <span class="dv">2</span>])</span>
<span id="cb23-594"><a href="cambio-de-funciones.html#cb23-594" tabindex="-1"></a>  sgSize <span class="ot">&lt;-</span> tab[<span class="dv">1</span>]</span>
<span id="cb23-595"><a href="cambio-de-funciones.html#cb23-595" tabindex="-1"></a>  old.par <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>mar</span>
<span id="cb23-596"><a href="cambio-de-funciones.html#cb23-596" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">10.1</span>))</span>
<span id="cb23-597"><a href="cambio-de-funciones.html#cb23-597" tabindex="-1"></a></span>
<span id="cb23-598"><a href="cambio-de-funciones.html#cb23-598" tabindex="-1"></a>  D3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.076</span>, <span class="fl">0.136</span>, <span class="fl">0.184</span>, <span class="fl">0.223</span>, <span class="fl">0.256</span>, <span class="fl">0.284</span>, <span class="fl">0.308</span>, <span class="fl">0.329</span>, <span class="fl">0.348</span>)</span>
<span id="cb23-599"><a href="cambio-de-funciones.html#cb23-599" tabindex="-1"></a>  D4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">3.267</span>, <span class="fl">2.574</span>, <span class="fl">2.282</span>, <span class="fl">2.115</span>, <span class="fl">2.004</span>, <span class="fl">1.924</span>, <span class="fl">1.864</span>, <span class="fl">1.816</span>, <span class="fl">1.777</span>, <span class="fl">1.744</span>, <span class="fl">1.716</span>, <span class="fl">1.692</span>, <span class="fl">1.671</span>, <span class="fl">1.652</span>)</span>
<span id="cb23-600"><a href="cambio-de-funciones.html#cb23-600" tabindex="-1"></a>  </span>
<span id="cb23-601"><a href="cambio-de-funciones.html#cb23-601" tabindex="-1"></a>  <span class="co"># Calcular Rm, UCL, LCL</span></span>
<span id="cb23-602"><a href="cambio-de-funciones.html#cb23-602" tabindex="-1"></a>  helpRange <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb23-603"><a href="cambio-de-funciones.html#cb23-603" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">diff</span>(<span class="fu">range</span>(x)))</span>
<span id="cb23-604"><a href="cambio-de-funciones.html#cb23-604" tabindex="-1"></a>  }</span>
<span id="cb23-605"><a href="cambio-de-funciones.html#cb23-605" tabindex="-1"></a>  </span>
<span id="cb23-606"><a href="cambio-de-funciones.html#cb23-606" tabindex="-1"></a>  <span class="co"># Cálculo de los límites</span></span>
<span id="cb23-607"><a href="cambio-de-funciones.html#cb23-607" tabindex="-1"></a>  aggForLimits <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gdo<span class="sc">$</span>X[, yName], <span class="fu">list</span>(gdo<span class="sc">$</span>X[, aName], gdo<span class="sc">$</span>X[, bName]), <span class="at">FUN =</span> helpRange)</span>
<span id="cb23-608"><a href="cambio-de-funciones.html#cb23-608" tabindex="-1"></a>  Rm <span class="ot">&lt;-</span> <span class="fu">mean</span>(aggForLimits[, <span class="dv">3</span>])</span>
<span id="cb23-609"><a href="cambio-de-funciones.html#cb23-609" tabindex="-1"></a>  </span>
<span id="cb23-610"><a href="cambio-de-funciones.html#cb23-610" tabindex="-1"></a>  <span class="co"># Calcular UCL y LCL</span></span>
<span id="cb23-611"><a href="cambio-de-funciones.html#cb23-611" tabindex="-1"></a>  sgSize <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(gdo<span class="sc">$</span>X[, bName]))</span>
<span id="cb23-612"><a href="cambio-de-funciones.html#cb23-612" tabindex="-1"></a>  UCL <span class="ot">&lt;-</span> D4[sgSize] <span class="sc">*</span> Rm</span>
<span id="cb23-613"><a href="cambio-de-funciones.html#cb23-613" tabindex="-1"></a>  LCL <span class="ot">&lt;-</span> D3[sgSize] <span class="sc">*</span> Rm</span>
<span id="cb23-614"><a href="cambio-de-funciones.html#cb23-614" tabindex="-1"></a>  </span>
<span id="cb23-615"><a href="cambio-de-funciones.html#cb23-615" tabindex="-1"></a>  agg <span class="ot">&lt;-</span> <span class="fu">aggregate</span>(gdo<span class="sc">$</span>X[, yName], <span class="fu">list</span>(gdo<span class="sc">$</span>X[, bName], gdo<span class="sc">$</span>X[, aName]), <span class="at">FUN =</span> helpRange)</span>
<span id="cb23-616"><a href="cambio-de-funciones.html#cb23-616" tabindex="-1"></a>  </span>
<span id="cb23-617"><a href="cambio-de-funciones.html#cb23-617" tabindex="-1"></a>  agg<span class="sc">$</span>Group<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">factor</span>(agg<span class="sc">$</span>Group<span class="fl">.1</span>, <span class="at">levels =</span> <span class="fu">unique</span>(agg<span class="sc">$</span>Group<span class="fl">.1</span>))</span>
<span id="cb23-618"><a href="cambio-de-funciones.html#cb23-618" tabindex="-1"></a>  </span>
<span id="cb23-619"><a href="cambio-de-funciones.html#cb23-619" tabindex="-1"></a>  <span class="co"># Crear el gráfico R Chart con ggplot2</span></span>
<span id="cb23-620"><a href="cambio-de-funciones.html#cb23-620" tabindex="-1"></a>  p4 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(agg, <span class="fu">aes</span>(<span class="at">x =</span> Group<span class="fl">.1</span>, <span class="at">y =</span> x)) <span class="sc">+</span></span>
<span id="cb23-621"><a href="cambio-de-funciones.html#cb23-621" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span>  <span class="co"># Eliminamos aes(group = Group.2)</span></span>
<span id="cb23-622"><a href="cambio-de-funciones.html#cb23-622" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Group<span class="fl">.2</span>), <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb23-623"><a href="cambio-de-funciones.html#cb23-623" tabindex="-1"></a>    <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fu">max</span>(<span class="fu">max</span>(agg[, <span class="dv">3</span>]), UCL)) <span class="sc">+</span></span>
<span id="cb23-624"><a href="cambio-de-funciones.html#cb23-624" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-625"><a href="cambio-de-funciones.html#cb23-625" tabindex="-1"></a>    <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">c</span>(Rm, UCL, LCL), <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-626"><a href="cambio-de-funciones.html#cb23-626" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">length</span>(agg[, <span class="dv">3</span>]) <span class="sc">+</span> <span class="fu">length</span>(agg[, <span class="dv">3</span>]) <span class="sc">*</span> <span class="fl">0.075</span>, <span class="at">y =</span> LCL, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;LCL =&quot;</span>, <span class="fu">round</span>(LCL, <span class="dv">2</span>)), <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb23-627"><a href="cambio-de-funciones.html#cb23-627" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">length</span>(agg[, <span class="dv">3</span>]) <span class="sc">+</span> <span class="fu">length</span>(agg[, <span class="dv">3</span>]) <span class="sc">*</span> <span class="fl">0.075</span>, <span class="at">y =</span> UCL, <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">&quot;UCL =&quot;</span>, <span class="fu">round</span>(UCL, <span class="dv">2</span>)), <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb23-628"><a href="cambio-de-funciones.html#cb23-628" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="fu">length</span>(agg[, <span class="dv">3</span>]) <span class="sc">+</span> <span class="fu">length</span>(agg[, <span class="dv">3</span>]) <span class="sc">*</span> <span class="fl">0.075</span>, <span class="at">y =</span> Rm, <span class="at">label =</span> <span class="fu">substitute</span>(<span class="fu">bar</span>(R) <span class="sc">==</span> Rm, <span class="fu">list</span>(<span class="at">Rm =</span> <span class="fu">round</span>(Rm, <span class="dv">2</span>))), <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb23-629"><a href="cambio-de-funciones.html#cb23-629" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">cumsum</span>(tab) <span class="sc">-</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-630"><a href="cambio-de-funciones.html#cb23-630" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> agg<span class="sc">$</span>Group<span class="fl">.2</span>)</span>
<span id="cb23-631"><a href="cambio-de-funciones.html#cb23-631" tabindex="-1"></a>  </span>
<span id="cb23-632"><a href="cambio-de-funciones.html#cb23-632" tabindex="-1"></a>  <span class="fu">print</span>(p4)</span>
<span id="cb23-633"><a href="cambio-de-funciones.html#cb23-633" tabindex="-1"></a></span>
<span id="cb23-634"><a href="cambio-de-funciones.html#cb23-634" tabindex="-1"></a>  }</span>
<span id="cb23-635"><a href="cambio-de-funciones.html#cb23-635" tabindex="-1"></a></span>
<span id="cb23-636"><a href="cambio-de-funciones.html#cb23-636" tabindex="-1"></a>})</span></code></pre></div>
<ul>
<li><p>Resultados antes:</p></li>
<li><p>Resultados ahora:</p></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="cambio-de-funciones.html#cb24-1" tabindex="-1"></a><span class="co"># Ejemplo de uso:</span></span>
<span id="cb24-2"><a href="cambio-de-funciones.html#cb24-2" tabindex="-1"></a><span class="co"># crear un objeto de la clase &#39;gageRR&#39;</span></span>
<span id="cb24-3"><a href="cambio-de-funciones.html#cb24-3" tabindex="-1"></a>mi_gageRR <span class="ot">&lt;-</span> gageRR<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb24-4"><a href="cambio-de-funciones.html#cb24-4" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-5"><a href="cambio-de-funciones.html#cb24-5" tabindex="-1"></a>    <span class="at">Operator =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>)),</span>
<span id="cb24-6"><a href="cambio-de-funciones.html#cb24-6" tabindex="-1"></a>    <span class="at">Part =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;P1&quot;</span>, <span class="st">&quot;P1&quot;</span>, <span class="st">&quot;P2&quot;</span>, <span class="st">&quot;P2&quot;</span>, <span class="st">&quot;P3&quot;</span>)),</span>
<span id="cb24-7"><a href="cambio-de-funciones.html#cb24-7" tabindex="-1"></a>    <span class="at">Measurement =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">9</span>)</span>
<span id="cb24-8"><a href="cambio-de-funciones.html#cb24-8" tabindex="-1"></a>  ),</span>
<span id="cb24-9"><a href="cambio-de-funciones.html#cb24-9" tabindex="-1"></a>  <span class="at">ANOVA =</span> <span class="cn">NULL</span>,  <span class="co"># Esto puede ser NULL inicialmente y luego calcularlo</span></span>
<span id="cb24-10"><a href="cambio-de-funciones.html#cb24-10" tabindex="-1"></a>  <span class="at">RedANOVA =</span> <span class="cn">NULL</span>,  <span class="co"># Igual que ANOVA, puede ser NULL inicialmente</span></span>
<span id="cb24-11"><a href="cambio-de-funciones.html#cb24-11" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;crossed&quot;</span>,</span>
<span id="cb24-12"><a href="cambio-de-funciones.html#cb24-12" tabindex="-1"></a>  <span class="at">Estimates =</span> <span class="fu">list</span>(),</span>
<span id="cb24-13"><a href="cambio-de-funciones.html#cb24-13" tabindex="-1"></a>  <span class="at">Varcomp =</span> <span class="fu">list</span>(),</span>
<span id="cb24-14"><a href="cambio-de-funciones.html#cb24-14" tabindex="-1"></a>  <span class="at">Sigma =</span> <span class="fl">0.5</span>,</span>
<span id="cb24-15"><a href="cambio-de-funciones.html#cb24-15" tabindex="-1"></a>  <span class="at">GageName =</span> <span class="st">&quot;Gage1&quot;</span>,</span>
<span id="cb24-16"><a href="cambio-de-funciones.html#cb24-16" tabindex="-1"></a>  <span class="at">GageTolerance =</span> <span class="fl">0.1</span>,</span>
<span id="cb24-17"><a href="cambio-de-funciones.html#cb24-17" tabindex="-1"></a>  <span class="at">DateOfStudy =</span> <span class="st">&quot;2024-05-15&quot;</span>,</span>
<span id="cb24-18"><a href="cambio-de-funciones.html#cb24-18" tabindex="-1"></a>  <span class="at">PersonResponsible =</span> <span class="st">&quot;John Doe&quot;</span>,</span>
<span id="cb24-19"><a href="cambio-de-funciones.html#cb24-19" tabindex="-1"></a>  <span class="at">Comments =</span> <span class="st">&quot;Sample gage R&amp;R study&quot;</span>,</span>
<span id="cb24-20"><a href="cambio-de-funciones.html#cb24-20" tabindex="-1"></a>  <span class="at">b =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>)),</span>
<span id="cb24-21"><a href="cambio-de-funciones.html#cb24-21" tabindex="-1"></a>  <span class="at">a =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;P1&quot;</span>, <span class="st">&quot;P1&quot;</span>, <span class="st">&quot;P2&quot;</span>, <span class="st">&quot;P2&quot;</span>, <span class="st">&quot;P3&quot;</span>)),</span>
<span id="cb24-22"><a href="cambio-de-funciones.html#cb24-22" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">9</span>),</span>
<span id="cb24-23"><a href="cambio-de-funciones.html#cb24-23" tabindex="-1"></a>  <span class="at">facNames =</span> <span class="fu">c</span>(<span class="st">&quot;Measurement&quot;</span>, <span class="st">&quot;Operator&quot;</span>, <span class="st">&quot;Part&quot;</span>),</span>
<span id="cb24-24"><a href="cambio-de-funciones.html#cb24-24" tabindex="-1"></a>  <span class="at">numO =</span> <span class="dv">3</span>,</span>
<span id="cb24-25"><a href="cambio-de-funciones.html#cb24-25" tabindex="-1"></a>  <span class="at">numP =</span> <span class="dv">3</span>,</span>
<span id="cb24-26"><a href="cambio-de-funciones.html#cb24-26" tabindex="-1"></a>  <span class="at">numM =</span> <span class="dv">2</span></span>
<span id="cb24-27"><a href="cambio-de-funciones.html#cb24-27" tabindex="-1"></a>)</span>
<span id="cb24-28"><a href="cambio-de-funciones.html#cb24-28" tabindex="-1"></a></span>
<span id="cb24-29"><a href="cambio-de-funciones.html#cb24-29" tabindex="-1"></a><span class="co"># Crear el objeto gageRRObj</span></span>
<span id="cb24-30"><a href="cambio-de-funciones.html#cb24-30" tabindex="-1"></a>design_example <span class="ot">&lt;-</span> <span class="fu">gageRRDesign</span>(</span>
<span id="cb24-31"><a href="cambio-de-funciones.html#cb24-31" tabindex="-1"></a>  <span class="at">Operators =</span> <span class="dv">3</span>,</span>
<span id="cb24-32"><a href="cambio-de-funciones.html#cb24-32" tabindex="-1"></a>  <span class="at">Parts =</span> <span class="dv">10</span>,</span>
<span id="cb24-33"><a href="cambio-de-funciones.html#cb24-33" tabindex="-1"></a>  <span class="at">Measurements =</span> <span class="dv">3</span>,</span>
<span id="cb24-34"><a href="cambio-de-funciones.html#cb24-34" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;crossed&quot;</span>,</span>
<span id="cb24-35"><a href="cambio-de-funciones.html#cb24-35" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="dv">6</span>,</span>
<span id="cb24-36"><a href="cambio-de-funciones.html#cb24-36" tabindex="-1"></a>  <span class="at">randomize =</span> <span class="cn">TRUE</span></span>
<span id="cb24-37"><a href="cambio-de-funciones.html#cb24-37" tabindex="-1"></a>)</span>
<span id="cb24-38"><a href="cambio-de-funciones.html#cb24-38" tabindex="-1"></a></span>
<span id="cb24-39"><a href="cambio-de-funciones.html#cb24-39" tabindex="-1"></a><span class="co"># Crear un diseño para el estudio de Gage</span></span>
<span id="cb24-40"><a href="cambio-de-funciones.html#cb24-40" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">gageRRDesign</span>(<span class="at">Operators =</span> <span class="dv">3</span>, <span class="at">Parts =</span> <span class="dv">10</span>, <span class="at">Measurements =</span> <span class="dv">3</span>, <span class="at">method =</span> <span class="st">&quot;crossed&quot;</span>, <span class="at">sigma =</span> <span class="dv">6</span>, <span class="at">randomize =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-41"><a href="cambio-de-funciones.html#cb24-41" tabindex="-1"></a>design<span class="sc">$</span>X<span class="sc">$</span>Measurement <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(design<span class="sc">$</span>X), <span class="at">mean =</span> <span class="dv">10</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb24-42"><a href="cambio-de-funciones.html#cb24-42" tabindex="-1"></a></span>
<span id="cb24-43"><a href="cambio-de-funciones.html#cb24-43" tabindex="-1"></a><span class="co"># Ejecutar la función gageRR_</span></span>
<span id="cb24-44"><a href="cambio-de-funciones.html#cb24-44" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">gageRR_</span>(</span>
<span id="cb24-45"><a href="cambio-de-funciones.html#cb24-45" tabindex="-1"></a>  <span class="at">gdo =</span> design,</span>
<span id="cb24-46"><a href="cambio-de-funciones.html#cb24-46" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;crossed&quot;</span>,   <span class="co">#  método &quot;crossed&quot;</span></span>
<span id="cb24-47"><a href="cambio-de-funciones.html#cb24-47" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="dv">6</span>,            <span class="co">#  sigma</span></span>
<span id="cb24-48"><a href="cambio-de-funciones.html#cb24-48" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fl">0.25</span>,         <span class="co"># Nivel de significancia</span></span>
<span id="cb24-49"><a href="cambio-de-funciones.html#cb24-49" tabindex="-1"></a>  <span class="at">tolerance =</span> <span class="cn">NULL</span>,     <span class="co"># Tolerancia</span></span>
<span id="cb24-50"><a href="cambio-de-funciones.html#cb24-50" tabindex="-1"></a>  <span class="at">dig =</span> <span class="dv">3</span>               <span class="co"># Número de dígitos a mostrar en los resultados</span></span>
<span id="cb24-51"><a href="cambio-de-funciones.html#cb24-51" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## 
## AnOVa Table -  crossed Design
##               Df Sum Sq Mean Sq F value Pr(&gt;F)  
## Operator       2   0.64   0.321   0.113 0.8934  
## Part           9  68.67   7.629   2.687 0.0108 *
## Operator:Part 18  82.26   4.570   1.610 0.0866 .
## Residuals     60 170.35   2.839                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## ----------
## 
## Gage R&amp;R
##                  VarComp VarCompContrib Stdev StudyVar StudyVarContrib
## totalRR            3.416         0.9095 1.848    11.09           0.954
##  repeatability     2.839         0.7559 1.685    10.11           0.869
##  reproducibility   0.577         0.1536 0.759     4.56           0.392
##    Operator        0.000         0.0000 0.000     0.00           0.000
##    Operator:Part   0.577         0.1536 0.759     4.56           0.392
## Part to Part       0.340         0.0905 0.583     3.50           0.301
## totalVar           3.756         1.0000 1.938    11.63           1.000
## 
## ---
##  * Contrib equals Contribution in %
##  **Number of Distinct Categories (truncated signal-to-noise-ratio) = 1</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="cambio-de-funciones.html#cb26-1" tabindex="-1"></a><span class="fu">class</span>(result)</span></code></pre></div>
<pre><code>## [1] &quot;gageRR&quot; &quot;R6&quot;</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="cambio-de-funciones.html#cb28-1" tabindex="-1"></a><span class="fu">plot</span>(result)</span></code></pre></div>
<pre><code>## Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
## ℹ Please use tidy evaluation idioms with `aes()`.
## ℹ See also `vignette(&quot;ggplot2-in-packages&quot;)` for more information.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-27-1.png" width="672" /><img src="Libro_TidyQualityTools_files/figure-html/unnamed-chunk-27-2.png" width="672" /></p>
<pre><code>## Error in get(as.character(FUN), mode = &quot;function&quot;, envir = envir): el objeto &#39;fun&#39; de modo &#39;function&#39; no fue encontrado</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="qualitytools.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="referencias.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/Libro_TidyQualityTools/edit/master/05-CambioFunciones.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Libro_TidyQualityTools.pdf", "Libro_TidyQualityTools.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
